<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Mr.&nbsp;Ozan Ozbeker">

<title>05 | Introduction to Data
Science – IENG 331: Computer Applications in Industrial
Engineering</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../learning-modules/04-data-structures.html" rel="prev">
<link href="../images/flying-wv-gold.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-fdd8e41e452522482f81c6f67b0e9110.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-7a1606e66d82e84606b9c82b411ee8d3.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <a class="flex-grow-1 no-decor" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
          <h1 class="quarto-secondary-nav-title">05 | Introduction to Data Science</h1>
        </a>     
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../images/logo-ieng-331.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Course
Information</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../course-information/schedule.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Schedule</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../course-information/resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Resources</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../course-information/grading-and-deliverables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Grading &amp; Deliverables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../course-information/policies.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Policies</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Learning
Modules</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../learning-modules/01-setting-up-your-workstation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01
| Setting Up Your Workstation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../learning-modules/02-intro-to-python.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">02
| Intro to Python</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../learning-modules/03-functions-flow-control-and-conditionals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">03 | Functions, Flow Control, &amp; Conditionals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../learning-modules/04-data-structures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">04
| Strings, Lists, Dictionaries, and Tuples</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../learning-modules/05-intro-to-data-science.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">05
| Introduction to Data Science</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview"><span class="header-section-number">1</span> Overview</a>
  <ul>
  <li><a href="#initialization" id="toc-initialization" class="nav-link" data-scroll-target="#initialization"><span class="header-section-number">1.1</span> Initialization</a></li>
  </ul></li>
  <li><a href="#data-visualization" id="toc-data-visualization" class="nav-link" data-scroll-target="#data-visualization"><span class="header-section-number">2</span> Data visualization</a>
  <ul>
  <li><a href="#the-penguins-data-frame" id="toc-the-penguins-data-frame" class="nav-link" data-scroll-target="#the-penguins-data-frame"><span class="header-section-number">2.1</span> The <code>penguins</code>
  data frame</a></li>
  <li><a href="#first-visualization" id="toc-first-visualization" class="nav-link" data-scroll-target="#first-visualization"><span class="header-section-number">2.2</span> First visualization</a></li>
  <li><a href="#using-plotly-express" id="toc-using-plotly-express" class="nav-link" data-scroll-target="#using-plotly-express"><span class="header-section-number">2.3</span> Using Plotly Express</a></li>
  <li><a href="#adding-aesthetics-and-layers" id="toc-adding-aesthetics-and-layers" class="nav-link" data-scroll-target="#adding-aesthetics-and-layers"><span class="header-section-number">2.4</span> Adding aesthetics and
  layers</a></li>
  <li><a href="#visualizing-distributions" id="toc-visualizing-distributions" class="nav-link" data-scroll-target="#visualizing-distributions"><span class="header-section-number">2.5</span> Visualizing distributions</a>
  <ul class="collapse">
  <li><a href="#a-categorical-variable" id="toc-a-categorical-variable" class="nav-link" data-scroll-target="#a-categorical-variable"><span class="header-section-number">2.5.1</span> A categorical
  variable</a></li>
  <li><a href="#a-numerical-variable" id="toc-a-numerical-variable" class="nav-link" data-scroll-target="#a-numerical-variable"><span class="header-section-number">2.5.2</span> A numerical
  variable</a></li>
  </ul></li>
  <li><a href="#visualizing-relationships" id="toc-visualizing-relationships" class="nav-link" data-scroll-target="#visualizing-relationships"><span class="header-section-number">2.6</span> Visualizing relationships</a>
  <ul class="collapse">
  <li><a href="#a-numerical-and-a-categorical-variable" id="toc-a-numerical-and-a-categorical-variable" class="nav-link" data-scroll-target="#a-numerical-and-a-categorical-variable"><span class="header-section-number">2.6.1</span> A numerical and a
  categorical variable</a></li>
  <li><a href="#two-categorical-variables" id="toc-two-categorical-variables" class="nav-link" data-scroll-target="#two-categorical-variables"><span class="header-section-number">2.6.2</span> Two categorical
  variables</a></li>
  <li><a href="#two-numerical-variables" id="toc-two-numerical-variables" class="nav-link" data-scroll-target="#two-numerical-variables"><span class="header-section-number">2.6.3</span> Two numerical
  variables</a></li>
  <li><a href="#three-or-more-variables" id="toc-three-or-more-variables" class="nav-link" data-scroll-target="#three-or-more-variables"><span class="header-section-number">2.6.4</span> Three or more
  variables</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">2.7</span> Summary</a></li>
  </ul></li>
  <li><a href="#data-transformation" id="toc-data-transformation" class="nav-link" data-scroll-target="#data-transformation"><span class="header-section-number">3</span> Data transformation</a>
  <ul>
  <li><a href="#the-flights-data-frame" id="toc-the-flights-data-frame" class="nav-link" data-scroll-target="#the-flights-data-frame"><span class="header-section-number">3.1</span> The <code>flights</code> data
  frame</a></li>
  <li><a href="#rows" id="toc-rows" class="nav-link" data-scroll-target="#rows"><span class="header-section-number">3.2</span> Rows</a>
  <ul class="collapse">
  <li><a href="#dataframe.filter" id="toc-dataframe.filter" class="nav-link" data-scroll-target="#dataframe.filter"><span class="header-section-number">3.2.1</span>
  <code>DataFrame.filter()</code></a></li>
  <li><a href="#dataframe.sort" id="toc-dataframe.sort" class="nav-link" data-scroll-target="#dataframe.sort"><span class="header-section-number">3.2.2</span>
  <code>DataFrame.sort()</code></a></li>
  <li><a href="#dataframe.unique" id="toc-dataframe.unique" class="nav-link" data-scroll-target="#dataframe.unique"><span class="header-section-number">3.2.3</span>
  <code>DataFrame.unique()</code></a></li>
  </ul></li>
  <li><a href="#columns" id="toc-columns" class="nav-link" data-scroll-target="#columns"><span class="header-section-number">3.3</span> Columns</a>
  <ul class="collapse">
  <li><a href="#dataframe.with_columns" id="toc-dataframe.with_columns" class="nav-link" data-scroll-target="#dataframe.with_columns"><span class="header-section-number">3.3.1</span>
  <code>DataFrame.with_columns()</code></a></li>
  <li><a href="#dataframe.select" id="toc-dataframe.select" class="nav-link" data-scroll-target="#dataframe.select"><span class="header-section-number">3.3.2</span>
  <code>DataFrame.select()</code></a></li>
  </ul></li>
  <li><a href="#groups" id="toc-groups" class="nav-link" data-scroll-target="#groups"><span class="header-section-number">3.4</span> Groups</a>
  <ul class="collapse">
  <li><a href="#dataframe.group_by" id="toc-dataframe.group_by" class="nav-link" data-scroll-target="#dataframe.group_by"><span class="header-section-number">3.4.1</span>
  <code>DataFrame.group_by()</code></a></li>
  <li><a href="#groupby.agg" id="toc-groupby.agg" class="nav-link" data-scroll-target="#groupby.agg"><span class="header-section-number">3.4.2</span>
  <code>GroupBy.agg()</code></a></li>
  <li><a href="#slicing-functions" id="toc-slicing-functions" class="nav-link" data-scroll-target="#slicing-functions"><span class="header-section-number">3.4.3</span> Slicing functions</a></li>
  <li><a href="#grouping-by-multiple-variables" id="toc-grouping-by-multiple-variables" class="nav-link" data-scroll-target="#grouping-by-multiple-variables"><span class="header-section-number">3.4.4</span> Grouping by multiple
  variables</a></li>
  </ul></li>
  <li><a href="#summary-1" id="toc-summary-1" class="nav-link" data-scroll-target="#summary-1"><span class="header-section-number">3.5</span> Summary</a></li>
  </ul></li>
  <li><a href="#data-tidying" id="toc-data-tidying" class="nav-link" data-scroll-target="#data-tidying"><span class="header-section-number">4</span> Data tidying</a>
  <ul>
  <li><a href="#tidy-data" id="toc-tidy-data" class="nav-link" data-scroll-target="#tidy-data"><span class="header-section-number">4.1</span> Tidy data</a></li>
  <li><a href="#lengthening-data" id="toc-lengthening-data" class="nav-link" data-scroll-target="#lengthening-data"><span class="header-section-number">4.2</span> Lengthening data</a>
  <ul class="collapse">
  <li><a href="#data-in-column-names" id="toc-data-in-column-names" class="nav-link" data-scroll-target="#data-in-column-names"><span class="header-section-number">4.2.1</span> Data in column
  names</a></li>
  <li><a href="#how-does-pivoting-work" id="toc-how-does-pivoting-work" class="nav-link" data-scroll-target="#how-does-pivoting-work"><span class="header-section-number">4.2.2</span> How does pivoting
  work?</a></li>
  <li><a href="#more-variables-in-column-names" id="toc-more-variables-in-column-names" class="nav-link" data-scroll-target="#more-variables-in-column-names"><span class="header-section-number">4.2.3</span> More variables in column
  names</a></li>
  </ul></li>
  <li><a href="#widening-data" id="toc-widening-data" class="nav-link" data-scroll-target="#widening-data"><span class="header-section-number">4.3</span> Widening data</a>
  <ul class="collapse">
  <li><a href="#how-does-dataframe.pivot-work" id="toc-how-does-dataframe.pivot-work" class="nav-link" data-scroll-target="#how-does-dataframe.pivot-work"><span class="header-section-number">4.3.1</span> How does
  <code>DataFrame.pivot()</code> work?</a></li>
  <li><a href="#data-and-variable-names-in-the-column-headers" id="toc-data-and-variable-names-in-the-column-headers" class="nav-link" data-scroll-target="#data-and-variable-names-in-the-column-headers"><span class="header-section-number">4.3.2</span> Data and variable names in
  the column headers</a></li>
  </ul></li>
  <li><a href="#summary-2" id="toc-summary-2" class="nav-link" data-scroll-target="#summary-2"><span class="header-section-number">4.4</span> Summary</a></li>
  </ul></li>
  <li><a href="#data-import-export" id="toc-data-import-export" class="nav-link" data-scroll-target="#data-import-export"><span class="header-section-number">5</span> Data import &amp; export</a>
  <ul>
  <li><a href="#reading-data-from-a-file" id="toc-reading-data-from-a-file" class="nav-link" data-scroll-target="#reading-data-from-a-file"><span class="header-section-number">5.1</span> Reading data from a file</a>
  <ul class="collapse">
  <li><a href="#practical-advice" id="toc-practical-advice" class="nav-link" data-scroll-target="#practical-advice"><span class="header-section-number">5.1.1</span> Practical advice</a></li>
  <li><a href="#other-arguments" id="toc-other-arguments" class="nav-link" data-scroll-target="#other-arguments"><span class="header-section-number">5.1.2</span> Other arguments</a></li>
  <li><a href="#other-file-types" id="toc-other-file-types" class="nav-link" data-scroll-target="#other-file-types"><span class="header-section-number">5.1.3</span> Other file types</a></li>
  </ul></li>
  <li><a href="#controlling-column-types" id="toc-controlling-column-types" class="nav-link" data-scroll-target="#controlling-column-types"><span class="header-section-number">5.2</span> Controlling column types</a>
  <ul class="collapse">
  <li><a href="#guessing-types" id="toc-guessing-types" class="nav-link" data-scroll-target="#guessing-types"><span class="header-section-number">5.2.1</span> Guessing types</a></li>
  <li><a href="#missing-values-column-types-and-problems" id="toc-missing-values-column-types-and-problems" class="nav-link" data-scroll-target="#missing-values-column-types-and-problems"><span class="header-section-number">5.2.2</span> Missing values, column
  types, and problems</a></li>
  <li><a href="#column-types" id="toc-column-types" class="nav-link" data-scroll-target="#column-types"><span class="header-section-number">5.2.3</span> Column types</a></li>
  </ul></li>
  <li><a href="#reading-data-from-multiple-files" id="toc-reading-data-from-multiple-files" class="nav-link" data-scroll-target="#reading-data-from-multiple-files"><span class="header-section-number">5.3</span> Reading data from multiple
  files</a></li>
  <li><a href="#writing-to-a-file" id="toc-writing-to-a-file" class="nav-link" data-scroll-target="#writing-to-a-file"><span class="header-section-number">5.4</span> Writing to a file</a></li>
  <li><a href="#data-entry" id="toc-data-entry" class="nav-link" data-scroll-target="#data-entry"><span class="header-section-number">5.5</span> Data entry</a></li>
  <li><a href="#summary-3" id="toc-summary-3" class="nav-link" data-scroll-target="#summary-3"><span class="header-section-number">5.6</span> Summary</a></li>
  </ul></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="header-section-number">6</span> Exercises</a></li>
  </ul>
<div class="quarto-other-links"><h2>Other Links</h2><ul><li><a href="resources/Python_Polars_the_Definitive_Guide_-_Early_Release_6.pdf"><i class="bi bi-filetype-pdf"></i>Python Polars the Definitive Guide (Early Release)</a></li><li><a href="data/billboard.csv"><i class="bi bi-filetype-csv"></i>billboard.csv</a></li><li><a href="data/cms_patient_experience.csv"><i class="bi bi-filetype-csv"></i>cms_patient_experience.csv</a></li><li><a href="data/penguins.csv"><i class="bi bi-filetype-csv"></i>penguins.csv</a></li><li><a href="data/students.csv"><i class="bi bi-filetype-csv"></i>students.csv</a></li><li><a href="data/who2.csv"><i class="bi bi-filetype-csv"></i>who2.csv</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">05 | Introduction to Data Science</h1>
<p class="subtitle lead">Python data workflows with Polars and
Plotly</p>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Mr.&nbsp;Ozan
Ozbeker <a href="mailto:ozan.ozbeker@mail.wvu.edu" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="https://imse.statler.wvu.edu/">
            Industrial and Management Systems Engineering
            </a>
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
  
    
  </div>
  


</header>


<section id="overview" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="overview"><span class="header-section-number">1</span>
Overview</h2>
<p>In this beginning chapter, we will cover the fundamentals of data
analysis in the form of <strong>importing</strong>,
<strong>tidying</strong>, <strong>transforming</strong>, and
<strong>visualizing data</strong>, as shown below:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/whole-game.png" class="img-fluid figure-img"></p>
<figcaption>In this learning module, you’ll learn how to import, tidy,
transform, and visualize data.</figcaption>
</figure>
</div>
<p>By the end of this module, you will be able to:</p>
<ul>
<li>Import data from various file formats into Python using Polars</li>
<li>Clean and reshape datasets to facilitate analysis</li>
<li>Transform data through filtering, sorting, and creating new
variables</li>
<li>Group and aggregate data to identify patterns and trends</li>
<li>Visualize distributions and relationships using Plotly Express</li>
<li>Apply tidy data principles to structure datasets effectively</li>
</ul>
<section id="initialization" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="initialization"><span class="header-section-number">1.1</span>
Initialization</h3>
<p>At this point, you will need to install a few more Python
packages:</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>terminal</strong></pre>
</div>
<div class="sourceCode" id="cb1" data-filename="terminal"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">uv</span> add polars<span class="pp">[</span><span class="ss">all</span><span class="pp">]</span> plotly<span class="pp">[</span><span class="ss">express</span><span class="pp">]</span> statsmodels palmerpenguins nycflights13 billboard</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Once installed, import the following:</p>
<div id="import-modules" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> polars <span class="im">as</span> pl</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> palmerpenguins</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="data-visualization" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="data-visualization"><span class="header-section-number">2</span> Data
visualization</h2>
<p>Python has several systems for making graphs, but we will be focusing
on <a href="https://plotly.com/python/">Plotly</a>, specifically <a href="https://plotly.com/python/plotly-express/">Plotly Express</a>.
Plotly Express contains functions that can create entire plots at once,
and makes it easy to create most common figures.</p>
<p>This section will teach you how to visualize your data using
<strong>Plotly Express</strong>, walking through visualizing
distributions of single variables, as well as relationships between two
or more variables.</p>
<section id="the-penguins-data-frame" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="the-penguins-data-frame"><span class="header-section-number">2.1</span> The
<code>penguins</code> data frame</h3>
<p>The dataset we will be working with is a commonly used one,
affectionately referred to as the Palmer Penguins, which includes body
measurements for penguins on three islands in the Palmer Archipelago. A
<strong>data frame</strong> is a rectangular collection of variables (in
the columns) and observations (in the rows). <code>penguins</code>
contains 344 observations collected and made available by Dr.&nbsp;Kristen
Gorman and the Palmer Station, Antarctica.</p>
<p>Let’s define some term:</p>
<ul>
<li>A <strong>variable</strong> is a quantity, quality, or property that
you can measure.</li>
<li>A <strong>value</strong> is the state of a variable when you measure
it. The value of a variable may change from measurement to
measurement.</li>
<li>An <strong>observation</strong> is a set of measurements made under
similar conditions (you usually make all of the measurements in an
observation at the same time and on the same object). An observation
will contain several values, each associated with a different variable.
We’ll sometimes refer to an observation as a data point.</li>
<li><strong>Tabular data</strong> is a set of values, each associated
with a variable and an observation. Tabular data is <em>tidy</em> if
each value is placed in its own “cell”, each variable in its own column,
and each observation in its own row.</li>
</ul>
<p>In this context, a variable refers to an attribute of all the
penguins, and an observation refers to all the attributes of a single
penguin.</p>
<p>We will use <code>palmerpenguins</code> package to get the
<code>penguins</code> data, and convert it to a <code>polars</code> data
frame:</p>
<div id="57cf82e6" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="op">=</span> pl.from_pandas(palmerpenguins.load_penguins())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The reason we convert to a Polars data frame is because we want to
use the tools and methods that come with Polars:</p>
<div id="191a111d" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(penguins)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>polars.dataframe.frame.DataFrame</code></pre>
</div>
</div>
<p>Depending on what tool/IDE you’re using Python with, just having the
variable name (<code>penguins</code>) as the last line will print a
formatted view of the data. If not, you can also use
<code>print()</code> to use Polars’ native formatting:</p>
<div id="e02f0b34" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>penguins</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (344, 8)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">species</th>
<th data-quarto-table-cell-role="th">island</th>
<th data-quarto-table-cell-role="th">bill_length_mm</th>
<th data-quarto-table-cell-role="th">bill_depth_mm</th>
<th data-quarto-table-cell-role="th">flipper_length_mm</th>
<th data-quarto-table-cell-role="th">body_mass_g</th>
<th data-quarto-table-cell-role="th">sex</th>
<th data-quarto-table-cell-role="th">year</th>
</tr>
<tr class="even">
<th>str</th>
<th>str</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>str</th>
<th>i64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"Adelie"</td>
<td>"Torgersen"</td>
<td>39.1</td>
<td>18.7</td>
<td>181.0</td>
<td>3750.0</td>
<td>"male"</td>
<td>2007</td>
</tr>
<tr class="even">
<td>"Adelie"</td>
<td>"Torgersen"</td>
<td>39.5</td>
<td>17.4</td>
<td>186.0</td>
<td>3800.0</td>
<td>"female"</td>
<td>2007</td>
</tr>
<tr class="odd">
<td>"Adelie"</td>
<td>"Torgersen"</td>
<td>40.3</td>
<td>18.0</td>
<td>195.0</td>
<td>3250.0</td>
<td>"female"</td>
<td>2007</td>
</tr>
<tr class="even">
<td>"Adelie"</td>
<td>"Torgersen"</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>2007</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="even">
<td>"Chinstrap"</td>
<td>"Dream"</td>
<td>43.5</td>
<td>18.1</td>
<td>202.0</td>
<td>3400.0</td>
<td>"female"</td>
<td>2009</td>
</tr>
<tr class="odd">
<td>"Chinstrap"</td>
<td>"Dream"</td>
<td>49.6</td>
<td>18.2</td>
<td>193.0</td>
<td>3775.0</td>
<td>"male"</td>
<td>2009</td>
</tr>
<tr class="even">
<td>"Chinstrap"</td>
<td>"Dream"</td>
<td>50.8</td>
<td>19.0</td>
<td>210.0</td>
<td>4100.0</td>
<td>"male"</td>
<td>2009</td>
</tr>
<tr class="odd">
<td>"Chinstrap"</td>
<td>"Dream"</td>
<td>50.2</td>
<td>18.7</td>
<td>198.0</td>
<td>3775.0</td>
<td>"female"</td>
<td>2009</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="08138c8f" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(penguins)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (344, 8)
┌───────────┬───────────┬──────────────┬──────────────┬──────────────┬─────────────┬────────┬──────┐
│ species   ┆ island    ┆ bill_length_ ┆ bill_depth_m ┆ flipper_leng ┆ body_mass_g ┆ sex    ┆ year │
│ ---       ┆ ---       ┆ mm           ┆ m            ┆ th_mm        ┆ ---         ┆ ---    ┆ ---  │
│ str       ┆ str       ┆ ---          ┆ ---          ┆ ---          ┆ f64         ┆ str    ┆ i64  │
│           ┆           ┆ f64          ┆ f64          ┆ f64          ┆             ┆        ┆      │
╞═══════════╪═══════════╪══════════════╪══════════════╪══════════════╪═════════════╪════════╪══════╡
│ Adelie    ┆ Torgersen ┆ 39.1         ┆ 18.7         ┆ 181.0        ┆ 3750.0      ┆ male   ┆ 2007 │
│ Adelie    ┆ Torgersen ┆ 39.5         ┆ 17.4         ┆ 186.0        ┆ 3800.0      ┆ female ┆ 2007 │
│ Adelie    ┆ Torgersen ┆ 40.3         ┆ 18.0         ┆ 195.0        ┆ 3250.0      ┆ female ┆ 2007 │
│ Adelie    ┆ Torgersen ┆ null         ┆ null         ┆ null         ┆ null        ┆ null   ┆ 2007 │
│ …         ┆ …         ┆ …            ┆ …            ┆ …            ┆ …           ┆ …      ┆ …    │
│ Chinstrap ┆ Dream     ┆ 43.5         ┆ 18.1         ┆ 202.0        ┆ 3400.0      ┆ female ┆ 2009 │
│ Chinstrap ┆ Dream     ┆ 49.6         ┆ 18.2         ┆ 193.0        ┆ 3775.0      ┆ male   ┆ 2009 │
│ Chinstrap ┆ Dream     ┆ 50.8         ┆ 19.0         ┆ 210.0        ┆ 4100.0      ┆ male   ┆ 2009 │
│ Chinstrap ┆ Dream     ┆ 50.2         ┆ 18.7         ┆ 198.0        ┆ 3775.0      ┆ female ┆ 2009 │
└───────────┴───────────┴──────────────┴──────────────┴──────────────┴─────────────┴────────┴──────┘</code></pre>
</div>
</div>
<p>This data frame contains 8 columns. For an alternative view, use
<code>DataFrame.glimpse()</code>, which is helpful for wide tables that
have many columns:</p>
<div id="5875c016" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>penguins.glimpse()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 344
Columns: 8
$ species           &lt;str&gt; 'Adelie', 'Adelie', 'Adelie', 'Adelie', 'Adelie', 'Adelie', 'Adelie', 'Adelie', 'Adelie', 'Adelie'
$ island            &lt;str&gt; 'Torgersen', 'Torgersen', 'Torgersen', 'Torgersen', 'Torgersen', 'Torgersen', 'Torgersen', 'Torgersen', 'Torgersen', 'Torgersen'
$ bill_length_mm    &lt;f64&gt; 39.1, 39.5, 40.3, None, 36.7, 39.3, 38.9, 39.2, 34.1, 42.0
$ bill_depth_mm     &lt;f64&gt; 18.7, 17.4, 18.0, None, 19.3, 20.6, 17.8, 19.6, 18.1, 20.2
$ flipper_length_mm &lt;f64&gt; 181.0, 186.0, 195.0, None, 193.0, 190.0, 181.0, 195.0, 193.0, 190.0
$ body_mass_g       &lt;f64&gt; 3750.0, 3800.0, 3250.0, None, 3450.0, 3650.0, 3625.0, 4675.0, 3475.0, 4250.0
$ sex               &lt;str&gt; 'male', 'female', 'female', None, 'female', 'male', 'female', 'male', None, None
$ year              &lt;i64&gt; 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007
</code></pre>
</div>
</div>
<p>Among these variables are:</p>
<ol type="1">
<li><code>species</code>: a penguin’s species (Adelie, Chinstrap, or
Gentoo).</li>
<li><code>flipper_length_mm</code>: length of a penguin’s flipper, in
millimeters.</li>
<li><code>body_mass_g</code>: body mass of a penguin, in grams.</li>
</ol>
</section>
<section id="first-visualization" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="first-visualization"><span class="header-section-number">2.2</span>
First visualization</h3>
<p>Our goal is to recreate the following visual that displays the
relationship between flipper lengths and body masses of these penguins,
taking into consideration the species of the penguin.</p>
<div id="final-goal-plot" class="cell" data-execution_count="8">
<div id="final-goal-plot-1" class="cell-output cell-output-display">
        <script type="text/javascript">
        window.PlotlyConfig = {MathJaxConfig: 'local'};
        if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}
        </script>
        <script type="module">import "https://cdn.plot.ly/plotly-3.0.0.min"</script>
        
</div>
<div id="final-goal-plot-2" class="cell-output cell-output-display">
<iframe scrolling="no" width="100%" height="545px" src="iframe_figures/figure_8.html" frameborder="0" allowfullscreen=""></iframe>
</div>
</div>
</section>
<section id="using-plotly-express" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="using-plotly-express"><span class="header-section-number">2.3</span>
Using Plotly Express</h3>
<p>With Plotly Express, you begin a plot by calling a plotting function
from the module, commonly referred to as <code>px</code>. You can then
add arguments to your plot function for more customization.</p>
<p>At it’s most basic form, the plotting function creates a <em>blank
canvas</em> with a grid since we’ve given it no data.</p>
<div id="514571a9" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>px.scatter()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<iframe scrolling="no" width="100%" height="545px" src="iframe_figures/figure_9.html" frameborder="0" allowfullscreen=""></iframe>
</div>
</div>
<p>Next, we need to actually provide data, along with the appropriate
number of variables depending on the type of plot we are trying to
create.</p>
<div id="167eb3da" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>px.scatter(data_frame<span class="op">=</span>penguins, x<span class="op">=</span><span class="st">"flipper_length_mm"</span>, y<span class="op">=</span><span class="st">"body_mass_g"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<iframe scrolling="no" width="100%" height="545px" src="iframe_figures/figure_10.html" frameborder="0" allowfullscreen=""></iframe>
</div>
</div>
<p><code>px.scatter()</code> creates a <a href="https://plotly.com/python/line-and-scatter/">scatter plot</a>, and
we will learn many more plot types through out the course. You can learn
more about the different plots Plotly Express offers at their <a href="https://plotly.com/python/plotly-express/#gallery">gallery</a>.</p>
<p>This doesn’t match our “final goal” <em>yet</em>, but using this plot
we can start answering the question that motivated our exploration:
“What does the relationship between flipper length and body mass look
like?” The relationship appears to be positive (as flipper length
increases, so does body mass), fairly linear (the points are clustered
around a line instead of a curve), and moderately strong (there isn’t
too much scatter around such a line). Penguins with longer flippers are
generally larger in terms of their body mass.</p>
<p>Before we go further, I want to point out that this dataset has some
missing values for <code>flipper_length_mm</code> and
<code>body_mass_g</code>, but Plotly does not warn you about this when
creating the plot. If one and/or other variable is missing data, we
cannot plot that.</p>
</section>
<section id="adding-aesthetics-and-layers" class="level3" data-number="2.4">
<h3 data-number="2.4" class="anchored" data-anchor-id="adding-aesthetics-and-layers"><span class="header-section-number">2.4</span>
Adding aesthetics and layers</h3>
<p>Scatter plots are useful for displaying the relationship between two
numerical variables, but it’s always a good idea to be skeptical of any
apparent relationship between two variables and ask if there may be
other variables that explain or change the nature of this apparent
relationship. For example, does the relationship between flipper length
and body mass differ by species? Let’s incorporate species into our plot
and see if this reveals any additional insights into the apparent
relationship between these variables. We will do this by representing
species with different colored points.</p>
<p>To achieve this, we will use some of the other arguments that
<code>px.scatter()</code> provides for us, like <code>color</code>:</p>
<div id="1ff9a7a7" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>px.scatter(</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    data_frame<span class="op">=</span>penguins, </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">"flipper_length_mm"</span>, </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">"body_mass_g"</span>, </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"species"</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<iframe scrolling="no" width="100%" height="545px" src="iframe_figures/figure_11.html" frameborder="0" allowfullscreen=""></iframe>
</div>
</div>
<p>When a categorical variable is mapped to an aesthetic, Plotly will
automatically assign a unique value of the aesthetic (here, a unique
color) to each unique level of the variable (each of the three species),
a process known as <strong>scaling</strong>. Plotly will also add a
legend that explains which value correspond to which levels.</p>
<p>Now let’s add another layer, a trendline displaying the relationship
between body mass and flipper length. <code>px.scatter()</code> has an
argument for this, <code>trendline</code>, and a couple other arguments
that modify its behavior. Specifically, we want to draw a line of best
fit using Ordinary Least Squares (ols). You can see the other options,
and more info about this plotting function with
<code>?px.scatter()</code> or in the online documentation.</p>
<div id="403e4a4b" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>px.scatter(</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    data_frame<span class="op">=</span>penguins, </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">"flipper_length_mm"</span>, </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">"body_mass_g"</span>, </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"species"</span>,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    trendline<span class="op">=</span><span class="st">"ols"</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<iframe scrolling="no" width="100%" height="545px" src="iframe_figures/figure_12.html" frameborder="0" allowfullscreen=""></iframe>
</div>
</div>
<p>We’ve added lines, but this plot doesn’t look like our final goal,
which only has one line for the entire dataset, opposed to separate
lines for each of the penguin species. <code>px.scatter()</code> has an
argument, <code>trendline_scope</code>, which controls how the trendline
is drawn when there are groups, in this case created when we used
<code>color="species"</code>. The default for
<code>trendline_scope</code> is <code>"trace"</code>, which draws a line
per color, symbol, facet, etc., and <code>"overall"</code>, which
computes one trendline for the entire dataset,a nd replicates across all
facets.</p>
<div id="3e6a7962" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>px.scatter(</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    data_frame<span class="op">=</span>penguins, </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">"flipper_length_mm"</span>, </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">"body_mass_g"</span>, </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"species"</span>,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    trendline<span class="op">=</span><span class="st">"ols"</span>,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    trendline_scope<span class="op">=</span><span class="st">"overall"</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<iframe scrolling="no" width="100%" height="545px" src="iframe_figures/figure_13.html" frameborder="0" allowfullscreen=""></iframe>
</div>
</div>
<p>Now we have something that is very close to our final plot, thought
it’s not there yet. We still need to use different shapes for each
species and improve the labels.</p>
<p>It’s generally not a good idea to represent information only using
colors on a plot as people perceive colors differently do to color
blindness or other color vision difference. <code>px.scatter()</code>
allows us to control the shapes of the dots using the
<code>symbol</code> argument.</p>
<div id="d642b170" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>px.scatter(</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    penguins,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">"flipper_length_mm"</span>,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">"body_mass_g"</span>,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"species"</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    symbol<span class="op">=</span><span class="st">"species"</span>,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    trendline<span class="op">=</span><span class="st">"ols"</span>,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    trendline_scope<span class="op">=</span><span class="st">"overall"</span>,</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<iframe scrolling="no" width="100%" height="545px" src="iframe_figures/figure_14.html" frameborder="0" allowfullscreen=""></iframe>
</div>
</div>
<p>Note that the legend is automatically updated to reflect the
different shapes of the points as well.</p>
<p>Finally, we can use <code>title</code>, <code>subtitle</code>, and
<code>labels</code> arguments to update our labels. <code>title</code>
and <code>subtitle</code> just take a string, adding labels are bit more
advanced. <code>labels</code> takes a dictionary with key:value combos
for each of the labels on the plot that you would like to change. In our
plot, we want to update the labels for the x-axis, y-axis, and the
legend, but we refer to them by their current label, not their
position:</p>
<div id="5b2799dc" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>px.scatter(</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    penguins,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">"flipper_length_mm"</span>,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">"body_mass_g"</span>,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"species"</span>,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    symbol<span class="op">=</span><span class="st">"species"</span>,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    trendline<span class="op">=</span><span class="st">"ols"</span>,</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    trendline_scope<span class="op">=</span><span class="st">"overall"</span>,</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">"Body mass and flipper length"</span>,</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    subtitle<span class="op">=</span><span class="st">"Dimensions for Adelie, Chinstrap, and Gentoo Penguins"</span>,</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    labels<span class="op">=</span>{</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">"species"</span>:<span class="st">"Species"</span>,</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">"body_mass_g"</span>:<span class="st">"Body mass (g)"</span>,</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">"flipper_length_mm"</span>:<span class="st">"Flipper length (mm)"</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<iframe scrolling="no" width="100%" height="545px" src="iframe_figures/figure_15.html" frameborder="0" allowfullscreen=""></iframe>
</div>
</div>
<p>Now we have our final plot. If you haven’t noticed already, Plotly
creates <em>interactive</em> plots, you can hover over certain data
points to see their values, use the legend as a filter, and so on. In
the top right of every plot, you will see a menu with some options.</p>
</section>
<section id="visualizing-distributions" class="level3" data-number="2.5">
<h3 data-number="2.5" class="anchored" data-anchor-id="visualizing-distributions"><span class="header-section-number">2.5</span>
Visualizing distributions</h3>
<p>How you visualize the distribution of a variable depends on the type
of the variable: categorical or numerical.</p>
<section id="a-categorical-variable" class="level4" data-number="2.5.1">
<h4 data-number="2.5.1" class="anchored" data-anchor-id="a-categorical-variable"><span class="header-section-number">2.5.1</span>
A categorical variable</h4>
<p>A value is <strong>categorical</strong> if it can only take one of a
small set of values. To examine the distribution of a categorical
variable, you can use a <a href="https://plotly.com/python/bar-charts/">bar chart</a>. The height
of the bars displays how many observations occurred with each
<code>x</code> value.</p>
<div id="ed698f57" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>px.bar(penguins, x<span class="op">=</span><span class="st">"species"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<iframe scrolling="no" width="100%" height="545px" src="iframe_figures/figure_16.html" frameborder="0" allowfullscreen=""></iframe>
</div>
</div>
<p><code>px.bar()</code> will result in <strong>one rectangle drawn per
row of input</strong>, which can result in the striped look above. To
combine these rectangles into on color per position, we can
pre-calculate the <strong>count</strong> as and use it as the
<strong>y</strong> value:</p>
<div id="a974c0bc" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># we'll learn more about this Polars code later</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>penguins_count <span class="op">=</span> penguins.group_by(<span class="st">"species"</span>).<span class="bu">len</span>(<span class="st">"count"</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(penguins_count)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>px.bar(penguins_count, x<span class="op">=</span><span class="st">"species"</span>, y<span class="op">=</span><span class="st">"count"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3, 2)
┌───────────┬───────┐
│ species   ┆ count │
│ ---       ┆ ---   │
│ str       ┆ u32   │
╞═══════════╪═══════╡
│ Adelie    ┆ 152   │
│ Gentoo    ┆ 124   │
│ Chinstrap ┆ 68    │
└───────────┴───────┘</code></pre>
</div>
<div class="cell-output cell-output-display">
<iframe scrolling="no" width="100%" height="545px" src="iframe_figures/figure_17.html" frameborder="0" allowfullscreen=""></iframe>
</div>
</div>
<p>The order of categorical values in axes, legends, and facets depends
on the order in which these values are first encountered in
<code>data_frame</code>. It’s often preferable to re-order the bars
based on their frequency, which we can do with the
<code>category_orders</code> argument. <code>category_orders</code>
takes a dictionary where the keys correspond to column names, and the
values should be lists of strings corresponding to the specific display
order desired</p>
<div id="ac5ffa34" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>px.bar(</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    penguins_count,</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">"species"</span>, </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">"count"</span>,</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    category_orders<span class="op">=</span>{<span class="st">"species"</span>: [<span class="st">"Adelie"</span>, <span class="st">"Gentoo"</span>, <span class="st">"Chinstrap"</span>]}</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<iframe scrolling="no" width="100%" height="545px" src="iframe_figures/figure_18.html" frameborder="0" allowfullscreen=""></iframe>
</div>
</div>
<p>While it’s easy enough to manually sort three columns, this could
become very tedious for more columns. Here is one programmatic way you
could sort the columns:</p>
<div id="02eca153" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>penguins_sorted <span class="op">=</span> (</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    penguins_count</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    .sort(by<span class="op">=</span><span class="st">"count"</span>, descending<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    .get_column(<span class="st">"species"</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(penguins_sorted)</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>px.bar(</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    penguins_count,</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">"species"</span>, </span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">"count"</span>,</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>    category_orders<span class="op">=</span>{<span class="st">"species"</span>: penguins_sorted}</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3,)
Series: 'species' [str]
[
    "Adelie"
    "Gentoo"
    "Chinstrap"
]</code></pre>
</div>
<div class="cell-output cell-output-display">
<iframe scrolling="no" width="100%" height="545px" src="iframe_figures/figure_19.html" frameborder="0" allowfullscreen=""></iframe>
</div>
</div>
<p>We will dive into the data manipulation code later, this is just to
show what’s possible.</p>
</section>
<section id="a-numerical-variable" class="level4" data-number="2.5.2">
<h4 data-number="2.5.2" class="anchored" data-anchor-id="a-numerical-variable"><span class="header-section-number">2.5.2</span>
A numerical variable</h4>
<p>A variable is <strong>numerical</strong> (or quantitative) if it can
take on a wide range of numerical values, and it is sensible to add,
subtract, or take averages with those values. Numerical variables can be
continuous or discrete.</p>
<p>One common visualization for distributions of continuous variables is
a <a href="https://plotly.com/python/histograms/">histogram</a>.</p>
<div id="c75b873f" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>px.histogram(penguins, x<span class="op">=</span><span class="st">"body_mass_g"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<iframe scrolling="no" width="100%" height="545px" src="iframe_figures/figure_20.html" frameborder="0" allowfullscreen=""></iframe>
</div>
</div>
<p>A histogram divides the x-axis into equally spaced bins and then uses
the heigh of the bar to display the number observations that fall in
each bin. In the graph above, the tallest bar shows that 39 observations
have a <code>body_mass_g</code> value between 3,500 and 3,700 grams,
which are the left and right edges of the bar.</p>
<p>When working with histograms, it’s a good idea to use different
number of bins to reveal different patterns in the data. In the plots
below, X bars is too many, resulting in narrow bars. Similarly, 3 bins
is too few, resulting in all the data being binned into huge categories
that make it difficult to determine the shape of the distribution. A bin
number of 20 provides a sensible balance.</p>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>px.histogram(penguins, x<span class="op">=</span><span class="st">"body_mass_g"</span>, nbins<span class="op">=</span><span class="dv">200</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>px.histogram(penguins, x<span class="op">=</span><span class="st">"body_mass_g"</span>, nbins<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>px.histogram(penguins, x<span class="op">=</span><span class="st">"body_mass_g"</span>, nbins<span class="op">=</span><span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="quarto-layout-panel" data-layout="[[1,1], [1]]">
<div class="quarto-layout-row">
<div id="1f020cb8" class="cell quarto-layout-cell" data-execution_count="21" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="cell-output cell-output-display">
<iframe scrolling="no" width="100%" height="545px" src="iframe_figures/figure_21.html" frameborder="0" allowfullscreen=""></iframe>
</div>
</div>
<div id="64e3398c" class="cell quarto-layout-cell" data-execution_count="22" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="cell-output cell-output-display">
<iframe scrolling="no" width="100%" height="545px" src="iframe_figures/figure_22.html" frameborder="0" allowfullscreen=""></iframe>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div id="27ccf90d" class="cell quarto-layout-cell" data-execution_count="23" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="cell-output cell-output-display">
<iframe scrolling="no" width="100%" height="545px" src="iframe_figures/figure_23.html" frameborder="0" allowfullscreen=""></iframe>
</div>
</div>
</div>
</div>
<p>An alternative visualization for distributions of numerical variables
is a <a href="https://www.data-to-viz.com/graph/density.html">density
plot</a>. A density plot is a smoothed-out version of a histogram and a
practical alternative, particularly for continuous data that comes from
an underlying smooth distribution. At the time of writing, Plotly
Express doesn’t have a quick way to create a density plot, but it does
offer very customizable <a href="https://plotly.com/python/violin/">violin plots</a>, which we can
make to look like a density plot if we would like.</p>
<div id="517b9ae7" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>px.violin(penguins, x<span class="op">=</span><span class="st">"body_mass_g"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<iframe scrolling="no" width="100%" height="545px" src="iframe_figures/figure_24.html" frameborder="0" allowfullscreen=""></iframe>
</div>
</div>
<p>The density plot is similar to the violin plot, with only one side,
and the peaks are more exaggerated:</p>
<div id="3cec6a34" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>px.violin(</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    penguins, </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">"body_mass_g"</span>, <span class="co"># plots the variable across the x-axis</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    range_y<span class="op">=</span>[</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>        <span class="dv">0</span>,   <span class="co"># limits the bottom of y-axis, removing reflection</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>        <span class="fl">0.25</span> <span class="co"># limits the top of y-axis, stretching the peaks</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<iframe scrolling="no" width="100%" height="545px" src="iframe_figures/figure_25.html" frameborder="0" allowfullscreen=""></iframe>
</div>
</div>
<p>While this workaround works, sticking to the original violin plot I
think looks better, and we can add some extra arguments to see more
details:</p>
<div id="848578eb" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>px.violin(penguins, x<span class="op">=</span><span class="st">"body_mass_g"</span>, points<span class="op">=</span><span class="st">"all"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<iframe scrolling="no" width="100%" height="545px" src="iframe_figures/figure_26.html" frameborder="0" allowfullscreen=""></iframe>
</div>
</div>
<p>Play around with different arguments and see what you like best!</p>
<p>As an analogy to understand these plots vs a histogram, imagine a
histogram made out of wooden blocks. Then, imagine that you drop a
cooked spaghetti string over it. The shape the spaghetti will take
draped over blocks can be thought of as the shape of the density curve.
It shows fewer details than a histogram but can make it easier to
quickly glean the shape of the distribution, particularly with respect
to modes and skewness.</p>
</section>
</section>
<section id="visualizing-relationships" class="level3" data-number="2.6">
<h3 data-number="2.6" class="anchored" data-anchor-id="visualizing-relationships"><span class="header-section-number">2.6</span>
Visualizing relationships</h3>
<p>To visualize a relationship we need to have at least two variables
mapped to aesthetics of a plot. In the following sections you will learn
about commonly used plots for visualizing relationships between two or
more variables and the plots used for creating them.</p>
<section id="a-numerical-and-a-categorical-variable" class="level4" data-number="2.6.1">
<h4 data-number="2.6.1" class="anchored" data-anchor-id="a-numerical-and-a-categorical-variable"><span class="header-section-number">2.6.1</span>
A numerical and a categorical variable</h4>
<p>To visualize the relationship between a numerical and a categorical
variable we can use side-by-side box plots. A <a href="https://plotly.com/python/box-plots/">boxplot</a> is a type of
visual shorthand for measures of position (percentiles) that describe a
distribution. It is also useful for identifying potential outliers. Each
boxplot consists of:</p>
<ul>
<li><p>A box that indicates the range of the middle half of the data, a
distance known as the inter-quartile range (IQR), stretching from the
25th percentile of the distribution to the 75th percentile. In the
middle of the box is a line that displays the median, i.e.&nbsp;50th
percentile, of the distribution. These three lines give you a sense of
the spread of the distribution and whether or not the distribution is
symmetric about the median or skewed to one side.</p></li>
<li><p>Visual points that display observations that fall more than 1.5
times the IQR from either edge of the box. These outlying points are
unusual so are plotted individually.</p></li>
<li><p>A line (or whisker) that extends from each end of the box and
goes to the farthest non-outlier point in the distribution.</p></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/EDA-boxplot.png" class="img-fluid figure-img"></p>
<figcaption>“Diagram depicting how a boxplot is created.”</figcaption>
</figure>
</div>
<p>Let’s take a look at the distribution of body mass by species using
<code>px.box()</code></p>
<div id="3ac70c3b" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>px.box(penguins, x<span class="op">=</span><span class="st">"species"</span>, y<span class="op">=</span><span class="st">"body_mass_g"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<iframe scrolling="no" width="100%" height="545px" src="iframe_figures/figure_27.html" frameborder="0" allowfullscreen=""></iframe>
</div>
</div>
<p>Alternatively, we can make violin plots with multiple groups:</p>
<div id="f3fa44c0" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>px.violin(penguins, x<span class="op">=</span><span class="st">"body_mass_g"</span>, color<span class="op">=</span><span class="st">"species"</span>, box<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<iframe scrolling="no" width="100%" height="545px" src="iframe_figures/figure_28.html" frameborder="0" allowfullscreen=""></iframe>
</div>
</div>
<p>As we’ve seen before, there are many ways to see and code what we are
looking for.</p>
</section>
<section id="two-categorical-variables" class="level4" data-number="2.6.2">
<h4 data-number="2.6.2" class="anchored" data-anchor-id="two-categorical-variables"><span class="header-section-number">2.6.2</span>
Two categorical variables</h4>
<p>We can use stacked bar plots to visualize the relationship between
two categorical variables. For example, the following two stacked bar
plots both display the relationship between <code>island</code> and
<code>species</code>, or specifically, visualizing the distribution of
<code>species</code> within each island.</p>
<p>The first plot shows the frequencies of each species of penguins on
each island. The plot of frequencies shows that there are equal numbers
of Adelies on each island. But we don’t have a good sense of the
percentage balance within each island.</p>
<div id="2f2f1cc1" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>px.bar(penguins, x<span class="op">=</span><span class="st">"island"</span>, color<span class="op">=</span><span class="st">"species"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<iframe scrolling="no" width="100%" height="545px" src="iframe_figures/figure_29.html" frameborder="0" allowfullscreen=""></iframe>
</div>
</div>
<p>or</p>
<div id="53addb58" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> penguins.group_by([<span class="st">"island"</span>, <span class="st">"species"</span>]).<span class="bu">len</span>(<span class="st">"count"</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>data_order <span class="op">=</span> data.group_by(<span class="st">"island"</span>).agg(pl.col(<span class="st">"count"</span>).<span class="bu">sum</span>()).sort(by<span class="op">=</span><span class="st">"count"</span>, descending<span class="op">=</span><span class="va">True</span>).get_column(<span class="st">"island"</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>px.bar(</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    data, x<span class="op">=</span><span class="st">"island"</span>, y<span class="op">=</span><span class="st">"count"</span>, color<span class="op">=</span><span class="st">"species"</span>,</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    category_orders <span class="op">=</span> {<span class="st">"island"</span>: data_order, <span class="st">"species"</span>: data_order}</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<iframe scrolling="no" width="100%" height="545px" src="iframe_figures/figure_30.html" frameborder="0" allowfullscreen=""></iframe>
</div>
</div>
</section>
<section id="two-numerical-variables" class="level4" data-number="2.6.3">
<h4 data-number="2.6.3" class="anchored" data-anchor-id="two-numerical-variables"><span class="header-section-number">2.6.3</span>
Two numerical variables</h4>
<p>So far we’ve seen scatter plots for visualizing the relationship
between two numerical variables. A scatter plot is probably the most
commonly used plot for visualizing the relationship between to numerical
variables.</p>
<div id="e28b25b7" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>px.scatter(penguins, x<span class="op">=</span><span class="st">"flipper_length_mm"</span>, y<span class="op">=</span><span class="st">"body_mass_g"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<iframe scrolling="no" width="100%" height="545px" src="iframe_figures/figure_31.html" frameborder="0" allowfullscreen=""></iframe>
</div>
</div>
</section>
<section id="three-or-more-variables" class="level4" data-number="2.6.4">
<h4 data-number="2.6.4" class="anchored" data-anchor-id="three-or-more-variables"><span class="header-section-number">2.6.4</span>
Three or more variables</h4>
<p>As we saw before, we can incorporate more variables into a plot by
mapping them to additional aesthetics. For example, in the following
plot, the colors of points represent species and the shapes represent
islands.</p>
<div id="b1a6d8ff" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>px.scatter(</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>    penguins, </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">"flipper_length_mm"</span>, y<span class="op">=</span><span class="st">"body_mass_g"</span>,</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"species"</span>, symbol<span class="op">=</span><span class="st">"island"</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<iframe scrolling="no" width="100%" height="545px" src="iframe_figures/figure_32.html" frameborder="0" allowfullscreen=""></iframe>
</div>
</div>
<p>However adding too many aesthetic mappings to a plot makes it
cluttered and difficult to make sense of. Another way, which is
particularly useful for categorical variables, is to split your plot
into <strong>facets</strong>, subplots that each display one subset of
the data.</p>
<p>Most Plotly Express functions provide arguments to facet, just make
sure to check the documentation.</p>
<div id="3499d3e3" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>px.scatter(</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>    penguins, </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">"flipper_length_mm"</span>, y<span class="op">=</span><span class="st">"body_mass_g"</span>,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"species"</span>, symbol<span class="op">=</span><span class="st">"island"</span>,</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    facet_col<span class="op">=</span><span class="st">"island"</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<iframe scrolling="no" width="100%" height="545px" src="iframe_figures/figure_33.html" frameborder="0" allowfullscreen=""></iframe>
</div>
</div>
</section>
</section>
<section id="summary" class="level3" data-number="2.7">
<h3 data-number="2.7" class="anchored" data-anchor-id="summary"><span class="header-section-number">2.7</span>
Summary</h3>
<p>In this section, you’ve learned the basics of data visualization with
Plotly Express. We started with the basic idea that underpins Plotly
Express: a visualization is a mapping from variables in your data to
aesthetic properties like position, color, size and shape. You then
learned about increasing the complexity with more arguments in the
Plotly functions. You also learned about commonly used plots for
visualizing the distribution of a single variable as well as for
visualizing relationships between two or more variables, by leveraging
additional aesthetic mappings and/or splitting your plot into small
multiples using faceting.</p>
</section>
</section>
<section id="data-transformation" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="data-transformation"><span class="header-section-number">3</span> Data
transformation</h2>
<p>Visualization is an important tool for generating insight, but it’s
rare that you get the data in exactly the right form you need to make
the graph you want. Often you’ll need to create some new variables or
summaries to answer your questions with your data, or maybe you just
want to rename the variables or reorder the observations to make the
data a little easier to work with. We’ve already seen examples of this
above when creating the bar charts. In this section, we’ll see how to do
that with the <a href="https://docs.pola.rs/">Polars</a> package.</p>
<p>The goal of this section is to give you an overview of all the key
tools for transforming a data frame. We’ll start with functions that
operate on rows and then columns of a data frame, then circle back to
talk more about method chaining, an important tool that you use to
combine functions. We will then introduce the ability to work with
groups. We will end the section with a case study that showcases these
functions in action.</p>
<section id="the-flights-data-frame" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="the-flights-data-frame"><span class="header-section-number">3.1</span> The
<code>flights</code> data frame</h3>
<p>To explore basic Polars methods and expressions, we will use the
<code>flights</code> data frame from the <code>nycflights13</code>
package. This dataset contains all 336,776 flights that departed from
New York City in 2013.</p>
<div id="6d9c1dba" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> nycflights13</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> polars <span class="im">as</span> pl</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>flights <span class="op">=</span> (</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    pl</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    .from_pandas(nycflights13.flights)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>    .with_columns(pl.col(<span class="st">"time_hour"</span>).<span class="bu">str</span>.to_datetime(<span class="st">"</span><span class="sc">%F</span><span class="st">T%TZ"</span>))</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>) <span class="co"># We will learn what's going on here in later this section</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>flights</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (336_776, 19)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">dep_time</th>
<th data-quarto-table-cell-role="th">sched_dep_time</th>
<th data-quarto-table-cell-role="th">dep_delay</th>
<th data-quarto-table-cell-role="th">arr_time</th>
<th data-quarto-table-cell-role="th">sched_arr_time</th>
<th data-quarto-table-cell-role="th">arr_delay</th>
<th data-quarto-table-cell-role="th">carrier</th>
<th data-quarto-table-cell-role="th">flight</th>
<th data-quarto-table-cell-role="th">tailnum</th>
<th data-quarto-table-cell-role="th">origin</th>
<th data-quarto-table-cell-role="th">dest</th>
<th data-quarto-table-cell-role="th">air_time</th>
<th data-quarto-table-cell-role="th">distance</th>
<th data-quarto-table-cell-role="th">hour</th>
<th data-quarto-table-cell-role="th">minute</th>
<th data-quarto-table-cell-role="th">time_hour</th>
</tr>
<tr class="even">
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>f64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>f64</th>
<th>str</th>
<th>i64</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>f64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>datetime[μs]</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2013</td>
<td>1</td>
<td>1</td>
<td>517.0</td>
<td>515</td>
<td>2.0</td>
<td>830.0</td>
<td>819</td>
<td>11.0</td>
<td>"UA"</td>
<td>1545</td>
<td>"N14228"</td>
<td>"EWR"</td>
<td>"IAH"</td>
<td>227.0</td>
<td>1400</td>
<td>5</td>
<td>15</td>
<td>2013-01-01 10:00:00</td>
</tr>
<tr class="even">
<td>2013</td>
<td>1</td>
<td>1</td>
<td>533.0</td>
<td>529</td>
<td>4.0</td>
<td>850.0</td>
<td>830</td>
<td>20.0</td>
<td>"UA"</td>
<td>1714</td>
<td>"N24211"</td>
<td>"LGA"</td>
<td>"IAH"</td>
<td>227.0</td>
<td>1416</td>
<td>5</td>
<td>29</td>
<td>2013-01-01 10:00:00</td>
</tr>
<tr class="odd">
<td>2013</td>
<td>1</td>
<td>1</td>
<td>542.0</td>
<td>540</td>
<td>2.0</td>
<td>923.0</td>
<td>850</td>
<td>33.0</td>
<td>"AA"</td>
<td>1141</td>
<td>"N619AA"</td>
<td>"JFK"</td>
<td>"MIA"</td>
<td>160.0</td>
<td>1089</td>
<td>5</td>
<td>40</td>
<td>2013-01-01 10:00:00</td>
</tr>
<tr class="even">
<td>2013</td>
<td>1</td>
<td>1</td>
<td>544.0</td>
<td>545</td>
<td>-1.0</td>
<td>1004.0</td>
<td>1022</td>
<td>-18.0</td>
<td>"B6"</td>
<td>725</td>
<td>"N804JB"</td>
<td>"JFK"</td>
<td>"BQN"</td>
<td>183.0</td>
<td>1576</td>
<td>5</td>
<td>45</td>
<td>2013-01-01 10:00:00</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="even">
<td>2013</td>
<td>9</td>
<td>30</td>
<td>null</td>
<td>2200</td>
<td>null</td>
<td>null</td>
<td>2312</td>
<td>null</td>
<td>"9E"</td>
<td>3525</td>
<td>null</td>
<td>"LGA"</td>
<td>"SYR"</td>
<td>null</td>
<td>198</td>
<td>22</td>
<td>0</td>
<td>2013-10-01 02:00:00</td>
</tr>
<tr class="odd">
<td>2013</td>
<td>9</td>
<td>30</td>
<td>null</td>
<td>1210</td>
<td>null</td>
<td>null</td>
<td>1330</td>
<td>null</td>
<td>"MQ"</td>
<td>3461</td>
<td>"N535MQ"</td>
<td>"LGA"</td>
<td>"BNA"</td>
<td>null</td>
<td>764</td>
<td>12</td>
<td>10</td>
<td>2013-09-30 16:00:00</td>
</tr>
<tr class="even">
<td>2013</td>
<td>9</td>
<td>30</td>
<td>null</td>
<td>1159</td>
<td>null</td>
<td>null</td>
<td>1344</td>
<td>null</td>
<td>"MQ"</td>
<td>3572</td>
<td>"N511MQ"</td>
<td>"LGA"</td>
<td>"CLE"</td>
<td>null</td>
<td>419</td>
<td>11</td>
<td>59</td>
<td>2013-09-30 15:00:00</td>
</tr>
<tr class="odd">
<td>2013</td>
<td>9</td>
<td>30</td>
<td>null</td>
<td>840</td>
<td>null</td>
<td>null</td>
<td>1020</td>
<td>null</td>
<td>"MQ"</td>
<td>3531</td>
<td>"N839MQ"</td>
<td>"LGA"</td>
<td>"RDU"</td>
<td>null</td>
<td>431</td>
<td>8</td>
<td>40</td>
<td>2013-09-30 12:00:00</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p><code>flights</code> is a Polars <a href="https://docs.pola.rs/api/python/stable/reference/dataframe/index.html"><code>DataFrame</code></a>.
Different packages have their own version of a data frame with their own
methods, functions, etc., but in this course, we will be using Polars.
Polars provides its own way of working with data frames, as well as
importing, exporting, printing, and much more, including the previously
shown <code>DataFrame.glimpse()</code> method:</p>
<div id="1832f7d3" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>flights.glimpse()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 336776
Columns: 19
$ year                    &lt;i64&gt; 2013, 2013, 2013, 2013, 2013, 2013, 2013, 2013, 2013, 2013
$ month                   &lt;i64&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
$ day                     &lt;i64&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
$ dep_time                &lt;f64&gt; 517.0, 533.0, 542.0, 544.0, 554.0, 554.0, 555.0, 557.0, 557.0, 558.0
$ sched_dep_time          &lt;i64&gt; 515, 529, 540, 545, 600, 558, 600, 600, 600, 600
$ dep_delay               &lt;f64&gt; 2.0, 4.0, 2.0, -1.0, -6.0, -4.0, -5.0, -3.0, -3.0, -2.0
$ arr_time                &lt;f64&gt; 830.0, 850.0, 923.0, 1004.0, 812.0, 740.0, 913.0, 709.0, 838.0, 753.0
$ sched_arr_time          &lt;i64&gt; 819, 830, 850, 1022, 837, 728, 854, 723, 846, 745
$ arr_delay               &lt;f64&gt; 11.0, 20.0, 33.0, -18.0, -25.0, 12.0, 19.0, -14.0, -8.0, 8.0
$ carrier                 &lt;str&gt; 'UA', 'UA', 'AA', 'B6', 'DL', 'UA', 'B6', 'EV', 'B6', 'AA'
$ flight                  &lt;i64&gt; 1545, 1714, 1141, 725, 461, 1696, 507, 5708, 79, 301
$ tailnum                 &lt;str&gt; 'N14228', 'N24211', 'N619AA', 'N804JB', 'N668DN', 'N39463', 'N516JB', 'N829AS', 'N593JB', 'N3ALAA'
$ origin                  &lt;str&gt; 'EWR', 'LGA', 'JFK', 'JFK', 'LGA', 'EWR', 'EWR', 'LGA', 'JFK', 'LGA'
$ dest                    &lt;str&gt; 'IAH', 'IAH', 'MIA', 'BQN', 'ATL', 'ORD', 'FLL', 'IAD', 'MCO', 'ORD'
$ air_time                &lt;f64&gt; 227.0, 227.0, 160.0, 183.0, 116.0, 150.0, 158.0, 53.0, 140.0, 138.0
$ distance                &lt;i64&gt; 1400, 1416, 1089, 1576, 762, 719, 1065, 229, 944, 733
$ hour                    &lt;i64&gt; 5, 5, 5, 5, 6, 5, 6, 6, 6, 6
$ minute                  &lt;i64&gt; 15, 29, 40, 45, 0, 58, 0, 0, 0, 0
$ time_hour      &lt;datetime[μs]&gt; 2013-01-01 10:00:00, 2013-01-01 10:00:00, 2013-01-01 10:00:00, 2013-01-01 10:00:00, 2013-01-01 11:00:00, 2013-01-01 10:00:00, 2013-01-01 11:00:00, 2013-01-01 11:00:00, 2013-01-01 11:00:00, 2013-01-01 11:00:00
</code></pre>
</div>
</div>
<p>In both views, the variable names are followed by abbreviations that
tell you the type of each variable: <code>i64</code> is short for
integer, <code>f64</code> is short for float, <code>str</code> is short
for string, and <code>datetime[μs]</code> for date-time (in this case,
down to the micro-seconds).</p>
<p>We’re going to learn the primary methods (or contexts as Polars calls
them) which will allow yo uto solve the vast majority of your data
manipulation challenges. Before we discuss their individual differences,
it’s worth stating what they have in common:</p>
<ol type="1">
<li>The methods are always attached (or chained) to a data frame.</li>
<li>The arguments typically describe which columns to operate on.</li>
<li>The output is a new data frame (for the most part, ex:
<code>group_by</code>).</li>
</ol>
<p>Because each method does one thing well, solving complex problems
will usually require combining multiple methods, and we will do so with
something called “method chaining”. You’ve already seen this before,
this is when we attach multiple methods together without creating a
placeholder variable between steps. You can think of each <code>.</code>
operator of saying “then”. This should help you get a sense of the
following code without understanding the details:</p>
<div id="a4aceb22" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>flights.<span class="bu">filter</span>(</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>    pl.col(<span class="st">"dest"</span>) <span class="op">==</span> <span class="st">"IAH"</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>).group_by(</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"year"</span>, <span class="st">"month"</span>, <span class="st">"day"</span>]</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>).agg( <span class="co"># "aggregate", or summarize</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    arr_delay<span class="op">=</span>pl.col(<span class="st">"arr_delay"</span>).mean()</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (365, 4)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">arr_delay</th>
</tr>
<tr class="even">
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2013</td>
<td>11</td>
<td>27</td>
<td>-0.73913</td>
</tr>
<tr class="even">
<td>2013</td>
<td>12</td>
<td>16</td>
<td>-8.181818</td>
</tr>
<tr class="odd">
<td>2013</td>
<td>9</td>
<td>11</td>
<td>-20.55</td>
</tr>
<tr class="even">
<td>2013</td>
<td>8</td>
<td>3</td>
<td>-3.944444</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="even">
<td>2013</td>
<td>2</td>
<td>22</td>
<td>7.35</td>
</tr>
<tr class="odd">
<td>2013</td>
<td>10</td>
<td>5</td>
<td>-12.466667</td>
</tr>
<tr class="even">
<td>2013</td>
<td>10</td>
<td>29</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td>2013</td>
<td>10</td>
<td>30</td>
<td>9.571429</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>We can also write the previous code in a cleaner format. When
surrounded by parenthesis, the <code>.</code> operator does not have to
“touch” the closing method before it:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>    flights</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">filter</span>(pl.col(<span class="st">"dest"</span>) <span class="op">==</span> <span class="st">"IAH"</span>)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    .group_by([<span class="st">"year"</span>, <span class="st">"month"</span>, <span class="st">"day"</span>])</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    .agg(arr_delay<span class="op">=</span>pl.col(<span class="st">"arr_delay"</span>).mean())</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>If we didn’t use method chaining, we would have to create a bunch of
intermediate objects:</p>
<div id="48f9278e" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>flights1 <span class="op">=</span> flights.<span class="bu">filter</span>(pl.col(<span class="st">"dest"</span>) <span class="op">==</span> <span class="st">"IAH"</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>flights2 <span class="op">=</span> flights1.group_by([<span class="st">"year"</span>, <span class="st">"month"</span>, <span class="st">"day"</span>])</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>flights3 <span class="op">=</span> flights2.agg(arr_delay<span class="op">=</span>pl.col(<span class="st">"arr_delay"</span>).mean())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>While all of these have their time and place, method chaining
generally produces data analysis code that is easier to write and
read.</p>
<p>We can organize these contexts (methods) based on what they operate
on: <strong>rows</strong>, <strong>columns</strong>,
<strong>groups</strong>, or <strong>tables</strong>.</p>
</section>
<section id="rows" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="rows"><span class="header-section-number">3.2</span>
Rows</h3>
<p>The most important contexts that operate on rows of a dataset are
<code>DataFrame.filter()</code>, which changes which rows are present
without changing their order, and <code>DataFrame.sort()</code>, which
changes the order of the rows without changing which are present. Both
methods only affect the rows, and the columns are left unchanged. We’ll
also see <code>DataFrame.unique()</code> which returns rows with unique
values. Unlike <code>DataFrame.sort()</code> and
<code>DataFrame.filter()</code>, it can also optionally modify the
columns.</p>
<section id="dataframe.filter" class="level4" data-number="3.2.1">
<h4 data-number="3.2.1" class="anchored" data-anchor-id="dataframe.filter"><span class="header-section-number">3.2.1</span>
<code>DataFrame.filter()</code></h4>
<p><a href="https://docs.pola.rs/api/python/stable/reference/dataframe/api/polars.DataFrame.filter.html"><code>DataFrame.filter()</code></a>
allows you to keep rows based on the values of the columns. The
arguments (also known as predicates) are the conditions that must be
true to keep the row. For example, we could find all flights that
departed more than 120 minutes late:</p>
<div id="72cdc5e1" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>flights.<span class="bu">filter</span>(pl.col(<span class="st">"dep_delay"</span>) <span class="op">&gt;</span> <span class="dv">120</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (9_723, 19)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">dep_time</th>
<th data-quarto-table-cell-role="th">sched_dep_time</th>
<th data-quarto-table-cell-role="th">dep_delay</th>
<th data-quarto-table-cell-role="th">arr_time</th>
<th data-quarto-table-cell-role="th">sched_arr_time</th>
<th data-quarto-table-cell-role="th">arr_delay</th>
<th data-quarto-table-cell-role="th">carrier</th>
<th data-quarto-table-cell-role="th">flight</th>
<th data-quarto-table-cell-role="th">tailnum</th>
<th data-quarto-table-cell-role="th">origin</th>
<th data-quarto-table-cell-role="th">dest</th>
<th data-quarto-table-cell-role="th">air_time</th>
<th data-quarto-table-cell-role="th">distance</th>
<th data-quarto-table-cell-role="th">hour</th>
<th data-quarto-table-cell-role="th">minute</th>
<th data-quarto-table-cell-role="th">time_hour</th>
</tr>
<tr class="even">
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>f64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>f64</th>
<th>str</th>
<th>i64</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>f64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>datetime[μs]</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2013</td>
<td>1</td>
<td>1</td>
<td>848.0</td>
<td>1835</td>
<td>853.0</td>
<td>1001.0</td>
<td>1950</td>
<td>851.0</td>
<td>"MQ"</td>
<td>3944</td>
<td>"N942MQ"</td>
<td>"JFK"</td>
<td>"BWI"</td>
<td>41.0</td>
<td>184</td>
<td>18</td>
<td>35</td>
<td>2013-01-01 23:00:00</td>
</tr>
<tr class="even">
<td>2013</td>
<td>1</td>
<td>1</td>
<td>957.0</td>
<td>733</td>
<td>144.0</td>
<td>1056.0</td>
<td>853</td>
<td>123.0</td>
<td>"UA"</td>
<td>856</td>
<td>"N534UA"</td>
<td>"EWR"</td>
<td>"BOS"</td>
<td>37.0</td>
<td>200</td>
<td>7</td>
<td>33</td>
<td>2013-01-01 12:00:00</td>
</tr>
<tr class="odd">
<td>2013</td>
<td>1</td>
<td>1</td>
<td>1114.0</td>
<td>900</td>
<td>134.0</td>
<td>1447.0</td>
<td>1222</td>
<td>145.0</td>
<td>"UA"</td>
<td>1086</td>
<td>"N76502"</td>
<td>"LGA"</td>
<td>"IAH"</td>
<td>248.0</td>
<td>1416</td>
<td>9</td>
<td>0</td>
<td>2013-01-01 14:00:00</td>
</tr>
<tr class="even">
<td>2013</td>
<td>1</td>
<td>1</td>
<td>1540.0</td>
<td>1338</td>
<td>122.0</td>
<td>2020.0</td>
<td>1825</td>
<td>115.0</td>
<td>"B6"</td>
<td>705</td>
<td>"N570JB"</td>
<td>"JFK"</td>
<td>"SJU"</td>
<td>193.0</td>
<td>1598</td>
<td>13</td>
<td>38</td>
<td>2013-01-01 18:00:00</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="even">
<td>2013</td>
<td>9</td>
<td>30</td>
<td>1951.0</td>
<td>1649</td>
<td>182.0</td>
<td>2157.0</td>
<td>1903</td>
<td>174.0</td>
<td>"EV"</td>
<td>4294</td>
<td>"N13988"</td>
<td>"EWR"</td>
<td>"SAV"</td>
<td>95.0</td>
<td>708</td>
<td>16</td>
<td>49</td>
<td>2013-09-30 20:00:00</td>
</tr>
<tr class="odd">
<td>2013</td>
<td>9</td>
<td>30</td>
<td>2053.0</td>
<td>1815</td>
<td>158.0</td>
<td>2310.0</td>
<td>2054</td>
<td>136.0</td>
<td>"EV"</td>
<td>5292</td>
<td>"N600QX"</td>
<td>"EWR"</td>
<td>"ATL"</td>
<td>91.0</td>
<td>746</td>
<td>18</td>
<td>15</td>
<td>2013-09-30 22:00:00</td>
</tr>
<tr class="even">
<td>2013</td>
<td>9</td>
<td>30</td>
<td>2159.0</td>
<td>1845</td>
<td>194.0</td>
<td>2344.0</td>
<td>2030</td>
<td>194.0</td>
<td>"9E"</td>
<td>3320</td>
<td>"N906XJ"</td>
<td>"JFK"</td>
<td>"BUF"</td>
<td>50.0</td>
<td>301</td>
<td>18</td>
<td>45</td>
<td>2013-09-30 22:00:00</td>
</tr>
<tr class="odd">
<td>2013</td>
<td>9</td>
<td>30</td>
<td>2235.0</td>
<td>2001</td>
<td>154.0</td>
<td>59.0</td>
<td>2249</td>
<td>130.0</td>
<td>"B6"</td>
<td>1083</td>
<td>"N804JB"</td>
<td>"JFK"</td>
<td>"MCO"</td>
<td>123.0</td>
<td>944</td>
<td>20</td>
<td>1</td>
<td>2013-10-01 00:00:00</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>We can use all of the same boolean expressions we’ve learned
previous, as well as chain them with <code>&amp;</code> (instead of
<code>and</code>), <code>|</code> (instead of <code>or</code>), and
<code>~</code> (instead of <code>not</code>). Note that Polars is picky
about ambiguity, so each condition we check for also has it’s own
parenthesis, similar to what we might use in a calculator to make sure
the order of operations is being followed exactly as we want:</p>
<div id="2ad7f0f4" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Flights that departed on January 1</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>flights.<span class="bu">filter</span>(</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>    (pl.col(<span class="st">"month"</span>) <span class="op">==</span> <span class="dv">1</span>) <span class="op">&amp;</span> (pl.col(<span class="st">"day"</span>) <span class="op">==</span> <span class="dv">1</span>)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (842, 19)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">dep_time</th>
<th data-quarto-table-cell-role="th">sched_dep_time</th>
<th data-quarto-table-cell-role="th">dep_delay</th>
<th data-quarto-table-cell-role="th">arr_time</th>
<th data-quarto-table-cell-role="th">sched_arr_time</th>
<th data-quarto-table-cell-role="th">arr_delay</th>
<th data-quarto-table-cell-role="th">carrier</th>
<th data-quarto-table-cell-role="th">flight</th>
<th data-quarto-table-cell-role="th">tailnum</th>
<th data-quarto-table-cell-role="th">origin</th>
<th data-quarto-table-cell-role="th">dest</th>
<th data-quarto-table-cell-role="th">air_time</th>
<th data-quarto-table-cell-role="th">distance</th>
<th data-quarto-table-cell-role="th">hour</th>
<th data-quarto-table-cell-role="th">minute</th>
<th data-quarto-table-cell-role="th">time_hour</th>
</tr>
<tr class="even">
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>f64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>f64</th>
<th>str</th>
<th>i64</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>f64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>datetime[μs]</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2013</td>
<td>1</td>
<td>1</td>
<td>517.0</td>
<td>515</td>
<td>2.0</td>
<td>830.0</td>
<td>819</td>
<td>11.0</td>
<td>"UA"</td>
<td>1545</td>
<td>"N14228"</td>
<td>"EWR"</td>
<td>"IAH"</td>
<td>227.0</td>
<td>1400</td>
<td>5</td>
<td>15</td>
<td>2013-01-01 10:00:00</td>
</tr>
<tr class="even">
<td>2013</td>
<td>1</td>
<td>1</td>
<td>533.0</td>
<td>529</td>
<td>4.0</td>
<td>850.0</td>
<td>830</td>
<td>20.0</td>
<td>"UA"</td>
<td>1714</td>
<td>"N24211"</td>
<td>"LGA"</td>
<td>"IAH"</td>
<td>227.0</td>
<td>1416</td>
<td>5</td>
<td>29</td>
<td>2013-01-01 10:00:00</td>
</tr>
<tr class="odd">
<td>2013</td>
<td>1</td>
<td>1</td>
<td>542.0</td>
<td>540</td>
<td>2.0</td>
<td>923.0</td>
<td>850</td>
<td>33.0</td>
<td>"AA"</td>
<td>1141</td>
<td>"N619AA"</td>
<td>"JFK"</td>
<td>"MIA"</td>
<td>160.0</td>
<td>1089</td>
<td>5</td>
<td>40</td>
<td>2013-01-01 10:00:00</td>
</tr>
<tr class="even">
<td>2013</td>
<td>1</td>
<td>1</td>
<td>544.0</td>
<td>545</td>
<td>-1.0</td>
<td>1004.0</td>
<td>1022</td>
<td>-18.0</td>
<td>"B6"</td>
<td>725</td>
<td>"N804JB"</td>
<td>"JFK"</td>
<td>"BQN"</td>
<td>183.0</td>
<td>1576</td>
<td>5</td>
<td>45</td>
<td>2013-01-01 10:00:00</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="even">
<td>2013</td>
<td>1</td>
<td>1</td>
<td>null</td>
<td>1630</td>
<td>null</td>
<td>null</td>
<td>1815</td>
<td>null</td>
<td>"EV"</td>
<td>4308</td>
<td>"N18120"</td>
<td>"EWR"</td>
<td>"RDU"</td>
<td>null</td>
<td>416</td>
<td>16</td>
<td>30</td>
<td>2013-01-01 21:00:00</td>
</tr>
<tr class="odd">
<td>2013</td>
<td>1</td>
<td>1</td>
<td>null</td>
<td>1935</td>
<td>null</td>
<td>null</td>
<td>2240</td>
<td>null</td>
<td>"AA"</td>
<td>791</td>
<td>"N3EHAA"</td>
<td>"LGA"</td>
<td>"DFW"</td>
<td>null</td>
<td>1389</td>
<td>19</td>
<td>35</td>
<td>2013-01-02 00:00:00</td>
</tr>
<tr class="even">
<td>2013</td>
<td>1</td>
<td>1</td>
<td>null</td>
<td>1500</td>
<td>null</td>
<td>null</td>
<td>1825</td>
<td>null</td>
<td>"AA"</td>
<td>1925</td>
<td>"N3EVAA"</td>
<td>"LGA"</td>
<td>"MIA"</td>
<td>null</td>
<td>1096</td>
<td>15</td>
<td>0</td>
<td>2013-01-01 20:00:00</td>
</tr>
<tr class="odd">
<td>2013</td>
<td>1</td>
<td>1</td>
<td>null</td>
<td>600</td>
<td>null</td>
<td>null</td>
<td>901</td>
<td>null</td>
<td>"B6"</td>
<td>125</td>
<td>"N618JB"</td>
<td>"JFK"</td>
<td>"FLL"</td>
<td>null</td>
<td>1069</td>
<td>6</td>
<td>0</td>
<td>2013-01-01 11:00:00</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="11ae13ff" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Flights that departed in January or February</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>flights.<span class="bu">filter</span>(</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>    (pl.col(<span class="st">"month"</span>) <span class="op">==</span> <span class="dv">1</span>) <span class="op">|</span> (pl.col(<span class="st">"month"</span>) <span class="op">==</span> <span class="dv">2</span>)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (51_955, 19)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">dep_time</th>
<th data-quarto-table-cell-role="th">sched_dep_time</th>
<th data-quarto-table-cell-role="th">dep_delay</th>
<th data-quarto-table-cell-role="th">arr_time</th>
<th data-quarto-table-cell-role="th">sched_arr_time</th>
<th data-quarto-table-cell-role="th">arr_delay</th>
<th data-quarto-table-cell-role="th">carrier</th>
<th data-quarto-table-cell-role="th">flight</th>
<th data-quarto-table-cell-role="th">tailnum</th>
<th data-quarto-table-cell-role="th">origin</th>
<th data-quarto-table-cell-role="th">dest</th>
<th data-quarto-table-cell-role="th">air_time</th>
<th data-quarto-table-cell-role="th">distance</th>
<th data-quarto-table-cell-role="th">hour</th>
<th data-quarto-table-cell-role="th">minute</th>
<th data-quarto-table-cell-role="th">time_hour</th>
</tr>
<tr class="even">
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>f64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>f64</th>
<th>str</th>
<th>i64</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>f64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>datetime[μs]</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2013</td>
<td>1</td>
<td>1</td>
<td>517.0</td>
<td>515</td>
<td>2.0</td>
<td>830.0</td>
<td>819</td>
<td>11.0</td>
<td>"UA"</td>
<td>1545</td>
<td>"N14228"</td>
<td>"EWR"</td>
<td>"IAH"</td>
<td>227.0</td>
<td>1400</td>
<td>5</td>
<td>15</td>
<td>2013-01-01 10:00:00</td>
</tr>
<tr class="even">
<td>2013</td>
<td>1</td>
<td>1</td>
<td>533.0</td>
<td>529</td>
<td>4.0</td>
<td>850.0</td>
<td>830</td>
<td>20.0</td>
<td>"UA"</td>
<td>1714</td>
<td>"N24211"</td>
<td>"LGA"</td>
<td>"IAH"</td>
<td>227.0</td>
<td>1416</td>
<td>5</td>
<td>29</td>
<td>2013-01-01 10:00:00</td>
</tr>
<tr class="odd">
<td>2013</td>
<td>1</td>
<td>1</td>
<td>542.0</td>
<td>540</td>
<td>2.0</td>
<td>923.0</td>
<td>850</td>
<td>33.0</td>
<td>"AA"</td>
<td>1141</td>
<td>"N619AA"</td>
<td>"JFK"</td>
<td>"MIA"</td>
<td>160.0</td>
<td>1089</td>
<td>5</td>
<td>40</td>
<td>2013-01-01 10:00:00</td>
</tr>
<tr class="even">
<td>2013</td>
<td>1</td>
<td>1</td>
<td>544.0</td>
<td>545</td>
<td>-1.0</td>
<td>1004.0</td>
<td>1022</td>
<td>-18.0</td>
<td>"B6"</td>
<td>725</td>
<td>"N804JB"</td>
<td>"JFK"</td>
<td>"BQN"</td>
<td>183.0</td>
<td>1576</td>
<td>5</td>
<td>45</td>
<td>2013-01-01 10:00:00</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="even">
<td>2013</td>
<td>2</td>
<td>28</td>
<td>null</td>
<td>905</td>
<td>null</td>
<td>null</td>
<td>1115</td>
<td>null</td>
<td>"MQ"</td>
<td>4478</td>
<td>"N722MQ"</td>
<td>"LGA"</td>
<td>"DTW"</td>
<td>null</td>
<td>502</td>
<td>9</td>
<td>5</td>
<td>2013-02-28 14:00:00</td>
</tr>
<tr class="odd">
<td>2013</td>
<td>2</td>
<td>28</td>
<td>null</td>
<td>1115</td>
<td>null</td>
<td>null</td>
<td>1310</td>
<td>null</td>
<td>"MQ"</td>
<td>4485</td>
<td>"N725MQ"</td>
<td>"LGA"</td>
<td>"CMH"</td>
<td>null</td>
<td>479</td>
<td>11</td>
<td>15</td>
<td>2013-02-28 16:00:00</td>
</tr>
<tr class="even">
<td>2013</td>
<td>2</td>
<td>28</td>
<td>null</td>
<td>830</td>
<td>null</td>
<td>null</td>
<td>1205</td>
<td>null</td>
<td>"UA"</td>
<td>1480</td>
<td>null</td>
<td>"EWR"</td>
<td>"SFO"</td>
<td>null</td>
<td>2565</td>
<td>8</td>
<td>30</td>
<td>2013-02-28 13:00:00</td>
</tr>
<tr class="odd">
<td>2013</td>
<td>2</td>
<td>28</td>
<td>null</td>
<td>840</td>
<td>null</td>
<td>null</td>
<td>1147</td>
<td>null</td>
<td>"UA"</td>
<td>443</td>
<td>null</td>
<td>"JFK"</td>
<td>"LAX"</td>
<td>null</td>
<td>2475</td>
<td>8</td>
<td>40</td>
<td>2013-02-28 13:00:00</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>There’s a useful shortcut when you’re combining <code>|</code> and
<code>==</code>: <code>Expr.is_in()</code>. It keeps rows where the
variable equals one of the values on the right:</p>
<div id="5e8d2395" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A shorter way to select flights that departed in January or February</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>flights.<span class="bu">filter</span>(</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>    pl.col(<span class="st">"month"</span>).is_in([<span class="dv">1</span>, <span class="dv">2</span>])</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (51_955, 19)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">dep_time</th>
<th data-quarto-table-cell-role="th">sched_dep_time</th>
<th data-quarto-table-cell-role="th">dep_delay</th>
<th data-quarto-table-cell-role="th">arr_time</th>
<th data-quarto-table-cell-role="th">sched_arr_time</th>
<th data-quarto-table-cell-role="th">arr_delay</th>
<th data-quarto-table-cell-role="th">carrier</th>
<th data-quarto-table-cell-role="th">flight</th>
<th data-quarto-table-cell-role="th">tailnum</th>
<th data-quarto-table-cell-role="th">origin</th>
<th data-quarto-table-cell-role="th">dest</th>
<th data-quarto-table-cell-role="th">air_time</th>
<th data-quarto-table-cell-role="th">distance</th>
<th data-quarto-table-cell-role="th">hour</th>
<th data-quarto-table-cell-role="th">minute</th>
<th data-quarto-table-cell-role="th">time_hour</th>
</tr>
<tr class="even">
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>f64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>f64</th>
<th>str</th>
<th>i64</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>f64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>datetime[μs]</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2013</td>
<td>1</td>
<td>1</td>
<td>517.0</td>
<td>515</td>
<td>2.0</td>
<td>830.0</td>
<td>819</td>
<td>11.0</td>
<td>"UA"</td>
<td>1545</td>
<td>"N14228"</td>
<td>"EWR"</td>
<td>"IAH"</td>
<td>227.0</td>
<td>1400</td>
<td>5</td>
<td>15</td>
<td>2013-01-01 10:00:00</td>
</tr>
<tr class="even">
<td>2013</td>
<td>1</td>
<td>1</td>
<td>533.0</td>
<td>529</td>
<td>4.0</td>
<td>850.0</td>
<td>830</td>
<td>20.0</td>
<td>"UA"</td>
<td>1714</td>
<td>"N24211"</td>
<td>"LGA"</td>
<td>"IAH"</td>
<td>227.0</td>
<td>1416</td>
<td>5</td>
<td>29</td>
<td>2013-01-01 10:00:00</td>
</tr>
<tr class="odd">
<td>2013</td>
<td>1</td>
<td>1</td>
<td>542.0</td>
<td>540</td>
<td>2.0</td>
<td>923.0</td>
<td>850</td>
<td>33.0</td>
<td>"AA"</td>
<td>1141</td>
<td>"N619AA"</td>
<td>"JFK"</td>
<td>"MIA"</td>
<td>160.0</td>
<td>1089</td>
<td>5</td>
<td>40</td>
<td>2013-01-01 10:00:00</td>
</tr>
<tr class="even">
<td>2013</td>
<td>1</td>
<td>1</td>
<td>544.0</td>
<td>545</td>
<td>-1.0</td>
<td>1004.0</td>
<td>1022</td>
<td>-18.0</td>
<td>"B6"</td>
<td>725</td>
<td>"N804JB"</td>
<td>"JFK"</td>
<td>"BQN"</td>
<td>183.0</td>
<td>1576</td>
<td>5</td>
<td>45</td>
<td>2013-01-01 10:00:00</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="even">
<td>2013</td>
<td>2</td>
<td>28</td>
<td>null</td>
<td>905</td>
<td>null</td>
<td>null</td>
<td>1115</td>
<td>null</td>
<td>"MQ"</td>
<td>4478</td>
<td>"N722MQ"</td>
<td>"LGA"</td>
<td>"DTW"</td>
<td>null</td>
<td>502</td>
<td>9</td>
<td>5</td>
<td>2013-02-28 14:00:00</td>
</tr>
<tr class="odd">
<td>2013</td>
<td>2</td>
<td>28</td>
<td>null</td>
<td>1115</td>
<td>null</td>
<td>null</td>
<td>1310</td>
<td>null</td>
<td>"MQ"</td>
<td>4485</td>
<td>"N725MQ"</td>
<td>"LGA"</td>
<td>"CMH"</td>
<td>null</td>
<td>479</td>
<td>11</td>
<td>15</td>
<td>2013-02-28 16:00:00</td>
</tr>
<tr class="even">
<td>2013</td>
<td>2</td>
<td>28</td>
<td>null</td>
<td>830</td>
<td>null</td>
<td>null</td>
<td>1205</td>
<td>null</td>
<td>"UA"</td>
<td>1480</td>
<td>null</td>
<td>"EWR"</td>
<td>"SFO"</td>
<td>null</td>
<td>2565</td>
<td>8</td>
<td>30</td>
<td>2013-02-28 13:00:00</td>
</tr>
<tr class="odd">
<td>2013</td>
<td>2</td>
<td>28</td>
<td>null</td>
<td>840</td>
<td>null</td>
<td>null</td>
<td>1147</td>
<td>null</td>
<td>"UA"</td>
<td>443</td>
<td>null</td>
<td>"JFK"</td>
<td>"LAX"</td>
<td>null</td>
<td>2475</td>
<td>8</td>
<td>40</td>
<td>2013-02-28 13:00:00</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>When you run <code>DataFrame.filter()</code>, Polars executes the
filtering operation, creating a new DataFrame, and then prints it. It
doesn’t modify the existing <code>flights</code> dataset because Polars
never modifies the input (unless when explicitly chosen). To save the
result, you need to use the assignment operator, <code>=</code>:</p>
<div id="990100f0" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>jan1 <span class="op">=</span> flights.<span class="bu">filter</span>((pl.col(<span class="st">"month"</span>) <span class="op">==</span> <span class="dv">1</span>) <span class="op">&amp;</span> (pl.col(<span class="st">"day"</span>) <span class="op">==</span> <span class="dv">1</span>))</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>jan1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (842, 19)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">dep_time</th>
<th data-quarto-table-cell-role="th">sched_dep_time</th>
<th data-quarto-table-cell-role="th">dep_delay</th>
<th data-quarto-table-cell-role="th">arr_time</th>
<th data-quarto-table-cell-role="th">sched_arr_time</th>
<th data-quarto-table-cell-role="th">arr_delay</th>
<th data-quarto-table-cell-role="th">carrier</th>
<th data-quarto-table-cell-role="th">flight</th>
<th data-quarto-table-cell-role="th">tailnum</th>
<th data-quarto-table-cell-role="th">origin</th>
<th data-quarto-table-cell-role="th">dest</th>
<th data-quarto-table-cell-role="th">air_time</th>
<th data-quarto-table-cell-role="th">distance</th>
<th data-quarto-table-cell-role="th">hour</th>
<th data-quarto-table-cell-role="th">minute</th>
<th data-quarto-table-cell-role="th">time_hour</th>
</tr>
<tr class="even">
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>f64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>f64</th>
<th>str</th>
<th>i64</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>f64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>datetime[μs]</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2013</td>
<td>1</td>
<td>1</td>
<td>517.0</td>
<td>515</td>
<td>2.0</td>
<td>830.0</td>
<td>819</td>
<td>11.0</td>
<td>"UA"</td>
<td>1545</td>
<td>"N14228"</td>
<td>"EWR"</td>
<td>"IAH"</td>
<td>227.0</td>
<td>1400</td>
<td>5</td>
<td>15</td>
<td>2013-01-01 10:00:00</td>
</tr>
<tr class="even">
<td>2013</td>
<td>1</td>
<td>1</td>
<td>533.0</td>
<td>529</td>
<td>4.0</td>
<td>850.0</td>
<td>830</td>
<td>20.0</td>
<td>"UA"</td>
<td>1714</td>
<td>"N24211"</td>
<td>"LGA"</td>
<td>"IAH"</td>
<td>227.0</td>
<td>1416</td>
<td>5</td>
<td>29</td>
<td>2013-01-01 10:00:00</td>
</tr>
<tr class="odd">
<td>2013</td>
<td>1</td>
<td>1</td>
<td>542.0</td>
<td>540</td>
<td>2.0</td>
<td>923.0</td>
<td>850</td>
<td>33.0</td>
<td>"AA"</td>
<td>1141</td>
<td>"N619AA"</td>
<td>"JFK"</td>
<td>"MIA"</td>
<td>160.0</td>
<td>1089</td>
<td>5</td>
<td>40</td>
<td>2013-01-01 10:00:00</td>
</tr>
<tr class="even">
<td>2013</td>
<td>1</td>
<td>1</td>
<td>544.0</td>
<td>545</td>
<td>-1.0</td>
<td>1004.0</td>
<td>1022</td>
<td>-18.0</td>
<td>"B6"</td>
<td>725</td>
<td>"N804JB"</td>
<td>"JFK"</td>
<td>"BQN"</td>
<td>183.0</td>
<td>1576</td>
<td>5</td>
<td>45</td>
<td>2013-01-01 10:00:00</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="even">
<td>2013</td>
<td>1</td>
<td>1</td>
<td>null</td>
<td>1630</td>
<td>null</td>
<td>null</td>
<td>1815</td>
<td>null</td>
<td>"EV"</td>
<td>4308</td>
<td>"N18120"</td>
<td>"EWR"</td>
<td>"RDU"</td>
<td>null</td>
<td>416</td>
<td>16</td>
<td>30</td>
<td>2013-01-01 21:00:00</td>
</tr>
<tr class="odd">
<td>2013</td>
<td>1</td>
<td>1</td>
<td>null</td>
<td>1935</td>
<td>null</td>
<td>null</td>
<td>2240</td>
<td>null</td>
<td>"AA"</td>
<td>791</td>
<td>"N3EHAA"</td>
<td>"LGA"</td>
<td>"DFW"</td>
<td>null</td>
<td>1389</td>
<td>19</td>
<td>35</td>
<td>2013-01-02 00:00:00</td>
</tr>
<tr class="even">
<td>2013</td>
<td>1</td>
<td>1</td>
<td>null</td>
<td>1500</td>
<td>null</td>
<td>null</td>
<td>1825</td>
<td>null</td>
<td>"AA"</td>
<td>1925</td>
<td>"N3EVAA"</td>
<td>"LGA"</td>
<td>"MIA"</td>
<td>null</td>
<td>1096</td>
<td>15</td>
<td>0</td>
<td>2013-01-01 20:00:00</td>
</tr>
<tr class="odd">
<td>2013</td>
<td>1</td>
<td>1</td>
<td>null</td>
<td>600</td>
<td>null</td>
<td>null</td>
<td>901</td>
<td>null</td>
<td>"B6"</td>
<td>125</td>
<td>"N618JB"</td>
<td>"JFK"</td>
<td>"FLL"</td>
<td>null</td>
<td>1069</td>
<td>6</td>
<td>0</td>
<td>2013-01-01 11:00:00</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="dataframe.sort" class="level4" data-number="3.2.2">
<h4 data-number="3.2.2" class="anchored" data-anchor-id="dataframe.sort"><span class="header-section-number">3.2.2</span>
<code>DataFrame.sort()</code></h4>
<p><a href="https://docs.pola.rs/api/python/stable/reference/dataframe/api/polars.DataFrame.sort.html"><code>DataFrame.sort()</code></a>
changes the order of the rows based on the value of the columns. It
takes a data frame and a set of column names (or more complicated
expressions) to order by. If you provide more than one column name, each
additional column will be used to break ties in the values of the
preceding columns. For example, the following code sorts by the
departure time, which is spread over four columns. We get the earliest
years first, then within a year, the earliest months, etc.</p>
<div id="f1725506" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>flights.sort(by<span class="op">=</span>[<span class="st">"year"</span>, <span class="st">"month"</span>, <span class="st">"day"</span>, <span class="st">"dep_time"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (336_776, 19)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">dep_time</th>
<th data-quarto-table-cell-role="th">sched_dep_time</th>
<th data-quarto-table-cell-role="th">dep_delay</th>
<th data-quarto-table-cell-role="th">arr_time</th>
<th data-quarto-table-cell-role="th">sched_arr_time</th>
<th data-quarto-table-cell-role="th">arr_delay</th>
<th data-quarto-table-cell-role="th">carrier</th>
<th data-quarto-table-cell-role="th">flight</th>
<th data-quarto-table-cell-role="th">tailnum</th>
<th data-quarto-table-cell-role="th">origin</th>
<th data-quarto-table-cell-role="th">dest</th>
<th data-quarto-table-cell-role="th">air_time</th>
<th data-quarto-table-cell-role="th">distance</th>
<th data-quarto-table-cell-role="th">hour</th>
<th data-quarto-table-cell-role="th">minute</th>
<th data-quarto-table-cell-role="th">time_hour</th>
</tr>
<tr class="even">
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>f64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>f64</th>
<th>str</th>
<th>i64</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>f64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>datetime[μs]</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2013</td>
<td>1</td>
<td>1</td>
<td>null</td>
<td>1935</td>
<td>null</td>
<td>null</td>
<td>2240</td>
<td>null</td>
<td>"AA"</td>
<td>791</td>
<td>"N3EHAA"</td>
<td>"LGA"</td>
<td>"DFW"</td>
<td>null</td>
<td>1389</td>
<td>19</td>
<td>35</td>
<td>2013-01-02 00:00:00</td>
</tr>
<tr class="even">
<td>2013</td>
<td>1</td>
<td>1</td>
<td>null</td>
<td>1500</td>
<td>null</td>
<td>null</td>
<td>1825</td>
<td>null</td>
<td>"AA"</td>
<td>1925</td>
<td>"N3EVAA"</td>
<td>"LGA"</td>
<td>"MIA"</td>
<td>null</td>
<td>1096</td>
<td>15</td>
<td>0</td>
<td>2013-01-01 20:00:00</td>
</tr>
<tr class="odd">
<td>2013</td>
<td>1</td>
<td>1</td>
<td>null</td>
<td>1630</td>
<td>null</td>
<td>null</td>
<td>1815</td>
<td>null</td>
<td>"EV"</td>
<td>4308</td>
<td>"N18120"</td>
<td>"EWR"</td>
<td>"RDU"</td>
<td>null</td>
<td>416</td>
<td>16</td>
<td>30</td>
<td>2013-01-01 21:00:00</td>
</tr>
<tr class="even">
<td>2013</td>
<td>1</td>
<td>1</td>
<td>null</td>
<td>600</td>
<td>null</td>
<td>null</td>
<td>901</td>
<td>null</td>
<td>"B6"</td>
<td>125</td>
<td>"N618JB"</td>
<td>"JFK"</td>
<td>"FLL"</td>
<td>null</td>
<td>1069</td>
<td>6</td>
<td>0</td>
<td>2013-01-01 11:00:00</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="even">
<td>2013</td>
<td>12</td>
<td>31</td>
<td>2328.0</td>
<td>2330</td>
<td>-2.0</td>
<td>412.0</td>
<td>409</td>
<td>3.0</td>
<td>"B6"</td>
<td>1389</td>
<td>"N651JB"</td>
<td>"EWR"</td>
<td>"SJU"</td>
<td>198.0</td>
<td>1608</td>
<td>23</td>
<td>30</td>
<td>2014-01-01 04:00:00</td>
</tr>
<tr class="odd">
<td>2013</td>
<td>12</td>
<td>31</td>
<td>2332.0</td>
<td>2245</td>
<td>47.0</td>
<td>58.0</td>
<td>3</td>
<td>55.0</td>
<td>"B6"</td>
<td>486</td>
<td>"N334JB"</td>
<td>"JFK"</td>
<td>"ROC"</td>
<td>60.0</td>
<td>264</td>
<td>22</td>
<td>45</td>
<td>2014-01-01 03:00:00</td>
</tr>
<tr class="even">
<td>2013</td>
<td>12</td>
<td>31</td>
<td>2355.0</td>
<td>2359</td>
<td>-4.0</td>
<td>430.0</td>
<td>440</td>
<td>-10.0</td>
<td>"B6"</td>
<td>1503</td>
<td>"N509JB"</td>
<td>"JFK"</td>
<td>"SJU"</td>
<td>195.0</td>
<td>1598</td>
<td>23</td>
<td>59</td>
<td>2014-01-01 04:00:00</td>
</tr>
<tr class="odd">
<td>2013</td>
<td>12</td>
<td>31</td>
<td>2356.0</td>
<td>2359</td>
<td>-3.0</td>
<td>436.0</td>
<td>445</td>
<td>-9.0</td>
<td>"B6"</td>
<td>745</td>
<td>"N665JB"</td>
<td>"JFK"</td>
<td>"PSE"</td>
<td>200.0</td>
<td>1617</td>
<td>23</td>
<td>59</td>
<td>2014-01-01 04:00:00</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>You can use positional arguments to sort by multiple columns in the
same way:</p>
<div id="fdb169d6" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>flights.sort(</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>    by<span class="op">=</span>[<span class="st">"year"</span>, <span class="st">"month"</span>, <span class="st">"day"</span>, <span class="st">"dep_time"</span>],</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>    descending<span class="op">=</span>[<span class="va">False</span>, <span class="va">False</span>, <span class="va">False</span>, <span class="va">True</span>]</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (336_776, 19)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">dep_time</th>
<th data-quarto-table-cell-role="th">sched_dep_time</th>
<th data-quarto-table-cell-role="th">dep_delay</th>
<th data-quarto-table-cell-role="th">arr_time</th>
<th data-quarto-table-cell-role="th">sched_arr_time</th>
<th data-quarto-table-cell-role="th">arr_delay</th>
<th data-quarto-table-cell-role="th">carrier</th>
<th data-quarto-table-cell-role="th">flight</th>
<th data-quarto-table-cell-role="th">tailnum</th>
<th data-quarto-table-cell-role="th">origin</th>
<th data-quarto-table-cell-role="th">dest</th>
<th data-quarto-table-cell-role="th">air_time</th>
<th data-quarto-table-cell-role="th">distance</th>
<th data-quarto-table-cell-role="th">hour</th>
<th data-quarto-table-cell-role="th">minute</th>
<th data-quarto-table-cell-role="th">time_hour</th>
</tr>
<tr class="even">
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>f64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>f64</th>
<th>str</th>
<th>i64</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>f64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>datetime[μs]</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2013</td>
<td>1</td>
<td>1</td>
<td>null</td>
<td>600</td>
<td>null</td>
<td>null</td>
<td>901</td>
<td>null</td>
<td>"B6"</td>
<td>125</td>
<td>"N618JB"</td>
<td>"JFK"</td>
<td>"FLL"</td>
<td>null</td>
<td>1069</td>
<td>6</td>
<td>0</td>
<td>2013-01-01 11:00:00</td>
</tr>
<tr class="even">
<td>2013</td>
<td>1</td>
<td>1</td>
<td>null</td>
<td>1500</td>
<td>null</td>
<td>null</td>
<td>1825</td>
<td>null</td>
<td>"AA"</td>
<td>1925</td>
<td>"N3EVAA"</td>
<td>"LGA"</td>
<td>"MIA"</td>
<td>null</td>
<td>1096</td>
<td>15</td>
<td>0</td>
<td>2013-01-01 20:00:00</td>
</tr>
<tr class="odd">
<td>2013</td>
<td>1</td>
<td>1</td>
<td>null</td>
<td>1935</td>
<td>null</td>
<td>null</td>
<td>2240</td>
<td>null</td>
<td>"AA"</td>
<td>791</td>
<td>"N3EHAA"</td>
<td>"LGA"</td>
<td>"DFW"</td>
<td>null</td>
<td>1389</td>
<td>19</td>
<td>35</td>
<td>2013-01-02 00:00:00</td>
</tr>
<tr class="even">
<td>2013</td>
<td>1</td>
<td>1</td>
<td>null</td>
<td>1630</td>
<td>null</td>
<td>null</td>
<td>1815</td>
<td>null</td>
<td>"EV"</td>
<td>4308</td>
<td>"N18120"</td>
<td>"EWR"</td>
<td>"RDU"</td>
<td>null</td>
<td>416</td>
<td>16</td>
<td>30</td>
<td>2013-01-01 21:00:00</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="even">
<td>2013</td>
<td>12</td>
<td>31</td>
<td>459.0</td>
<td>500</td>
<td>-1.0</td>
<td>655.0</td>
<td>651</td>
<td>4.0</td>
<td>"US"</td>
<td>1895</td>
<td>"N557UW"</td>
<td>"EWR"</td>
<td>"CLT"</td>
<td>95.0</td>
<td>529</td>
<td>5</td>
<td>0</td>
<td>2013-12-31 10:00:00</td>
</tr>
<tr class="odd">
<td>2013</td>
<td>12</td>
<td>31</td>
<td>26.0</td>
<td>2245</td>
<td>101.0</td>
<td>129.0</td>
<td>2353</td>
<td>96.0</td>
<td>"B6"</td>
<td>108</td>
<td>"N374JB"</td>
<td>"JFK"</td>
<td>"PWM"</td>
<td>50.0</td>
<td>273</td>
<td>22</td>
<td>45</td>
<td>2014-01-01 03:00:00</td>
</tr>
<tr class="even">
<td>2013</td>
<td>12</td>
<td>31</td>
<td>18.0</td>
<td>2359</td>
<td>19.0</td>
<td>449.0</td>
<td>444</td>
<td>5.0</td>
<td>"DL"</td>
<td>412</td>
<td>"N713TW"</td>
<td>"JFK"</td>
<td>"SJU"</td>
<td>192.0</td>
<td>1598</td>
<td>23</td>
<td>59</td>
<td>2014-01-01 04:00:00</td>
</tr>
<tr class="odd">
<td>2013</td>
<td>12</td>
<td>31</td>
<td>13.0</td>
<td>2359</td>
<td>14.0</td>
<td>439.0</td>
<td>437</td>
<td>2.0</td>
<td>"B6"</td>
<td>839</td>
<td>"N566JB"</td>
<td>"JFK"</td>
<td>"BQN"</td>
<td>189.0</td>
<td>1576</td>
<td>23</td>
<td>59</td>
<td>2014-01-01 04:00:00</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Note that the number of rows has not changed, we’re only arranging
the data, we’re not filtering it.</p>
</section>
<section id="dataframe.unique" class="level4" data-number="3.2.3">
<h4 data-number="3.2.3" class="anchored" data-anchor-id="dataframe.unique"><span class="header-section-number">3.2.3</span>
<code>DataFrame.unique()</code></h4>
<p><a href="https://docs.pola.rs/api/python/stable/reference/dataframe/api/polars.DataFrame.unique.html"><code>DataFrame.unique()</code></a>
finds all the unique rows in a dataset, so technically, it primarily
operates on the rows. Most of the time, however, you’ll want the
distinct combination of some variables, so you can also optionally
supply column names:</p>
<div id="04156ec9" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove duplicate rows, if any</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>flights.unique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (336_776, 19)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">dep_time</th>
<th data-quarto-table-cell-role="th">sched_dep_time</th>
<th data-quarto-table-cell-role="th">dep_delay</th>
<th data-quarto-table-cell-role="th">arr_time</th>
<th data-quarto-table-cell-role="th">sched_arr_time</th>
<th data-quarto-table-cell-role="th">arr_delay</th>
<th data-quarto-table-cell-role="th">carrier</th>
<th data-quarto-table-cell-role="th">flight</th>
<th data-quarto-table-cell-role="th">tailnum</th>
<th data-quarto-table-cell-role="th">origin</th>
<th data-quarto-table-cell-role="th">dest</th>
<th data-quarto-table-cell-role="th">air_time</th>
<th data-quarto-table-cell-role="th">distance</th>
<th data-quarto-table-cell-role="th">hour</th>
<th data-quarto-table-cell-role="th">minute</th>
<th data-quarto-table-cell-role="th">time_hour</th>
</tr>
<tr class="even">
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>f64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>f64</th>
<th>str</th>
<th>i64</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>f64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>datetime[μs]</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2013</td>
<td>6</td>
<td>29</td>
<td>2003.0</td>
<td>1958</td>
<td>5.0</td>
<td>2205.0</td>
<td>2245</td>
<td>-40.0</td>
<td>"UA"</td>
<td>1555</td>
<td>"N36207"</td>
<td>"EWR"</td>
<td>"SAN"</td>
<td>289.0</td>
<td>2425</td>
<td>19</td>
<td>58</td>
<td>2013-06-29 23:00:00</td>
</tr>
<tr class="even">
<td>2013</td>
<td>8</td>
<td>30</td>
<td>539.0</td>
<td>545</td>
<td>-6.0</td>
<td>932.0</td>
<td>921</td>
<td>11.0</td>
<td>"B6"</td>
<td>939</td>
<td>"N524JB"</td>
<td>"JFK"</td>
<td>"BQN"</td>
<td>192.0</td>
<td>1576</td>
<td>5</td>
<td>45</td>
<td>2013-08-30 09:00:00</td>
</tr>
<tr class="odd">
<td>2013</td>
<td>10</td>
<td>7</td>
<td>556.0</td>
<td>600</td>
<td>-4.0</td>
<td>702.0</td>
<td>659</td>
<td>3.0</td>
<td>"US"</td>
<td>2167</td>
<td>"N766US"</td>
<td>"LGA"</td>
<td>"DCA"</td>
<td>46.0</td>
<td>214</td>
<td>6</td>
<td>0</td>
<td>2013-10-07 10:00:00</td>
</tr>
<tr class="even">
<td>2013</td>
<td>2</td>
<td>13</td>
<td>1352.0</td>
<td>1400</td>
<td>-8.0</td>
<td>1447.0</td>
<td>1503</td>
<td>-16.0</td>
<td>"US"</td>
<td>2130</td>
<td>"N945UW"</td>
<td>"LGA"</td>
<td>"BOS"</td>
<td>38.0</td>
<td>184</td>
<td>14</td>
<td>0</td>
<td>2013-02-13 19:00:00</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="even">
<td>2013</td>
<td>5</td>
<td>8</td>
<td>1556.0</td>
<td>1355</td>
<td>121.0</td>
<td>1806.0</td>
<td>1604</td>
<td>122.0</td>
<td>"EV"</td>
<td>4115</td>
<td>"N14916"</td>
<td>"EWR"</td>
<td>"SAV"</td>
<td>104.0</td>
<td>708</td>
<td>13</td>
<td>55</td>
<td>2013-05-08 17:00:00</td>
</tr>
<tr class="odd">
<td>2013</td>
<td>9</td>
<td>24</td>
<td>1349.0</td>
<td>1359</td>
<td>-10.0</td>
<td>1452.0</td>
<td>1511</td>
<td>-19.0</td>
<td>"B6"</td>
<td>118</td>
<td>"N281JB"</td>
<td>"JFK"</td>
<td>"BOS"</td>
<td>40.0</td>
<td>187</td>
<td>13</td>
<td>59</td>
<td>2013-09-24 17:00:00</td>
</tr>
<tr class="even">
<td>2013</td>
<td>8</td>
<td>3</td>
<td>2151.0</td>
<td>2150</td>
<td>1.0</td>
<td>38.0</td>
<td>45</td>
<td>-7.0</td>
<td>"B6"</td>
<td>1201</td>
<td>"N729JB"</td>
<td>"JFK"</td>
<td>"FLL"</td>
<td>137.0</td>
<td>1069</td>
<td>21</td>
<td>50</td>
<td>2013-08-04 01:00:00</td>
</tr>
<tr class="odd">
<td>2013</td>
<td>3</td>
<td>19</td>
<td>1600.0</td>
<td>1600</td>
<td>0.0</td>
<td>1841.0</td>
<td>1838</td>
<td>3.0</td>
<td>"DL"</td>
<td>847</td>
<td>"N648DL"</td>
<td>"LGA"</td>
<td>"ATL"</td>
<td>116.0</td>
<td>762</td>
<td>16</td>
<td>0</td>
<td>2013-03-19 20:00:00</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="48021528" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find all unique origin and destination pairs</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>flights.unique(subset<span class="op">=</span>[<span class="st">"origin"</span>, <span class="st">"dest"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (224, 19)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">dep_time</th>
<th data-quarto-table-cell-role="th">sched_dep_time</th>
<th data-quarto-table-cell-role="th">dep_delay</th>
<th data-quarto-table-cell-role="th">arr_time</th>
<th data-quarto-table-cell-role="th">sched_arr_time</th>
<th data-quarto-table-cell-role="th">arr_delay</th>
<th data-quarto-table-cell-role="th">carrier</th>
<th data-quarto-table-cell-role="th">flight</th>
<th data-quarto-table-cell-role="th">tailnum</th>
<th data-quarto-table-cell-role="th">origin</th>
<th data-quarto-table-cell-role="th">dest</th>
<th data-quarto-table-cell-role="th">air_time</th>
<th data-quarto-table-cell-role="th">distance</th>
<th data-quarto-table-cell-role="th">hour</th>
<th data-quarto-table-cell-role="th">minute</th>
<th data-quarto-table-cell-role="th">time_hour</th>
</tr>
<tr class="even">
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>f64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>f64</th>
<th>str</th>
<th>i64</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>f64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>datetime[μs]</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2013</td>
<td>1</td>
<td>1</td>
<td>1353.0</td>
<td>1357</td>
<td>-4.0</td>
<td>1549.0</td>
<td>1525</td>
<td>24.0</td>
<td>"EV"</td>
<td>4171</td>
<td>"N14105"</td>
<td>"EWR"</td>
<td>"MSN"</td>
<td>152.0</td>
<td>799</td>
<td>13</td>
<td>57</td>
<td>2013-01-01 18:00:00</td>
</tr>
<tr class="even">
<td>2013</td>
<td>1</td>
<td>1</td>
<td>1522.0</td>
<td>1530</td>
<td>-8.0</td>
<td>1731.0</td>
<td>1725</td>
<td>6.0</td>
<td>"MQ"</td>
<td>4146</td>
<td>"N902MQ"</td>
<td>"JFK"</td>
<td>"CMH"</td>
<td>98.0</td>
<td>483</td>
<td>15</td>
<td>30</td>
<td>2013-01-01 20:00:00</td>
</tr>
<tr class="odd">
<td>2013</td>
<td>1</td>
<td>2</td>
<td>2044.0</td>
<td>2005</td>
<td>39.0</td>
<td>2229.0</td>
<td>2158</td>
<td>31.0</td>
<td>"EV"</td>
<td>5114</td>
<td>"N371CA"</td>
<td>"LGA"</td>
<td>"BHM"</td>
<td>143.0</td>
<td>866</td>
<td>20</td>
<td>5</td>
<td>2013-01-03 01:00:00</td>
</tr>
<tr class="even">
<td>2013</td>
<td>1</td>
<td>1</td>
<td>914.0</td>
<td>900</td>
<td>14.0</td>
<td>1058.0</td>
<td>1043</td>
<td>15.0</td>
<td>"UA"</td>
<td>783</td>
<td>"N810UA"</td>
<td>"EWR"</td>
<td>"CLE"</td>
<td>85.0</td>
<td>404</td>
<td>9</td>
<td>0</td>
<td>2013-01-01 14:00:00</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="even">
<td>2013</td>
<td>1</td>
<td>1</td>
<td>615.0</td>
<td>615</td>
<td>0.0</td>
<td>833.0</td>
<td>842</td>
<td>-9.0</td>
<td>"DL"</td>
<td>575</td>
<td>"N326NB"</td>
<td>"EWR"</td>
<td>"ATL"</td>
<td>120.0</td>
<td>746</td>
<td>6</td>
<td>15</td>
<td>2013-01-01 11:00:00</td>
</tr>
<tr class="odd">
<td>2013</td>
<td>11</td>
<td>2</td>
<td>1519.0</td>
<td>1459</td>
<td>20.0</td>
<td>1654.0</td>
<td>1702</td>
<td>-8.0</td>
<td>"DL"</td>
<td>567</td>
<td>"N329NB"</td>
<td>"JFK"</td>
<td>"STL"</td>
<td>129.0</td>
<td>892</td>
<td>14</td>
<td>59</td>
<td>2013-11-02 18:00:00</td>
</tr>
<tr class="even">
<td>2013</td>
<td>10</td>
<td>1</td>
<td>955.0</td>
<td>1000</td>
<td>-5.0</td>
<td>1156.0</td>
<td>1234</td>
<td>-38.0</td>
<td>"9E"</td>
<td>3574</td>
<td>"N913XJ"</td>
<td>"LGA"</td>
<td>"IND"</td>
<td>93.0</td>
<td>660</td>
<td>10</td>
<td>0</td>
<td>2013-10-01 14:00:00</td>
</tr>
<tr class="odd">
<td>2013</td>
<td>1</td>
<td>1</td>
<td>2016.0</td>
<td>1930</td>
<td>46.0</td>
<td>null</td>
<td>2220</td>
<td>null</td>
<td>"EV"</td>
<td>4204</td>
<td>"N14168"</td>
<td>"EWR"</td>
<td>"OKC"</td>
<td>null</td>
<td>1325</td>
<td>19</td>
<td>30</td>
<td>2013-01-02 00:00:00</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>It should be noted that the default argument for <code>keep</code> is
<code>any</code>, which <strong>does not give any guarantee of which
unique rows are kept</strong>. If you dataset is ordered, you might want
to use one of the other options for <code>keep</code>.</p>
<p>If you want the number of occurrences instead, you’ll need to use a
combination of <code>DataFrame.group_by</code> along with a
<code>GroupBy.agg()</code>.</p>
</section>
</section>
<section id="columns" class="level3" data-number="3.3">
<h3 data-number="3.3" class="anchored" data-anchor-id="columns"><span class="header-section-number">3.3</span>
Columns</h3>
<p>There are two important contexts that affect the columns without
changing the rows: <code>DataFrame.with_columns()</code>, which creates
new columns that are derived from the existing columns, &amp;
<code>select()</code>, which changes which columns are present.</p>
<section id="dataframe.with_columns" class="level4" data-number="3.3.1">
<h4 data-number="3.3.1" class="anchored" data-anchor-id="dataframe.with_columns"><span class="header-section-number">3.3.1</span>
<code>DataFrame.with_columns()</code></h4>
<p>The job of <a href="https://docs.pola.rs/api/python/stable/reference/dataframe/api/polars.DataFrame.with_columns.html"><code>DataFrame.with_columns()</code></a>
is to add new columns. In the Data Wrangling module, you will learn a
large set of functions that you can use to manipulate different types of
variables. For new, we’ll stick with basic algebra, which allows us to
compute the <code>gain</code>, how much time a delayed flight made up in
the air, and the <code>speed</code> in miles per hour:</p>
<div id="e1e934ce" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>flights.with_columns(</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>    gain <span class="op">=</span> pl.col(<span class="st">"dep_delay"</span>) <span class="op">-</span> pl.col(<span class="st">"arr_delay"</span>),</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>    speed <span class="op">=</span> pl.col(<span class="st">"distance"</span>) <span class="op">/</span> pl.col(<span class="st">"air_time"</span>) <span class="op">*</span> <span class="dv">60</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="47">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (336_776, 21)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">dep_time</th>
<th data-quarto-table-cell-role="th">sched_dep_time</th>
<th data-quarto-table-cell-role="th">dep_delay</th>
<th data-quarto-table-cell-role="th">arr_time</th>
<th data-quarto-table-cell-role="th">sched_arr_time</th>
<th data-quarto-table-cell-role="th">arr_delay</th>
<th data-quarto-table-cell-role="th">carrier</th>
<th data-quarto-table-cell-role="th">flight</th>
<th data-quarto-table-cell-role="th">tailnum</th>
<th data-quarto-table-cell-role="th">origin</th>
<th data-quarto-table-cell-role="th">dest</th>
<th data-quarto-table-cell-role="th">air_time</th>
<th data-quarto-table-cell-role="th">distance</th>
<th data-quarto-table-cell-role="th">hour</th>
<th data-quarto-table-cell-role="th">minute</th>
<th data-quarto-table-cell-role="th">time_hour</th>
<th data-quarto-table-cell-role="th">gain</th>
<th data-quarto-table-cell-role="th">speed</th>
</tr>
<tr class="even">
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>f64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>f64</th>
<th>str</th>
<th>i64</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>f64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>datetime[μs]</th>
<th>f64</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2013</td>
<td>1</td>
<td>1</td>
<td>517.0</td>
<td>515</td>
<td>2.0</td>
<td>830.0</td>
<td>819</td>
<td>11.0</td>
<td>"UA"</td>
<td>1545</td>
<td>"N14228"</td>
<td>"EWR"</td>
<td>"IAH"</td>
<td>227.0</td>
<td>1400</td>
<td>5</td>
<td>15</td>
<td>2013-01-01 10:00:00</td>
<td>-9.0</td>
<td>370.044053</td>
</tr>
<tr class="even">
<td>2013</td>
<td>1</td>
<td>1</td>
<td>533.0</td>
<td>529</td>
<td>4.0</td>
<td>850.0</td>
<td>830</td>
<td>20.0</td>
<td>"UA"</td>
<td>1714</td>
<td>"N24211"</td>
<td>"LGA"</td>
<td>"IAH"</td>
<td>227.0</td>
<td>1416</td>
<td>5</td>
<td>29</td>
<td>2013-01-01 10:00:00</td>
<td>-16.0</td>
<td>374.273128</td>
</tr>
<tr class="odd">
<td>2013</td>
<td>1</td>
<td>1</td>
<td>542.0</td>
<td>540</td>
<td>2.0</td>
<td>923.0</td>
<td>850</td>
<td>33.0</td>
<td>"AA"</td>
<td>1141</td>
<td>"N619AA"</td>
<td>"JFK"</td>
<td>"MIA"</td>
<td>160.0</td>
<td>1089</td>
<td>5</td>
<td>40</td>
<td>2013-01-01 10:00:00</td>
<td>-31.0</td>
<td>408.375</td>
</tr>
<tr class="even">
<td>2013</td>
<td>1</td>
<td>1</td>
<td>544.0</td>
<td>545</td>
<td>-1.0</td>
<td>1004.0</td>
<td>1022</td>
<td>-18.0</td>
<td>"B6"</td>
<td>725</td>
<td>"N804JB"</td>
<td>"JFK"</td>
<td>"BQN"</td>
<td>183.0</td>
<td>1576</td>
<td>5</td>
<td>45</td>
<td>2013-01-01 10:00:00</td>
<td>17.0</td>
<td>516.721311</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="even">
<td>2013</td>
<td>9</td>
<td>30</td>
<td>null</td>
<td>2200</td>
<td>null</td>
<td>null</td>
<td>2312</td>
<td>null</td>
<td>"9E"</td>
<td>3525</td>
<td>null</td>
<td>"LGA"</td>
<td>"SYR"</td>
<td>null</td>
<td>198</td>
<td>22</td>
<td>0</td>
<td>2013-10-01 02:00:00</td>
<td>null</td>
<td>null</td>
</tr>
<tr class="odd">
<td>2013</td>
<td>9</td>
<td>30</td>
<td>null</td>
<td>1210</td>
<td>null</td>
<td>null</td>
<td>1330</td>
<td>null</td>
<td>"MQ"</td>
<td>3461</td>
<td>"N535MQ"</td>
<td>"LGA"</td>
<td>"BNA"</td>
<td>null</td>
<td>764</td>
<td>12</td>
<td>10</td>
<td>2013-09-30 16:00:00</td>
<td>null</td>
<td>null</td>
</tr>
<tr class="even">
<td>2013</td>
<td>9</td>
<td>30</td>
<td>null</td>
<td>1159</td>
<td>null</td>
<td>null</td>
<td>1344</td>
<td>null</td>
<td>"MQ"</td>
<td>3572</td>
<td>"N511MQ"</td>
<td>"LGA"</td>
<td>"CLE"</td>
<td>null</td>
<td>419</td>
<td>11</td>
<td>59</td>
<td>2013-09-30 15:00:00</td>
<td>null</td>
<td>null</td>
</tr>
<tr class="odd">
<td>2013</td>
<td>9</td>
<td>30</td>
<td>null</td>
<td>840</td>
<td>null</td>
<td>null</td>
<td>1020</td>
<td>null</td>
<td>"MQ"</td>
<td>3531</td>
<td>"N839MQ"</td>
<td>"LGA"</td>
<td>"RDU"</td>
<td>null</td>
<td>431</td>
<td>8</td>
<td>40</td>
<td>2013-09-30 12:00:00</td>
<td>null</td>
<td>null</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Note that since we haven’t assigned the result of the above
computation back to <code>flights</code>, the new variables
<code>gain</code> and <code>speed</code> will only be printed but will
not be stored in a data frame. And if we want them to be available in a
data frame for future use, we should think carefully about whether we
want the result to be assigned back to <code>flights</code>, overwriting
the original data frame with many more variables, or to a new object.
Often, the right answer is a new object that is named informatively to
indicate its contents, e.g., <code>delay_gain</code>, but you might also
have good reasons for overwriting <code>flights</code>.</p>
</section>
<section id="dataframe.select" class="level4" data-number="3.3.2">
<h4 data-number="3.3.2" class="anchored" data-anchor-id="dataframe.select"><span class="header-section-number">3.3.2</span>
<code>DataFrame.select()</code></h4>
<p>It’s not uncommon to get datasets with hundreds or even thousands of
variables. In this situation, the first challenge is often just focusing
on the variables you’re interested in. <a href="https://docs.pola.rs/api/python/stable/reference/dataframe/api/polars.DataFrame.select.html"><code>DataFrame.select()</code></a>
allows you to rapidly zoom in on a useful subset using operations based
on the names of the variables:</p>
<ul>
<li>Select columns by name:</li>
</ul>
<div id="f11eb25b" class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>flights.select(<span class="st">"year"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (336_776, 1)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">year</th>
</tr>
<tr class="even">
<th>i64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2013</td>
</tr>
<tr class="even">
<td>2013</td>
</tr>
<tr class="odd">
<td>2013</td>
</tr>
<tr class="even">
<td>2013</td>
</tr>
<tr class="odd">
<td>…</td>
</tr>
<tr class="even">
<td>2013</td>
</tr>
<tr class="odd">
<td>2013</td>
</tr>
<tr class="even">
<td>2013</td>
</tr>
<tr class="odd">
<td>2013</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<ul>
<li>Select multiple columns by passing a list of column names:</li>
</ul>
<div id="00b712ff" class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>flights.select([<span class="st">"year"</span>, <span class="st">"month"</span>, <span class="st">"day"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="49">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (336_776, 3)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
</tr>
<tr class="even">
<th>i64</th>
<th>i64</th>
<th>i64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2013</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td>2013</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="odd">
<td>2013</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td>2013</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="even">
<td>2013</td>
<td>9</td>
<td>30</td>
</tr>
<tr class="odd">
<td>2013</td>
<td>9</td>
<td>30</td>
</tr>
<tr class="even">
<td>2013</td>
<td>9</td>
<td>30</td>
</tr>
<tr class="odd">
<td>2013</td>
<td>9</td>
<td>30</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<ul>
<li>Multiple columns can also be selected using positional arguments
instead of a list. Expressions are also accepted:</li>
</ul>
<div id="b350b6c6" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>flights.select(</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>    pl.col(<span class="st">"year"</span>),</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>    pl.col(<span class="st">"month"</span>),</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>    month_add_one <span class="op">=</span> pl.col(<span class="st">"month"</span>) <span class="op">+</span> <span class="dv">1</span> <span class="co"># Adds 1 to the values of "month"</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="50">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (336_776, 3)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">month_add_one</th>
</tr>
<tr class="even">
<th>i64</th>
<th>i64</th>
<th>i64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2013</td>
<td>1</td>
<td>2</td>
</tr>
<tr class="even">
<td>2013</td>
<td>1</td>
<td>2</td>
</tr>
<tr class="odd">
<td>2013</td>
<td>1</td>
<td>2</td>
</tr>
<tr class="even">
<td>2013</td>
<td>1</td>
<td>2</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="even">
<td>2013</td>
<td>9</td>
<td>10</td>
</tr>
<tr class="odd">
<td>2013</td>
<td>9</td>
<td>10</td>
</tr>
<tr class="even">
<td>2013</td>
<td>9</td>
<td>10</td>
</tr>
<tr class="odd">
<td>2013</td>
<td>9</td>
<td>10</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Polars also provides more advanced way to select columns using its <a href="https://docs.pola.rs/api/python/stable/reference/selectors.html">Selectors</a>.
Selectors allow for more intuitive selection of columns from DataFrame
objects based on their name, type, or other properties. They unify and
build on the related functionality that is available through the
<code>pl.col()</code> expression and can also broadcast expressions over
the selected columns.</p>
<p>Selectors are available as functions imported from
<code>polars.selectors</code>. Typical/recommended usage is to import
the module as <code>cs</code> and employ selectors from there.</p>
<div id="e9b50238" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> polars.selectors <span class="im">as</span> cs</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> polars <span class="im">as</span> pl</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>There are a number of selectors you can use within select:</p>
<ul>
<li><code>cs.starts_with("abc")</code>: matches column names that begin
with “abc”.</li>
<li><code>cs.ends_with("xyz")</code>: matches column names that end with
“xyz”.</li>
<li><code>cs.contains("ijk")</code>: matches column names that contain
“ijk”.</li>
<li><code>cs.matches(r"\d{3}")</code>: matches column names using regex,
columns with three digits repeating in the name in this case.</li>
<li><code>cs.temporal()</code>: matches columns with temporal (time)
data types.</li>
<li><code>cs.string()</code>: matches columns with string data
types.</li>
</ul>
<p>These are just a few, you can see all the selectors with examples in
the documentation, or by looking at the options after typing
<code>cs.</code> in your editor.</p>
<p>You can combine selectors with the following <code>set</code>
operations:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Operation</th>
<th>Expression</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>UNION</td>
<td>A | B</td>
</tr>
<tr class="even">
<td>INTERSECTION</td>
<td>A &amp; B</td>
</tr>
<tr class="odd">
<td>DIFFERENCE</td>
<td>A - B</td>
</tr>
<tr class="even">
<td>SYMMETRIC DIFFERENCE</td>
<td>A ^ B</td>
</tr>
<tr class="odd">
<td>COMPLEMENT</td>
<td>~A</td>
</tr>
</tbody>
</table>
<div id="65668abf" class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>flights.select(cs.temporal() <span class="op">|</span> cs.string())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="52">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (336_776, 5)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">carrier</th>
<th data-quarto-table-cell-role="th">tailnum</th>
<th data-quarto-table-cell-role="th">origin</th>
<th data-quarto-table-cell-role="th">dest</th>
<th data-quarto-table-cell-role="th">time_hour</th>
</tr>
<tr class="even">
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>datetime[μs]</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"UA"</td>
<td>"N14228"</td>
<td>"EWR"</td>
<td>"IAH"</td>
<td>2013-01-01 10:00:00</td>
</tr>
<tr class="even">
<td>"UA"</td>
<td>"N24211"</td>
<td>"LGA"</td>
<td>"IAH"</td>
<td>2013-01-01 10:00:00</td>
</tr>
<tr class="odd">
<td>"AA"</td>
<td>"N619AA"</td>
<td>"JFK"</td>
<td>"MIA"</td>
<td>2013-01-01 10:00:00</td>
</tr>
<tr class="even">
<td>"B6"</td>
<td>"N804JB"</td>
<td>"JFK"</td>
<td>"BQN"</td>
<td>2013-01-01 10:00:00</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="even">
<td>"9E"</td>
<td>null</td>
<td>"LGA"</td>
<td>"SYR"</td>
<td>2013-10-01 02:00:00</td>
</tr>
<tr class="odd">
<td>"MQ"</td>
<td>"N535MQ"</td>
<td>"LGA"</td>
<td>"BNA"</td>
<td>2013-09-30 16:00:00</td>
</tr>
<tr class="even">
<td>"MQ"</td>
<td>"N511MQ"</td>
<td>"LGA"</td>
<td>"CLE"</td>
<td>2013-09-30 15:00:00</td>
</tr>
<tr class="odd">
<td>"MQ"</td>
<td>"N839MQ"</td>
<td>"LGA"</td>
<td>"RDU"</td>
<td>2013-09-30 12:00:00</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Note that both individual selector results and selector set
operations will always return matching columns in the same order as the
underlying DataFrame schema.</p>
</section>
</section>
<section id="groups" class="level3" data-number="3.4">
<h3 data-number="3.4" class="anchored" data-anchor-id="groups"><span class="header-section-number">3.4</span>
Groups</h3>
<p>So far, we’ve learned about contexts (DataFrame methods) that work
with rows and columns. <code>Polars</code> gets even more powerful when
you add in the ability to work with groups. In this section, we’ll focus
on the most important contexts: <code>DataFrame.group_by()</code>,
<code>DataFrame.agg()</code>, and the various <em>slice</em>-ing
contexts.</p>
<section id="dataframe.group_by" class="level4" data-number="3.4.1">
<h4 data-number="3.4.1" class="anchored" data-anchor-id="dataframe.group_by"><span class="header-section-number">3.4.1</span>
<code>DataFrame.group_by()</code></h4>
<p>Use <a href="https://docs.pola.rs/api/python/stable/reference/dataframe/api/polars.DataFrame.group_by.html"><code>DataFrame.group_by()</code></a>
to divide your dataset into groups meaningful for your analysis:</p>
<div id="d50fac1a" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>flights.group_by(<span class="st">"month"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="53">
<pre><code>&lt;polars.dataframe.group_by.GroupBy at 0x29dc0cc6ff0&gt;</code></pre>
</div>
</div>
<p>As you can see, <code>DataFrame.group_by()</code> doesn’t change the
data, but returns a <a href="https://docs.pola.rs/api/python/stable/reference/dataframe/group_by.html"><code>GroupBy</code></a>
object. This acts like a <code>DataFrame</code>, but subsequent
operations will now work “by month”, and comes with some extra
methods.</p>
</section>
<section id="groupby.agg" class="level4" data-number="3.4.2">
<h4 data-number="3.4.2" class="anchored" data-anchor-id="groupby.agg"><span class="header-section-number">3.4.2</span>
<code>GroupBy.agg()</code></h4>
<p>The most important grouped operation is an aggregation, which, if
being used to calculate a single summary statistic, reduces the data
frame to have a single row for each group. In Polars, this operation is
performed by <a href="https://docs.pola.rs/api/python/stable/reference/dataframe/api/polars.dataframe.group_by.GroupBy.agg.html"><code>GroupBy.agg()</code></a>,
as shown by the following example, which computes the average departure
delay by month:</p>
<div id="38b3a152" class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>    flights</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>    .group_by(<span class="st">"month"</span>)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>    .agg(avg_delay <span class="op">=</span> pl.col(<span class="st">"dep_delay"</span>).mean())</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="54">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (12, 2)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">avg_delay</th>
</tr>
<tr class="even">
<th>i64</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>10.036665</td>
</tr>
<tr class="even">
<td>10</td>
<td>6.243988</td>
</tr>
<tr class="odd">
<td>12</td>
<td>16.576688</td>
</tr>
<tr class="even">
<td>6</td>
<td>20.846332</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
</tr>
<tr class="even">
<td>3</td>
<td>13.227076</td>
</tr>
<tr class="odd">
<td>11</td>
<td>5.435362</td>
</tr>
<tr class="even">
<td>5</td>
<td>12.986859</td>
</tr>
<tr class="odd">
<td>9</td>
<td>6.722476</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>There are two things to note:</p>
<ol type="1">
<li>Polars automatically drops the missing values in
<code>dep_delay</code> when calculating the mean.</li>
<li>Polars has a few different methods called <code>mean()</code>, but
they do different things depending on root object
(<code>DataFrame</code>, <code>GroupBy</code>, <code>Expr</code>,
etc.)</li>
</ol>
<p>You can create any number of aggregations in a single call to
<code>GroupBy.agg()</code>. You’ll learn various useful summaries in
later modules, but one very useful summary is <code>pl.len()</code>,
which returns the number of rows in each group:</p>
<div id="18fcc1fe" class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>    flights</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>    .group_by(<span class="st">"month"</span>)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>    .agg(</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>        avg_delay <span class="op">=</span> pl.col(<span class="st">"dep_delay"</span>).mean(),</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>        n <span class="op">=</span> pl.<span class="bu">len</span>()</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>    .sort(<span class="st">"month"</span>)</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="55">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (12, 3)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">avg_delay</th>
<th data-quarto-table-cell-role="th">n</th>
</tr>
<tr class="even">
<th>i64</th>
<th>f64</th>
<th>u32</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>10.036665</td>
<td>27004</td>
</tr>
<tr class="even">
<td>2</td>
<td>10.816843</td>
<td>24951</td>
</tr>
<tr class="odd">
<td>3</td>
<td>13.227076</td>
<td>28834</td>
</tr>
<tr class="even">
<td>4</td>
<td>13.938038</td>
<td>28330</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="even">
<td>9</td>
<td>6.722476</td>
<td>27574</td>
</tr>
<tr class="odd">
<td>10</td>
<td>6.243988</td>
<td>28889</td>
</tr>
<tr class="even">
<td>11</td>
<td>5.435362</td>
<td>27268</td>
</tr>
<tr class="odd">
<td>12</td>
<td>16.576688</td>
<td>28135</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Means and counts can get you a surprisingly long way in data
science!</p>
</section>
<section id="slicing-functions" class="level4" data-number="3.4.3">
<h4 data-number="3.4.3" class="anchored" data-anchor-id="slicing-functions"><span class="header-section-number">3.4.3</span>
Slicing functions</h4>
<p>There are a few ways Polars provides for you to extract specific rows
within each group:</p>
<ul>
<li><code>GroupBy.head(n = 1)</code> takes the first row from each
group. (Also works with <code>DataFrame</code>)</li>
<li><code>GroupBy.tail(n = 1)</code> takes the last row from each group.
(Also works with <code>DataFrame</code>)</li>
</ul>
<p><code>GroupBy</code> also provides some powerful aggregations for
whole groups, like:</p>
<div id="4b9976ba" class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>flights.group_by(<span class="st">"dest"</span>).<span class="bu">max</span>() <span class="co"># shows max value for each group and column</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>flights.group_by(<span class="st">"dest"</span>).<span class="bu">min</span>() <span class="co"># shows min value for each group and column</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="56">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (105, 19)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">dest</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">dep_time</th>
<th data-quarto-table-cell-role="th">sched_dep_time</th>
<th data-quarto-table-cell-role="th">dep_delay</th>
<th data-quarto-table-cell-role="th">arr_time</th>
<th data-quarto-table-cell-role="th">sched_arr_time</th>
<th data-quarto-table-cell-role="th">arr_delay</th>
<th data-quarto-table-cell-role="th">carrier</th>
<th data-quarto-table-cell-role="th">flight</th>
<th data-quarto-table-cell-role="th">tailnum</th>
<th data-quarto-table-cell-role="th">origin</th>
<th data-quarto-table-cell-role="th">air_time</th>
<th data-quarto-table-cell-role="th">distance</th>
<th data-quarto-table-cell-role="th">hour</th>
<th data-quarto-table-cell-role="th">minute</th>
<th data-quarto-table-cell-role="th">time_hour</th>
</tr>
<tr class="even">
<th>str</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>f64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>f64</th>
<th>str</th>
<th>i64</th>
<th>str</th>
<th>str</th>
<th>f64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>datetime[μs]</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"MVY"</td>
<td>2013</td>
<td>5</td>
<td>1</td>
<td>817.0</td>
<td>829</td>
<td>-18.0</td>
<td>914.0</td>
<td>946</td>
<td>-33.0</td>
<td>"9E"</td>
<td>1338</td>
<td>"N178JB"</td>
<td>"JFK"</td>
<td>30.0</td>
<td>173</td>
<td>8</td>
<td>10</td>
<td>2013-05-16 17:00:00</td>
</tr>
<tr class="even">
<td>"JAC"</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>802.0</td>
<td>800</td>
<td>-13.0</td>
<td>1111.0</td>
<td>1102</td>
<td>-17.0</td>
<td>"DL"</td>
<td>1162</td>
<td>"N13716"</td>
<td>"EWR"</td>
<td>248.0</td>
<td>1874</td>
<td>8</td>
<td>0</td>
<td>2013-01-01 13:00:00</td>
</tr>
<tr class="odd">
<td>"MCO"</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>2.0</td>
<td>550</td>
<td>-21.0</td>
<td>1.0</td>
<td>3</td>
<td>-63.0</td>
<td>"AA"</td>
<td>4</td>
<td>"D942DN"</td>
<td>"EWR"</td>
<td>107.0</td>
<td>937</td>
<td>5</td>
<td>0</td>
<td>2013-01-01 11:00:00</td>
</tr>
<tr class="even">
<td>"MHT"</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>6.0</td>
<td>647</td>
<td>-17.0</td>
<td>1.0</td>
<td>800</td>
<td>-37.0</td>
<td>"9E"</td>
<td>3255</td>
<td>"N10156"</td>
<td>"EWR"</td>
<td>31.0</td>
<td>195</td>
<td>6</td>
<td>0</td>
<td>2013-01-01 18:00:00</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="even">
<td>"BWI"</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>8.0</td>
<td>600</td>
<td>-18.0</td>
<td>5.0</td>
<td>30</td>
<td>-53.0</td>
<td>"9E"</td>
<td>63</td>
<td>"N10156"</td>
<td>"EWR"</td>
<td>31.0</td>
<td>169</td>
<td>6</td>
<td>0</td>
<td>2013-01-01 11:00:00</td>
</tr>
<tr class="odd">
<td>"BDL"</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>15.0</td>
<td>527</td>
<td>-15.0</td>
<td>3.0</td>
<td>628</td>
<td>-43.0</td>
<td>"EV"</td>
<td>471</td>
<td>"N10156"</td>
<td>"EWR"</td>
<td>20.0</td>
<td>116</td>
<td>5</td>
<td>0</td>
<td>2013-01-01 18:00:00</td>
</tr>
<tr class="even">
<td>"MDW"</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>1.0</td>
<td>600</td>
<td>-13.0</td>
<td>1.0</td>
<td>715</td>
<td>-49.0</td>
<td>"WN"</td>
<td>1</td>
<td>"N200WN"</td>
<td>"EWR"</td>
<td>92.0</td>
<td>711</td>
<td>6</td>
<td>0</td>
<td>2013-01-01 13:00:00</td>
</tr>
<tr class="odd">
<td>"ANC"</td>
<td>2013</td>
<td>7</td>
<td>3</td>
<td>1613.0</td>
<td>1615</td>
<td>-2.0</td>
<td>1906.0</td>
<td>1953</td>
<td>-47.0</td>
<td>"UA"</td>
<td>887</td>
<td>"N528UA"</td>
<td>"EWR"</td>
<td>388.0</td>
<td>3370</td>
<td>16</td>
<td>15</td>
<td>2013-07-06 20:00:00</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>If you want the top/bottom <code>k</code> number of rows (optionally
by group), use the <code>DataFrame.top_k</code> or
<code>DataFrame.bottom_k</code> contexts:</p>
<div id="fe3bcf79" class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>flights.top_k(k <span class="op">=</span> <span class="dv">4</span>, by <span class="op">=</span> <span class="st">"arr_delay"</span>)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>flights.bottom_k(k <span class="op">=</span> <span class="dv">4</span>, by <span class="op">=</span> <span class="st">"arr_delay"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="57">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (4, 19)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">dep_time</th>
<th data-quarto-table-cell-role="th">sched_dep_time</th>
<th data-quarto-table-cell-role="th">dep_delay</th>
<th data-quarto-table-cell-role="th">arr_time</th>
<th data-quarto-table-cell-role="th">sched_arr_time</th>
<th data-quarto-table-cell-role="th">arr_delay</th>
<th data-quarto-table-cell-role="th">carrier</th>
<th data-quarto-table-cell-role="th">flight</th>
<th data-quarto-table-cell-role="th">tailnum</th>
<th data-quarto-table-cell-role="th">origin</th>
<th data-quarto-table-cell-role="th">dest</th>
<th data-quarto-table-cell-role="th">air_time</th>
<th data-quarto-table-cell-role="th">distance</th>
<th data-quarto-table-cell-role="th">hour</th>
<th data-quarto-table-cell-role="th">minute</th>
<th data-quarto-table-cell-role="th">time_hour</th>
</tr>
<tr class="even">
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>f64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>f64</th>
<th>str</th>
<th>i64</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>f64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>datetime[μs]</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2013</td>
<td>5</td>
<td>7</td>
<td>1715.0</td>
<td>1729</td>
<td>-14.0</td>
<td>1944.0</td>
<td>2110</td>
<td>-86.0</td>
<td>"VX"</td>
<td>193</td>
<td>"N843VA"</td>
<td>"EWR"</td>
<td>"SFO"</td>
<td>315.0</td>
<td>2565</td>
<td>17</td>
<td>29</td>
<td>2013-05-07 21:00:00</td>
</tr>
<tr class="even">
<td>2013</td>
<td>5</td>
<td>20</td>
<td>719.0</td>
<td>735</td>
<td>-16.0</td>
<td>951.0</td>
<td>1110</td>
<td>-79.0</td>
<td>"VX"</td>
<td>11</td>
<td>"N840VA"</td>
<td>"JFK"</td>
<td>"SFO"</td>
<td>316.0</td>
<td>2586</td>
<td>7</td>
<td>35</td>
<td>2013-05-20 11:00:00</td>
</tr>
<tr class="odd">
<td>2013</td>
<td>5</td>
<td>2</td>
<td>1947.0</td>
<td>1949</td>
<td>-2.0</td>
<td>2209.0</td>
<td>2324</td>
<td>-75.0</td>
<td>"UA"</td>
<td>612</td>
<td>"N851UA"</td>
<td>"EWR"</td>
<td>"LAX"</td>
<td>300.0</td>
<td>2454</td>
<td>19</td>
<td>49</td>
<td>2013-05-02 23:00:00</td>
</tr>
<tr class="even">
<td>2013</td>
<td>5</td>
<td>6</td>
<td>1826.0</td>
<td>1830</td>
<td>-4.0</td>
<td>2045.0</td>
<td>2200</td>
<td>-75.0</td>
<td>"AA"</td>
<td>269</td>
<td>"N3KCAA"</td>
<td>"JFK"</td>
<td>"SEA"</td>
<td>289.0</td>
<td>2422</td>
<td>18</td>
<td>30</td>
<td>2013-05-06 22:00:00</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="grouping-by-multiple-variables" class="level4" data-number="3.4.4">
<h4 data-number="3.4.4" class="anchored" data-anchor-id="grouping-by-multiple-variables"><span class="header-section-number">3.4.4</span>
Grouping by multiple variables</h4>
<p>You can create groups using more than one variable. For example, we
could make a group for each date:</p>
<div id="759cfd6e" class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>daily <span class="op">=</span> (</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>    flights</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>    .group_by([<span class="st">"year"</span>, <span class="st">"month"</span>, <span class="st">"day"</span>])</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>daily.<span class="bu">max</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="58">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (365, 19)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">dep_time</th>
<th data-quarto-table-cell-role="th">sched_dep_time</th>
<th data-quarto-table-cell-role="th">dep_delay</th>
<th data-quarto-table-cell-role="th">arr_time</th>
<th data-quarto-table-cell-role="th">sched_arr_time</th>
<th data-quarto-table-cell-role="th">arr_delay</th>
<th data-quarto-table-cell-role="th">carrier</th>
<th data-quarto-table-cell-role="th">flight</th>
<th data-quarto-table-cell-role="th">tailnum</th>
<th data-quarto-table-cell-role="th">origin</th>
<th data-quarto-table-cell-role="th">dest</th>
<th data-quarto-table-cell-role="th">air_time</th>
<th data-quarto-table-cell-role="th">distance</th>
<th data-quarto-table-cell-role="th">hour</th>
<th data-quarto-table-cell-role="th">minute</th>
<th data-quarto-table-cell-role="th">time_hour</th>
</tr>
<tr class="even">
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>f64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>f64</th>
<th>str</th>
<th>i64</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>f64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>datetime[μs]</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2013</td>
<td>4</td>
<td>26</td>
<td>2358.0</td>
<td>2359</td>
<td>275.0</td>
<td>2358.0</td>
<td>2359</td>
<td>252.0</td>
<td>"YV"</td>
<td>5793</td>
<td>"N993DL"</td>
<td>"LGA"</td>
<td>"XNA"</td>
<td>614.0</td>
<td>4983</td>
<td>23</td>
<td>59</td>
<td>2013-04-27 03:00:00</td>
</tr>
<tr class="even">
<td>2013</td>
<td>5</td>
<td>18</td>
<td>2356.0</td>
<td>2359</td>
<td>369.0</td>
<td>2359.0</td>
<td>2358</td>
<td>362.0</td>
<td>"WN"</td>
<td>5769</td>
<td>"N9EAMQ"</td>
<td>"LGA"</td>
<td>"TPA"</td>
<td>618.0</td>
<td>4983</td>
<td>23</td>
<td>59</td>
<td>2013-05-19 03:00:00</td>
</tr>
<tr class="odd">
<td>2013</td>
<td>6</td>
<td>30</td>
<td>2359.0</td>
<td>2359</td>
<td>437.0</td>
<td>2400.0</td>
<td>2359</td>
<td>469.0</td>
<td>"YV"</td>
<td>6177</td>
<td>"N998AT"</td>
<td>"LGA"</td>
<td>"XNA"</td>
<td>601.0</td>
<td>4983</td>
<td>23</td>
<td>59</td>
<td>2013-07-01 03:00:00</td>
</tr>
<tr class="even">
<td>2013</td>
<td>9</td>
<td>13</td>
<td>2352.0</td>
<td>2359</td>
<td>245.0</td>
<td>2359.0</td>
<td>2359</td>
<td>236.0</td>
<td>"YV"</td>
<td>6177</td>
<td>"N9EAMQ"</td>
<td>"LGA"</td>
<td>"XNA"</td>
<td>605.0</td>
<td>4983</td>
<td>23</td>
<td>59</td>
<td>2013-09-14 03:00:00</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="even">
<td>2013</td>
<td>6</td>
<td>9</td>
<td>2356.0</td>
<td>2359</td>
<td>246.0</td>
<td>2359.0</td>
<td>2359</td>
<td>239.0</td>
<td>"YV"</td>
<td>6177</td>
<td>"N9EAMQ"</td>
<td>"LGA"</td>
<td>"XNA"</td>
<td>617.0</td>
<td>4983</td>
<td>23</td>
<td>59</td>
<td>2013-06-10 03:00:00</td>
</tr>
<tr class="odd">
<td>2013</td>
<td>10</td>
<td>14</td>
<td>2347.0</td>
<td>2359</td>
<td>702.0</td>
<td>2356.0</td>
<td>2359</td>
<td>688.0</td>
<td>"YV"</td>
<td>6181</td>
<td>"N994DL"</td>
<td>"LGA"</td>
<td>"XNA"</td>
<td>631.0</td>
<td>4983</td>
<td>23</td>
<td>59</td>
<td>2013-10-15 03:00:00</td>
</tr>
<tr class="even">
<td>2013</td>
<td>10</td>
<td>2</td>
<td>2341.0</td>
<td>2359</td>
<td>306.0</td>
<td>2400.0</td>
<td>2359</td>
<td>272.0</td>
<td>"YV"</td>
<td>6181</td>
<td>"N9EAMQ"</td>
<td>"LGA"</td>
<td>"XNA"</td>
<td>623.0</td>
<td>4983</td>
<td>23</td>
<td>59</td>
<td>2013-10-03 03:00:00</td>
</tr>
<tr class="odd">
<td>2013</td>
<td>1</td>
<td>23</td>
<td>2358.0</td>
<td>2359</td>
<td>478.0</td>
<td>2359.0</td>
<td>2359</td>
<td>486.0</td>
<td>"YV"</td>
<td>6055</td>
<td>"N989DL"</td>
<td>"LGA"</td>
<td>"XNA"</td>
<td>653.0</td>
<td>4983</td>
<td>23</td>
<td>59</td>
<td>2013-01-24 04:00:00</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p><code>GroupBy</code> methods return a <code>DataFrame</code>, so
there is no need to explicitly “un-group” your dataset.</p>
</section>
</section>
<section id="summary-1" class="level3" data-number="3.5">
<h3 data-number="3.5" class="anchored" data-anchor-id="summary-1"><span class="header-section-number">3.5</span>
Summary</h3>
<p>In this chapter, you’ve learned the tools that Polars provides for
working with data frames. The tools are roughly grouped into three
categories: those that manipulate the rows (like
<code>DataFrame.filter()</code> and <code>DataFrame.sort()</code>) those
that manipulate the columns (like <code>DataFrame.select()</code> and
<code>DataFrame.with_columns()</code>) and those that manipulate groups
(like <code>DataFrame.group_by()</code> and <code>GroupBy.agg()</code>).
In this chapter, we’ve focused on these “whole data frame” tools, but
you haven’t yet learned much about what you can do with the individual
variable. We’ll return to that in a later module in the course, where
each section provides tools for a specific type of variable.</p>
</section>
</section>
<section id="data-tidying" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="data-tidying"><span class="header-section-number">4</span> Data
tidying</h2>
<p>In this section, you will learn a consistent way to organize your
data in Python using a system called <strong>tidy data</strong>. Getting
your data into this format requires some work up front, but that work
pays off in the long term. Once you have tidy data, you will spend much
less time munging data from one representation to another, allowing you
to spend more time on the data questions you care about.</p>
<p>You’ll first learn the definition of tidy data and see it applied to
a simple toy dataset. Then we’ll dive into the primary tool you’ll use
for tidying data: pivoting. Pivoting allows you to change the form of
your data without changing any of the values.</p>
<div id="8cde5fd2" class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> polars <span class="im">as</span> pl</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> polars.selectors <span class="im">as</span> cs</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="tidy-data" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="tidy-data"><span class="header-section-number">4.1</span>
Tidy data</h3>
<p>You can represent the same underlying data in multiple ways. The
example below shows the same data organized in three different ways.
Each dataset shows the same values of four variables:
<code>country</code>, <code>year</code>, <code>population</code>, and
number of documented <code>cases</code> of TB (tuberculosis), but each
dataset organizes the values in a different way.</p>
<div id="3641e0b2" class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>table1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="61">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (6, 4)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">cases</th>
<th data-quarto-table-cell-role="th">population</th>
</tr>
<tr class="even">
<th>str</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"Afghanistan"</td>
<td>1999</td>
<td>745</td>
<td>19987071</td>
</tr>
<tr class="even">
<td>"Afghanistan"</td>
<td>2000</td>
<td>2666</td>
<td>20595360</td>
</tr>
<tr class="odd">
<td>"Brazil"</td>
<td>1999</td>
<td>37737</td>
<td>172006362</td>
</tr>
<tr class="even">
<td>"Brazil"</td>
<td>2000</td>
<td>80488</td>
<td>174504898</td>
</tr>
<tr class="odd">
<td>"China"</td>
<td>1999</td>
<td>212258</td>
<td>1272915272</td>
</tr>
<tr class="even">
<td>"China"</td>
<td>2000</td>
<td>213766</td>
<td>1280428583</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="257aa993" class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>table2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="62">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (12, 4)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">type</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
<tr class="even">
<th>str</th>
<th>i64</th>
<th>str</th>
<th>i64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"Afghanistan"</td>
<td>1999</td>
<td>"cases"</td>
<td>745</td>
</tr>
<tr class="even">
<td>"Afghanistan"</td>
<td>1999</td>
<td>"population"</td>
<td>19987071</td>
</tr>
<tr class="odd">
<td>"Afghanistan"</td>
<td>2000</td>
<td>"cases"</td>
<td>2666</td>
</tr>
<tr class="even">
<td>"Afghanistan"</td>
<td>2000</td>
<td>"population"</td>
<td>20595360</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="even">
<td>"China"</td>
<td>1999</td>
<td>"cases"</td>
<td>212258</td>
</tr>
<tr class="odd">
<td>"China"</td>
<td>1999</td>
<td>"population"</td>
<td>1272915272</td>
</tr>
<tr class="even">
<td>"China"</td>
<td>2000</td>
<td>"cases"</td>
<td>213766</td>
</tr>
<tr class="odd">
<td>"China"</td>
<td>2000</td>
<td>"population"</td>
<td>1280428583</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="3c6ee864" class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>table3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="63">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (6, 3)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">rate</th>
</tr>
<tr class="even">
<th>str</th>
<th>i64</th>
<th>str</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"Afghanistan"</td>
<td>1999</td>
<td>"745/19987071"</td>
</tr>
<tr class="even">
<td>"Afghanistan"</td>
<td>2000</td>
<td>"2666/20595360"</td>
</tr>
<tr class="odd">
<td>"Brazil"</td>
<td>1999</td>
<td>"37737/172006362"</td>
</tr>
<tr class="even">
<td>"Brazil"</td>
<td>2000</td>
<td>"80488/174504898"</td>
</tr>
<tr class="odd">
<td>"China"</td>
<td>1999</td>
<td>"212258/1272915272"</td>
</tr>
<tr class="even">
<td>"China"</td>
<td>2000</td>
<td>"213766/1280428583"</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>These are all representations of the same underlying data, but they
are not equally easy to use. One of them, <code>table1</code>, will be
much easier to work with Polars &amp; Plotly because it’s
<strong>tidy</strong>.</p>
<p>There are three interrelated rules that make a dataset tidy:</p>
<ol type="1">
<li>Each variable is a column; each column is a variable.</li>
<li>Each observation is a row; each row is an observation.</li>
<li>Each value is a cell; each cell is a single value.</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/tidy-1.png" class="img-fluid figure-img"></p>
<figcaption>The following three rules make a dataset tidy: variables are
columns, observations are rows, and values are cells.</figcaption>
</figure>
</div>
<p>Why ensure that your data is tidy? There are two main advantages:</p>
<ol type="1">
<li><p>There’s a general advantage to picking one consistent way of
storing data. If you have a consistent data structure, it’s easier to
learn the tools that work with it because they have an underlying
uniformity.</p></li>
<li><p>There’s a specific advantage to placing variables in columns
because it allows Polar’s vectorized nature to shine. Plotly also works
by default with tidy data formats, and requires (a little) workaround
for wide formats.</p></li>
</ol>
<p>Here are some examples of how Polars &amp; Plotly work with tidy
data:</p>
<div id="b2ff967b" class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute rate per 10,000</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>table1.with_columns(</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>    rate <span class="op">=</span> pl.col(<span class="st">"cases"</span>) <span class="op">/</span> pl.col(<span class="st">"population"</span>) <span class="op">*</span> <span class="dv">1000</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="64">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (6, 5)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">cases</th>
<th data-quarto-table-cell-role="th">population</th>
<th data-quarto-table-cell-role="th">rate</th>
</tr>
<tr class="even">
<th>str</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"Afghanistan"</td>
<td>1999</td>
<td>745</td>
<td>19987071</td>
<td>0.037274</td>
</tr>
<tr class="even">
<td>"Afghanistan"</td>
<td>2000</td>
<td>2666</td>
<td>20595360</td>
<td>0.129447</td>
</tr>
<tr class="odd">
<td>"Brazil"</td>
<td>1999</td>
<td>37737</td>
<td>172006362</td>
<td>0.219393</td>
</tr>
<tr class="even">
<td>"Brazil"</td>
<td>2000</td>
<td>80488</td>
<td>174504898</td>
<td>0.461236</td>
</tr>
<tr class="odd">
<td>"China"</td>
<td>1999</td>
<td>212258</td>
<td>1272915272</td>
<td>0.16675</td>
</tr>
<tr class="even">
<td>"China"</td>
<td>2000</td>
<td>213766</td>
<td>1280428583</td>
<td>0.166949</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="128746f8" class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute total cases per year</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>table1.group_by(<span class="st">"year"</span>).agg(total_cases <span class="op">=</span> pl.col(<span class="st">"cases"</span>).<span class="bu">sum</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="65">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (2, 2)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">total_cases</th>
</tr>
<tr class="even">
<th>i64</th>
<th>i64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1999</td>
<td>250740</td>
</tr>
<tr class="even">
<td>2000</td>
<td>296920</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="7ac2a7c5" class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize changes over time</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>table1_datefix <span class="op">=</span> table1.with_columns(</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>    date <span class="op">=</span> (pl.col(<span class="st">"year"</span>).cast(pl.String) <span class="op">+</span> <span class="st">"-01-01"</span>).<span class="bu">str</span>.to_date()</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>px.line(</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>    table1_datefix,</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">"date"</span>,</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">"cases"</span>,</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"country"</span>,</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>    symbol<span class="op">=</span><span class="st">"country"</span>,</span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">"Cases by Year and Country"</span>,</span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<iframe scrolling="no" width="100%" height="545px" src="iframe_figures/figure_66.html" frameborder="0" allowfullscreen=""></iframe>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>While we are covering the basics of tidy data, I highly recommend
reading <a href="https://vita.had.co.nz/papers/tidy-data.pdf">Tidy
Data</a> by Hadley Wickham. It’s a short paper on the principles of
working with tidy data and it’s benefits.</p>
</div>
</div>
</section>
<section id="lengthening-data" class="level3" data-number="4.2">
<h3 data-number="4.2" class="anchored" data-anchor-id="lengthening-data"><span class="header-section-number">4.2</span>
Lengthening data</h3>
<p>The principles of tidy data might seem so obvious that you wonder if
you’ll ever encounter a dataset that isn’t tidy. Unfortunately, however,
most real data is untidy. There are two main reasons:</p>
<ol type="1">
<li><p>Data is often organized to facilitate some goal other than
analysis. For example, it’s common for data to be structured to make
data entry, not analysis, easy.</p></li>
<li><p>Most people aren’t familiar with the principles of tidy data, and
it’s hard to derive them yourself unless you spend a lot of time working
with data.</p></li>
</ol>
<p>This means that most real analyses will require at least a little
tidying. You’ll begin by figuring out what the underlying variables and
observations are. Sometimes this is easy; other times you’ll need to
consult with the people who originally generated the data. Next, you’ll
<strong>pivot</strong> your data into a tidy form, with variables in the
columns and observations in the rows.</p>
<p>Polars provides two methods for pivoting data:
<code>DataFrame.pivot()</code> and <code>DataFrame.unpivot()</code>.
We’ll first start with <code>DataFrame.unpivot()</code> because it’s the
most common case. Let’s dive into some examples.</p>
<section id="data-in-column-names" class="level4" data-number="4.2.1">
<h4 data-number="4.2.1" class="anchored" data-anchor-id="data-in-column-names"><span class="header-section-number">4.2.1</span>
Data in column names</h4>
<p>The <code>billboard</code> dataset records the billboard rank of
songs in the year 2000:</p>
<div id="77bc487e" class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>billboard</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="68">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (317, 79)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">artist</th>
<th data-quarto-table-cell-role="th">track</th>
<th data-quarto-table-cell-role="th">date.entered</th>
<th data-quarto-table-cell-role="th">wk1</th>
<th data-quarto-table-cell-role="th">wk2</th>
<th data-quarto-table-cell-role="th">wk3</th>
<th data-quarto-table-cell-role="th">wk4</th>
<th data-quarto-table-cell-role="th">wk5</th>
<th data-quarto-table-cell-role="th">wk6</th>
<th data-quarto-table-cell-role="th">wk7</th>
<th data-quarto-table-cell-role="th">wk8</th>
<th data-quarto-table-cell-role="th">wk9</th>
<th data-quarto-table-cell-role="th">wk10</th>
<th data-quarto-table-cell-role="th">wk11</th>
<th data-quarto-table-cell-role="th">wk12</th>
<th data-quarto-table-cell-role="th">wk13</th>
<th data-quarto-table-cell-role="th">wk14</th>
<th data-quarto-table-cell-role="th">wk15</th>
<th data-quarto-table-cell-role="th">wk16</th>
<th data-quarto-table-cell-role="th">wk17</th>
<th data-quarto-table-cell-role="th">wk18</th>
<th data-quarto-table-cell-role="th">wk19</th>
<th data-quarto-table-cell-role="th">wk20</th>
<th data-quarto-table-cell-role="th">wk21</th>
<th data-quarto-table-cell-role="th">wk22</th>
<th data-quarto-table-cell-role="th">wk23</th>
<th data-quarto-table-cell-role="th">wk24</th>
<th data-quarto-table-cell-role="th">wk25</th>
<th data-quarto-table-cell-role="th">wk26</th>
<th data-quarto-table-cell-role="th">wk27</th>
<th data-quarto-table-cell-role="th">wk28</th>
<th data-quarto-table-cell-role="th">wk29</th>
<th data-quarto-table-cell-role="th">wk30</th>
<th data-quarto-table-cell-role="th">wk31</th>
<th data-quarto-table-cell-role="th">wk32</th>
<th data-quarto-table-cell-role="th">wk33</th>
<th data-quarto-table-cell-role="th">wk34</th>
<th data-quarto-table-cell-role="th">…</th>
<th data-quarto-table-cell-role="th">wk40</th>
<th data-quarto-table-cell-role="th">wk41</th>
<th data-quarto-table-cell-role="th">wk42</th>
<th data-quarto-table-cell-role="th">wk43</th>
<th data-quarto-table-cell-role="th">wk44</th>
<th data-quarto-table-cell-role="th">wk45</th>
<th data-quarto-table-cell-role="th">wk46</th>
<th data-quarto-table-cell-role="th">wk47</th>
<th data-quarto-table-cell-role="th">wk48</th>
<th data-quarto-table-cell-role="th">wk49</th>
<th data-quarto-table-cell-role="th">wk50</th>
<th data-quarto-table-cell-role="th">wk51</th>
<th data-quarto-table-cell-role="th">wk52</th>
<th data-quarto-table-cell-role="th">wk53</th>
<th data-quarto-table-cell-role="th">wk54</th>
<th data-quarto-table-cell-role="th">wk55</th>
<th data-quarto-table-cell-role="th">wk56</th>
<th data-quarto-table-cell-role="th">wk57</th>
<th data-quarto-table-cell-role="th">wk58</th>
<th data-quarto-table-cell-role="th">wk59</th>
<th data-quarto-table-cell-role="th">wk60</th>
<th data-quarto-table-cell-role="th">wk61</th>
<th data-quarto-table-cell-role="th">wk62</th>
<th data-quarto-table-cell-role="th">wk63</th>
<th data-quarto-table-cell-role="th">wk64</th>
<th data-quarto-table-cell-role="th">wk65</th>
<th data-quarto-table-cell-role="th">wk66</th>
<th data-quarto-table-cell-role="th">wk67</th>
<th data-quarto-table-cell-role="th">wk68</th>
<th data-quarto-table-cell-role="th">wk69</th>
<th data-quarto-table-cell-role="th">wk70</th>
<th data-quarto-table-cell-role="th">wk71</th>
<th data-quarto-table-cell-role="th">wk72</th>
<th data-quarto-table-cell-role="th">wk73</th>
<th data-quarto-table-cell-role="th">wk74</th>
<th data-quarto-table-cell-role="th">wk75</th>
<th data-quarto-table-cell-role="th">wk76</th>
</tr>
<tr class="even">
<th>str</th>
<th>str</th>
<th>date</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>…</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"2 Pac"</td>
<td>"Baby Don't Cry (Keep..."</td>
<td>2000-02-26</td>
<td>87</td>
<td>82</td>
<td>72</td>
<td>77</td>
<td>87</td>
<td>94</td>
<td>99</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>…</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
</tr>
<tr class="even">
<td>"2Ge+her"</td>
<td>"The Hardest Part Of ..."</td>
<td>2000-09-02</td>
<td>91</td>
<td>87</td>
<td>92</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>…</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
</tr>
<tr class="odd">
<td>"3 Doors Down"</td>
<td>"Kryptonite"</td>
<td>2000-04-08</td>
<td>81</td>
<td>70</td>
<td>68</td>
<td>67</td>
<td>66</td>
<td>57</td>
<td>54</td>
<td>53</td>
<td>51</td>
<td>51</td>
<td>51</td>
<td>51</td>
<td>47</td>
<td>44</td>
<td>38</td>
<td>28</td>
<td>22</td>
<td>18</td>
<td>18</td>
<td>14</td>
<td>12</td>
<td>7</td>
<td>6</td>
<td>6</td>
<td>6</td>
<td>5</td>
<td>5</td>
<td>4</td>
<td>4</td>
<td>4</td>
<td>4</td>
<td>3</td>
<td>3</td>
<td>3</td>
<td>…</td>
<td>15</td>
<td>14</td>
<td>13</td>
<td>14</td>
<td>16</td>
<td>17</td>
<td>21</td>
<td>22</td>
<td>24</td>
<td>28</td>
<td>33</td>
<td>42</td>
<td>42</td>
<td>49</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
</tr>
<tr class="even">
<td>"3 Doors Down"</td>
<td>"Loser"</td>
<td>2000-10-21</td>
<td>76</td>
<td>76</td>
<td>72</td>
<td>69</td>
<td>67</td>
<td>65</td>
<td>55</td>
<td>59</td>
<td>62</td>
<td>61</td>
<td>61</td>
<td>59</td>
<td>61</td>
<td>66</td>
<td>72</td>
<td>76</td>
<td>75</td>
<td>67</td>
<td>73</td>
<td>70</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>…</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="even">
<td>"Yearwood, Trisha"</td>
<td>"Real Live Woman"</td>
<td>2000-04-01</td>
<td>85</td>
<td>83</td>
<td>83</td>
<td>82</td>
<td>81</td>
<td>91</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>…</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
</tr>
<tr class="odd">
<td>"Ying Yang Twins"</td>
<td>"Whistle While You Tw..."</td>
<td>2000-03-18</td>
<td>95</td>
<td>94</td>
<td>91</td>
<td>85</td>
<td>84</td>
<td>78</td>
<td>74</td>
<td>78</td>
<td>85</td>
<td>89</td>
<td>97</td>
<td>96</td>
<td>99</td>
<td>99</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>…</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
</tr>
<tr class="even">
<td>"Zombie Nation"</td>
<td>"Kernkraft 400"</td>
<td>2000-09-02</td>
<td>99</td>
<td>99</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>…</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
</tr>
<tr class="odd">
<td>"matchbox twenty"</td>
<td>"Bent"</td>
<td>2000-04-29</td>
<td>60</td>
<td>37</td>
<td>29</td>
<td>24</td>
<td>22</td>
<td>21</td>
<td>18</td>
<td>16</td>
<td>13</td>
<td>12</td>
<td>8</td>
<td>6</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>2</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>4</td>
<td>4</td>
<td>6</td>
<td>9</td>
<td>12</td>
<td>13</td>
<td>19</td>
<td>20</td>
<td>20</td>
<td>24</td>
<td>29</td>
<td>28</td>
<td>27</td>
<td>30</td>
<td>…</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>In this dataset, each observation is a song. The first three columns
(<code>artist</code>, <code>track</code>, and <code>date.entered</code>)
are variables that describe the song. Then we have 76 columns,
<code>wk1</code>-<code>wk76</code>, that describe the rank of the song
in each week. Here, the column names are one variable (the
<code>week</code>) and the cell values are another (the
<code>rank</code>).</p>
<p>To tidy this data, we’ll use <code>DataFrame.unpivot()</code>:</p>
<div id="75f1ce4f" class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>billboard.unpivot(</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>    index<span class="op">=</span>[<span class="st">"artist"</span>, <span class="st">"track"</span>, <span class="st">"date.entered"</span>],</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>    variable_name<span class="op">=</span><span class="st">"week"</span>,</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>    value_name<span class="op">=</span><span class="st">"rank"</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="69">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (24_092, 5)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">artist</th>
<th data-quarto-table-cell-role="th">track</th>
<th data-quarto-table-cell-role="th">date.entered</th>
<th data-quarto-table-cell-role="th">week</th>
<th data-quarto-table-cell-role="th">rank</th>
</tr>
<tr class="even">
<th>str</th>
<th>str</th>
<th>date</th>
<th>str</th>
<th>str</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"2 Pac"</td>
<td>"Baby Don't Cry (Keep..."</td>
<td>2000-02-26</td>
<td>"wk1"</td>
<td>"87"</td>
</tr>
<tr class="even">
<td>"2Ge+her"</td>
<td>"The Hardest Part Of ..."</td>
<td>2000-09-02</td>
<td>"wk1"</td>
<td>"91"</td>
</tr>
<tr class="odd">
<td>"3 Doors Down"</td>
<td>"Kryptonite"</td>
<td>2000-04-08</td>
<td>"wk1"</td>
<td>"81"</td>
</tr>
<tr class="even">
<td>"3 Doors Down"</td>
<td>"Loser"</td>
<td>2000-10-21</td>
<td>"wk1"</td>
<td>"76"</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="even">
<td>"Yearwood, Trisha"</td>
<td>"Real Live Woman"</td>
<td>2000-04-01</td>
<td>"wk76"</td>
<td>null</td>
</tr>
<tr class="odd">
<td>"Ying Yang Twins"</td>
<td>"Whistle While You Tw..."</td>
<td>2000-03-18</td>
<td>"wk76"</td>
<td>null</td>
</tr>
<tr class="even">
<td>"Zombie Nation"</td>
<td>"Kernkraft 400"</td>
<td>2000-09-02</td>
<td>"wk76"</td>
<td>null</td>
</tr>
<tr class="odd">
<td>"matchbox twenty"</td>
<td>"Bent"</td>
<td>2000-04-29</td>
<td>"wk76"</td>
<td>null</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>There are three key arguments:</p>
<ul>
<li><code>index</code> specifies which columns <strong>are not</strong>
pivoted, i.e.&nbsp;which columns are variables.</li>
<li><code>variable_name</code> names the variable stored in the column
names, we named that variable <code>week</code>.</li>
<li><code>value_name</code> names the variable stored in the cell
values, we named that variable <code>rank</code>.</li>
</ul>
<p>Now let’s turn our attention to the resulting, longer data frame.
What happens if a song is in the top 100 for less than 76 weeks? Take 2
Pack’s “Baby Don’t Cry”, for example:</p>
<div id="7378108a" class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>billboard.unpivot(</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>    index<span class="op">=</span>[<span class="st">"artist"</span>, <span class="st">"track"</span>, <span class="st">"date.entered"</span>],</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>    variable_name<span class="op">=</span><span class="st">"week"</span>,</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>    value_name<span class="op">=</span><span class="st">"rank"</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>).<span class="bu">filter</span>(</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>    pl.col(<span class="st">"artist"</span>) <span class="op">==</span> <span class="st">"2 Pac"</span>, <span class="co"># using commas is another way to chain multiple ANDs</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>    pl.col(<span class="st">"track"</span>).<span class="bu">str</span>.starts_with(<span class="st">"Baby Don't Cry"</span>)</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="70">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (76, 5)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">artist</th>
<th data-quarto-table-cell-role="th">track</th>
<th data-quarto-table-cell-role="th">date.entered</th>
<th data-quarto-table-cell-role="th">week</th>
<th data-quarto-table-cell-role="th">rank</th>
</tr>
<tr class="even">
<th>str</th>
<th>str</th>
<th>date</th>
<th>str</th>
<th>str</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"2 Pac"</td>
<td>"Baby Don't Cry (Keep..."</td>
<td>2000-02-26</td>
<td>"wk1"</td>
<td>"87"</td>
</tr>
<tr class="even">
<td>"2 Pac"</td>
<td>"Baby Don't Cry (Keep..."</td>
<td>2000-02-26</td>
<td>"wk2"</td>
<td>"82"</td>
</tr>
<tr class="odd">
<td>"2 Pac"</td>
<td>"Baby Don't Cry (Keep..."</td>
<td>2000-02-26</td>
<td>"wk3"</td>
<td>"72"</td>
</tr>
<tr class="even">
<td>"2 Pac"</td>
<td>"Baby Don't Cry (Keep..."</td>
<td>2000-02-26</td>
<td>"wk4"</td>
<td>"77"</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="even">
<td>"2 Pac"</td>
<td>"Baby Don't Cry (Keep..."</td>
<td>2000-02-26</td>
<td>"wk73"</td>
<td>null</td>
</tr>
<tr class="odd">
<td>"2 Pac"</td>
<td>"Baby Don't Cry (Keep..."</td>
<td>2000-02-26</td>
<td>"wk74"</td>
<td>null</td>
</tr>
<tr class="even">
<td>"2 Pac"</td>
<td>"Baby Don't Cry (Keep..."</td>
<td>2000-02-26</td>
<td>"wk75"</td>
<td>null</td>
</tr>
<tr class="odd">
<td>"2 Pac"</td>
<td>"Baby Don't Cry (Keep..."</td>
<td>2000-02-26</td>
<td>"wk76"</td>
<td>null</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>The <code>null</code> in the bottom of the table suggests that this
song wasn’t ranked in (at least) weeks 74-76. These <code>null</code>s
don’t really represent unknown observations; they were forced to exist
by the structure of the dataset, so we can safely filter them out:</p>
<div id="85938010" class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>billboard.unpivot(</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>    index<span class="op">=</span>[<span class="st">"artist"</span>, <span class="st">"track"</span>, <span class="st">"date.entered"</span>],</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>    variable_name<span class="op">=</span><span class="st">"week"</span>,</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>    value_name<span class="op">=</span><span class="st">"rank"</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>).drop_nulls(</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># no arguments will drop any row with `null`</span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="71">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5_307, 5)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">artist</th>
<th data-quarto-table-cell-role="th">track</th>
<th data-quarto-table-cell-role="th">date.entered</th>
<th data-quarto-table-cell-role="th">week</th>
<th data-quarto-table-cell-role="th">rank</th>
</tr>
<tr class="even">
<th>str</th>
<th>str</th>
<th>date</th>
<th>str</th>
<th>str</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"2 Pac"</td>
<td>"Baby Don't Cry (Keep..."</td>
<td>2000-02-26</td>
<td>"wk1"</td>
<td>"87"</td>
</tr>
<tr class="even">
<td>"2Ge+her"</td>
<td>"The Hardest Part Of ..."</td>
<td>2000-09-02</td>
<td>"wk1"</td>
<td>"91"</td>
</tr>
<tr class="odd">
<td>"3 Doors Down"</td>
<td>"Kryptonite"</td>
<td>2000-04-08</td>
<td>"wk1"</td>
<td>"81"</td>
</tr>
<tr class="even">
<td>"3 Doors Down"</td>
<td>"Loser"</td>
<td>2000-10-21</td>
<td>"wk1"</td>
<td>"76"</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="even">
<td>"Lonestar"</td>
<td>"Amazed"</td>
<td>1999-06-05</td>
<td>"wk63"</td>
<td>"45"</td>
</tr>
<tr class="odd">
<td>"Creed"</td>
<td>"Higher"</td>
<td>1999-09-11</td>
<td>"wk64"</td>
<td>"50"</td>
</tr>
<tr class="even">
<td>"Lonestar"</td>
<td>"Amazed"</td>
<td>1999-06-05</td>
<td>"wk64"</td>
<td>"50"</td>
</tr>
<tr class="odd">
<td>"Creed"</td>
<td>"Higher"</td>
<td>1999-09-11</td>
<td>"wk65"</td>
<td>"49"</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>The number of rows is now much lower, indicating that many rows with
<code>null</code>s were dropped.</p>
<p>You might also wonder what happens if a song is in the top 100 for
more than 76 weeks? We can’t tell from this data, but you might guess
that additional columns <code>wk77</code>, <code>wk78</code>,
<code>...</code> would be added to the dataset.</p>
<p>This data is now tidy, but we could make future computation a bit
easier by converting values of <code>week</code> and <code>rank</code>
from character strings to numbers using
<code>DataFrame.with_columns()</code>.</p>
<div id="df6bd16e" class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>billboard_longer <span class="op">=</span> (</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>    billboard</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>    .unpivot(</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>        index<span class="op">=</span>[<span class="st">"artist"</span>, <span class="st">"track"</span>, <span class="st">"date.entered"</span>],</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>        variable_name<span class="op">=</span><span class="st">"week"</span>,</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>        value_name<span class="op">=</span><span class="st">"rank"</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>    ).drop_nulls(</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>    ).with_columns(</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>        pl.col(<span class="st">"week"</span>).<span class="bu">str</span>.extract(<span class="vs">r"(\d+)"</span>).<span class="bu">str</span>.to_integer(),</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>        pl.col(<span class="st">"rank"</span>).<span class="bu">str</span>.to_integer()</span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a>billboard_longer</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="72">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5_307, 5)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">artist</th>
<th data-quarto-table-cell-role="th">track</th>
<th data-quarto-table-cell-role="th">date.entered</th>
<th data-quarto-table-cell-role="th">week</th>
<th data-quarto-table-cell-role="th">rank</th>
</tr>
<tr class="even">
<th>str</th>
<th>str</th>
<th>date</th>
<th>i64</th>
<th>i64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"2 Pac"</td>
<td>"Baby Don't Cry (Keep..."</td>
<td>2000-02-26</td>
<td>1</td>
<td>87</td>
</tr>
<tr class="even">
<td>"2Ge+her"</td>
<td>"The Hardest Part Of ..."</td>
<td>2000-09-02</td>
<td>1</td>
<td>91</td>
</tr>
<tr class="odd">
<td>"3 Doors Down"</td>
<td>"Kryptonite"</td>
<td>2000-04-08</td>
<td>1</td>
<td>81</td>
</tr>
<tr class="even">
<td>"3 Doors Down"</td>
<td>"Loser"</td>
<td>2000-10-21</td>
<td>1</td>
<td>76</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="even">
<td>"Lonestar"</td>
<td>"Amazed"</td>
<td>1999-06-05</td>
<td>63</td>
<td>45</td>
</tr>
<tr class="odd">
<td>"Creed"</td>
<td>"Higher"</td>
<td>1999-09-11</td>
<td>64</td>
<td>50</td>
</tr>
<tr class="even">
<td>"Lonestar"</td>
<td>"Amazed"</td>
<td>1999-06-05</td>
<td>64</td>
<td>50</td>
</tr>
<tr class="odd">
<td>"Creed"</td>
<td>"Higher"</td>
<td>1999-09-11</td>
<td>65</td>
<td>49</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Now that we have all the week numbers in one variable and all the
rank values in another, we’re in a good position to visualize how song
ranks vary over time.</p>
<div id="4879a9f5" class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>px.line(</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>    billboard_longer, x<span class="op">=</span><span class="st">"week"</span>, y<span class="op">=</span><span class="st">"rank"</span>, line_group<span class="op">=</span><span class="st">"track"</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>).update_traces( <span class="co"># we'll learn more about these extra methods in a later module</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>    opacity<span class="op">=</span><span class="fl">0.25</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>).update_yaxes(</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>    autorange<span class="op">=</span><span class="st">"reversed"</span></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<iframe scrolling="no" width="100%" height="545px" src="iframe_figures/figure_73.html" frameborder="0" allowfullscreen=""></iframe>
</div>
</div>
<p>We can see that very few songs stay in the top 100 for more than 20
weeks.</p>
</section>
<section id="how-does-pivoting-work" class="level4" data-number="4.2.2">
<h4 data-number="4.2.2" class="anchored" data-anchor-id="how-does-pivoting-work"><span class="header-section-number">4.2.2</span>
How does pivoting work?</h4>
<p>Now that you’ve seen how we can use pivoting to reshape our data,
let’s take a little time to gain some intuition about what pivoting does
to the data. Let’s start with a very simple dataset to make it easier to
see what’s happening. Suppose we have three patients with
<code>id</code>s A, B, and C, and we take two blood pressure
measurements on each patient.</p>
<div id="114eaca9" class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pl.from_dict({</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"id"</span>:  [<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>],</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"bp1"</span>: [<span class="dv">100</span>, <span class="dv">140</span>, <span class="dv">120</span>],</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"bp2"</span>: [<span class="dv">120</span>, <span class="dv">114</span>, <span class="dv">125</span>] </span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="74">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (3, 3)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">bp1</th>
<th data-quarto-table-cell-role="th">bp2</th>
</tr>
<tr class="even">
<th>str</th>
<th>i64</th>
<th>i64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"A"</td>
<td>100</td>
<td>120</td>
</tr>
<tr class="even">
<td>"B"</td>
<td>140</td>
<td>114</td>
</tr>
<tr class="odd">
<td>"C"</td>
<td>120</td>
<td>125</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>We want our new dataset to have three variables: <code>id</code>
(already exists), <code>measurement</code> (the column names), and
<code>value</code> (the cell values). To achieve this, we need to pivot
<code>df</code> longer:</p>
<div id="985b42bd" class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>df.unpivot(</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>    index <span class="op">=</span> <span class="st">"id"</span>,</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>    variable_name<span class="op">=</span><span class="st">"measurement"</span>,</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>    value_name<span class="op">=</span><span class="st">"value"</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>).sort(</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"id"</span>, <span class="st">"measurement"</span>, <span class="st">"value"</span>]</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="75">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (6, 3)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">measurement</th>
<th data-quarto-table-cell-role="th">value</th>
</tr>
<tr class="even">
<th>str</th>
<th>str</th>
<th>i64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"A"</td>
<td>"bp1"</td>
<td>100</td>
</tr>
<tr class="even">
<td>"A"</td>
<td>"bp2"</td>
<td>120</td>
</tr>
<tr class="odd">
<td>"B"</td>
<td>"bp1"</td>
<td>140</td>
</tr>
<tr class="even">
<td>"B"</td>
<td>"bp2"</td>
<td>114</td>
</tr>
<tr class="odd">
<td>"C"</td>
<td>"bp1"</td>
<td>120</td>
</tr>
<tr class="even">
<td>"C"</td>
<td>"bp2"</td>
<td>125</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>How does the reshaping work? It’s easier to see if we think about it
column by column. As shown below, the values in a column that was
already a variable in the original dataset (<code>id</code>) need to be
repeated, once for each column that is pivoted.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/unpivot-variables.png" class="img-fluid figure-img"></p>
<figcaption>Columns that are already variables need to be repeated, once
for each column that is pivoted.</figcaption>
</figure>
</div>
<p>The column names become values in a new variable, whose name is
defined by <code>variable_name</code>, as shown below. THey need to be
repeated once for each row in the original dataset.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/unpivot-column-names.png" class="img-fluid figure-img"></p>
<figcaption>The column names of pivoted columns become values in a new
column. The values need to be repeated once for each row of the original
dataset.</figcaption>
</figure>
</div>
<p>The cell values also become values in a new variable, with a name
defined by <code>values_name</code>. They are unwound row by row, as
shown below.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/unpivot-cell-values.png" class="img-fluid figure-img"></p>
<figcaption>The number of values is preserved (not repeated), but
unwound row-by-row.</figcaption>
</figure>
</div>
</section>
<section id="more-variables-in-column-names" class="level4" data-number="4.2.3">
<h4 data-number="4.2.3" class="anchored" data-anchor-id="more-variables-in-column-names"><span class="header-section-number">4.2.3</span>
More variables in column names</h4>
<p>A more challenging situation occurs when you have multiple pieces of
information crammed into the column names, and you would like to store
these in separate new variables. For example, take the <code>who</code>
dataset, the source of <code>table1</code> and friends you saw
above:</p>
<div id="6a2d985f" class="cell" data-execution_count="77">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>who2.glimpse()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 7240
Columns: 58
$ country    &lt;str&gt; 'Afghanistan', 'Afghanistan', 'Afghanistan', 'Afghanistan', 'Afghanistan', 'Afghanistan', 'Afghanistan', 'Afghanistan', 'Afghanistan', 'Afghanistan'
$ year       &lt;i64&gt; 1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987, 1988, 1989
$ sp_m_014   &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
$ sp_m_1524  &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
$ sp_m_2534  &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
$ sp_m_3544  &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
$ sp_m_4554  &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
$ sp_m_5564  &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
$ sp_m_65    &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
$ sp_f_014   &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
$ sp_f_1524  &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
$ sp_f_2534  &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
$ sp_f_3544  &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
$ sp_f_4554  &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
$ sp_f_5564  &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
$ sp_f_65    &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
$ sn_m_014   &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
$ sn_m_1524  &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
$ sn_m_2534  &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
$ sn_m_3544  &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
$ sn_m_4554  &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
$ sn_m_5564  &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
$ sn_m_65    &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
$ sn_f_014   &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
$ sn_f_1524  &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
$ sn_f_2534  &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
$ sn_f_3544  &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
$ sn_f_4554  &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
$ sn_f_5564  &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
$ sn_f_65    &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
$ ep_m_014   &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
$ ep_m_1524  &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
$ ep_m_2534  &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
$ ep_m_3544  &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
$ ep_m_4554  &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
$ ep_m_5564  &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
$ ep_m_65    &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
$ ep_f_014   &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
$ ep_f_1524  &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
$ ep_f_2534  &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
$ ep_f_3544  &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
$ ep_f_4554  &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
$ ep_f_5564  &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
$ ep_f_65    &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
$ rel_m_014  &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
$ rel_m_1524 &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
$ rel_m_2534 &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
$ rel_m_3544 &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
$ rel_m_4554 &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
$ rel_m_5564 &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
$ rel_m_65   &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
$ rel_f_014  &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
$ rel_f_1524 &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
$ rel_f_2534 &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
$ rel_f_3544 &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
$ rel_f_4554 &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
$ rel_f_5564 &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
$ rel_f_65   &lt;i64&gt; None, None, None, None, None, None, None, None, None, None
</code></pre>
</div>
</div>
<p>This dataset, collected by the World Health Organization, records
information about tuberculosis diagnoses. There are two columns that are
already variables and are easy to interpret: <code>country</code> and
<code>year</code>. They are followed by 56 columns like
<code>sp_m_014</code>, <code>ep_m_4554</code>, and
<code>rel_m_3544</code>. If you stare at these columns for long enough,
you’ll notice there’s a pattern. Each column name is made up of three
pieces separated by <code>_</code>. The first piece,
<code>sp</code>/<code>rel</code>/<code>ep</code>, describes the method
used for the diagnosis, the second piece, <code>m</code>/<code>f</code>
is the gender (coded as a binary variable in this dataset), and the
third piece,
<code>014</code>/<code>1524</code>/<code>2534</code>/<code>3544</code>/<code>4554</code>/<code>5564</code>/<code>65</code>
is the age range (<code>014</code> represents 0-14, for example).</p>
<p>So in this case, we have six pieces of information recorded in
<code>who2</code>: the country and the year (already columns); the
method of diagnosis, the gender category, and the age range category
(contained in the other column names); and the count of patients in that
category (cell values).</p>
<p>To organize these six pieces of information in six separate columns,
first we use <code>DataFrame.unpivot()</code> like before, then we have
to do some data wrangling using <a href="https://docs.pola.rs/api/python/stable/reference/expressions/api/polars.Expr.list.get.html"><code>list</code>
expressions</a> to split the information from the column names into
separate columns:</p>
<ol type="1">
<li>Unpivot:</li>
</ol>
<div id="57e84b7a" class="cell" data-execution_count="78">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>step1 <span class="op">=</span> who2.unpivot(</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>    index<span class="op">=</span>[<span class="st">"country"</span>, <span class="st">"year"</span>],</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>    variable_name<span class="op">=</span><span class="st">"key"</span>,</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>    value_name<span class="op">=</span><span class="st">"count"</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>step1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="78">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (405_440, 4)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">key</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
<tr class="even">
<th>str</th>
<th>i64</th>
<th>str</th>
<th>i64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"Afghanistan"</td>
<td>1980</td>
<td>"sp_m_014"</td>
<td>null</td>
</tr>
<tr class="even">
<td>"Afghanistan"</td>
<td>1981</td>
<td>"sp_m_014"</td>
<td>null</td>
</tr>
<tr class="odd">
<td>"Afghanistan"</td>
<td>1982</td>
<td>"sp_m_014"</td>
<td>null</td>
</tr>
<tr class="even">
<td>"Afghanistan"</td>
<td>1983</td>
<td>"sp_m_014"</td>
<td>null</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="even">
<td>"Zimbabwe"</td>
<td>2010</td>
<td>"rel_f_65"</td>
<td>null</td>
</tr>
<tr class="odd">
<td>"Zimbabwe"</td>
<td>2011</td>
<td>"rel_f_65"</td>
<td>null</td>
</tr>
<tr class="even">
<td>"Zimbabwe"</td>
<td>2012</td>
<td>"rel_f_65"</td>
<td>null</td>
</tr>
<tr class="odd">
<td>"Zimbabwe"</td>
<td>2013</td>
<td>"rel_f_65"</td>
<td>725</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<ol start="2" type="1">
<li>Split the <code>key</code> column into <code>diagnosis</code>,
<code>gender</code>, and <code>age</code> columns:</li>
</ol>
<div id="378f0ee6" class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>step2 <span class="op">=</span> step1.with_columns(</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>    pl.col(<span class="st">"key"</span>).<span class="bu">str</span>.split(<span class="st">"_"</span>)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>step2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="79">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (405_440, 4)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">key</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
<tr class="even">
<th>str</th>
<th>i64</th>
<th>list[str]</th>
<th>i64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"Afghanistan"</td>
<td>1980</td>
<td>["sp", "m", "014"]</td>
<td>null</td>
</tr>
<tr class="even">
<td>"Afghanistan"</td>
<td>1981</td>
<td>["sp", "m", "014"]</td>
<td>null</td>
</tr>
<tr class="odd">
<td>"Afghanistan"</td>
<td>1982</td>
<td>["sp", "m", "014"]</td>
<td>null</td>
</tr>
<tr class="even">
<td>"Afghanistan"</td>
<td>1983</td>
<td>["sp", "m", "014"]</td>
<td>null</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="even">
<td>"Zimbabwe"</td>
<td>2010</td>
<td>["rel", "f", "65"]</td>
<td>null</td>
</tr>
<tr class="odd">
<td>"Zimbabwe"</td>
<td>2011</td>
<td>["rel", "f", "65"]</td>
<td>null</td>
</tr>
<tr class="even">
<td>"Zimbabwe"</td>
<td>2012</td>
<td>["rel", "f", "65"]</td>
<td>null</td>
</tr>
<tr class="odd">
<td>"Zimbabwe"</td>
<td>2013</td>
<td>["rel", "f", "65"]</td>
<td>725</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<ol start="3" type="1">
<li>Extract each list element into a new column:</li>
</ol>
<div id="d7b81efc" class="cell" data-execution_count="80">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>step3 <span class="op">=</span> step2.select(</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>    pl.col(<span class="st">"country"</span>),</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>    pl.col(<span class="st">"year"</span>),</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>    pl.col(<span class="st">"key"</span>).<span class="bu">list</span>.get(<span class="dv">0</span>).alias(<span class="st">"diagnosis"</span>), <span class="co"># Polars also uses 0-indexing</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>    pl.col(<span class="st">"key"</span>).<span class="bu">list</span>.get(<span class="dv">1</span>).alias(<span class="st">"gender"</span>),</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>    pl.col(<span class="st">"key"</span>).<span class="bu">list</span>.get(<span class="dv">2</span>).alias(<span class="st">"age"</span>),</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>    pl.col(<span class="st">"count"</span>)</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>step3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="80">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (405_440, 6)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">diagnosis</th>
<th data-quarto-table-cell-role="th">gender</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
<tr class="even">
<th>str</th>
<th>i64</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>i64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"Afghanistan"</td>
<td>1980</td>
<td>"sp"</td>
<td>"m"</td>
<td>"014"</td>
<td>null</td>
</tr>
<tr class="even">
<td>"Afghanistan"</td>
<td>1981</td>
<td>"sp"</td>
<td>"m"</td>
<td>"014"</td>
<td>null</td>
</tr>
<tr class="odd">
<td>"Afghanistan"</td>
<td>1982</td>
<td>"sp"</td>
<td>"m"</td>
<td>"014"</td>
<td>null</td>
</tr>
<tr class="even">
<td>"Afghanistan"</td>
<td>1983</td>
<td>"sp"</td>
<td>"m"</td>
<td>"014"</td>
<td>null</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="even">
<td>"Zimbabwe"</td>
<td>2010</td>
<td>"rel"</td>
<td>"f"</td>
<td>"65"</td>
<td>null</td>
</tr>
<tr class="odd">
<td>"Zimbabwe"</td>
<td>2011</td>
<td>"rel"</td>
<td>"f"</td>
<td>"65"</td>
<td>null</td>
</tr>
<tr class="even">
<td>"Zimbabwe"</td>
<td>2012</td>
<td>"rel"</td>
<td>"f"</td>
<td>"65"</td>
<td>null</td>
</tr>
<tr class="odd">
<td>"Zimbabwe"</td>
<td>2013</td>
<td>"rel"</td>
<td>"f"</td>
<td>"65"</td>
<td>725</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>All together:</p>
<div id="3e7c14e8" class="cell" data-execution_count="81">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>    who2.unpivot(</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>        index<span class="op">=</span>[<span class="st">"country"</span>, <span class="st">"year"</span>], variable_name<span class="op">=</span><span class="st">"key"</span>, value_name<span class="op">=</span><span class="st">"count"</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>    .with_columns(</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>        pl.col(<span class="st">"key"</span>).<span class="bu">str</span>.split(<span class="st">"_"</span>)</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>    .select(</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>        pl.col(<span class="st">"country"</span>),</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>        pl.col(<span class="st">"year"</span>),</span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>        pl.col(<span class="st">"key"</span>).<span class="bu">list</span>.get(<span class="dv">0</span>).alias(<span class="st">"diagnosis"</span>),</span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>        pl.col(<span class="st">"key"</span>).<span class="bu">list</span>.get(<span class="dv">1</span>).alias(<span class="st">"gender"</span>),</span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>        pl.col(<span class="st">"key"</span>).<span class="bu">list</span>.get(<span class="dv">2</span>).alias(<span class="st">"age"</span>),</span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a>        pl.col(<span class="st">"count"</span>)</span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>While the above steps break down the process to understand easier,
here is a more concise, albeit more advanced, way to achieve the same
results:</p>
<div id="4836ec63" class="cell" data-execution_count="82">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>    who2.unpivot(</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>        index<span class="op">=</span>[<span class="st">"country"</span>, <span class="st">"year"</span>], </span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>        variable_name<span class="op">=</span><span class="st">"key"</span>, </span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>        value_name<span class="op">=</span><span class="st">"count"</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>    .with_columns(</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>        pl.col(<span class="st">"key"</span>)</span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>        .<span class="bu">str</span>.split(<span class="st">"_"</span>)</span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>        .<span class="bu">list</span>.to_struct(fields<span class="op">=</span>[<span class="st">"diagnosis"</span>, <span class="st">"gender"</span>, <span class="st">"age"</span>])</span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a>    .unnest(<span class="st">"key"</span>)</span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="81">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (405_440, 6)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">diagnosis</th>
<th data-quarto-table-cell-role="th">gender</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
<tr class="even">
<th>str</th>
<th>i64</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>i64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"Afghanistan"</td>
<td>1980</td>
<td>"sp"</td>
<td>"m"</td>
<td>"014"</td>
<td>null</td>
</tr>
<tr class="even">
<td>"Afghanistan"</td>
<td>1981</td>
<td>"sp"</td>
<td>"m"</td>
<td>"014"</td>
<td>null</td>
</tr>
<tr class="odd">
<td>"Afghanistan"</td>
<td>1982</td>
<td>"sp"</td>
<td>"m"</td>
<td>"014"</td>
<td>null</td>
</tr>
<tr class="even">
<td>"Afghanistan"</td>
<td>1983</td>
<td>"sp"</td>
<td>"m"</td>
<td>"014"</td>
<td>null</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="even">
<td>"Zimbabwe"</td>
<td>2010</td>
<td>"rel"</td>
<td>"f"</td>
<td>"65"</td>
<td>null</td>
</tr>
<tr class="odd">
<td>"Zimbabwe"</td>
<td>2011</td>
<td>"rel"</td>
<td>"f"</td>
<td>"65"</td>
<td>null</td>
</tr>
<tr class="even">
<td>"Zimbabwe"</td>
<td>2012</td>
<td>"rel"</td>
<td>"f"</td>
<td>"65"</td>
<td>null</td>
</tr>
<tr class="odd">
<td>"Zimbabwe"</td>
<td>2013</td>
<td>"rel"</td>
<td>"f"</td>
<td>"65"</td>
<td>725</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Conceptually, this is only a minor variation on the simpler case
you’ve already seen. The figure below shows the basic idea: now, instead
of the column names pivoting into a single column, they pivot into
multiple columns.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/unpivot-multiple-names.png" class="img-fluid figure-img"></p>
<figcaption>Pivoting columns with multiple pieces of information in the
names means that each column name now fills in values in multiple output
columns.</figcaption>
</figure>
</div>
</section>
</section>
<section id="widening-data" class="level3" data-number="4.3">
<h3 data-number="4.3" class="anchored" data-anchor-id="widening-data"><span class="header-section-number">4.3</span>
Widening data</h3>
<p>So far we’ve used <code>DataFrame.unpivot()</code> to solve the
common class of problems where values have ended up in column names.
Next we’ll pivot (HA HA) to <code>DataFrame.pivot()</code>, which makes
datasets <strong>wider</strong> by increasing columns and reducing rows
and helps when one observation is spread across multiple rows. This
seems to arise less commonly in the wild, but it does seem to crop up a
lot when dealing with governmental data.</p>
<p>We’ll start by looking at <code>cms_patient_experience</code>, a
dataset from the Centers of Medicare and Medicaid services that collects
data about patient experiences:</p>
<div id="a2cca2cd" class="cell" data-execution_count="84">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>cms_patient_experience</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="83">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (500, 5)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">org_pac_id</th>
<th data-quarto-table-cell-role="th">org_nm</th>
<th data-quarto-table-cell-role="th">measure_cd</th>
<th data-quarto-table-cell-role="th">measure_title</th>
<th data-quarto-table-cell-role="th">prf_rate</th>
</tr>
<tr class="even">
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>i64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"0446157747"</td>
<td>"USC CARE MEDICAL GROUP INC"</td>
<td>"CAHPS_GRP_1"</td>
<td>"CAHPS for MIPS SSM: Getting Ti…</td>
<td>63</td>
</tr>
<tr class="even">
<td>"0446157747"</td>
<td>"USC CARE MEDICAL GROUP INC"</td>
<td>"CAHPS_GRP_2"</td>
<td>"CAHPS for MIPS SSM: How Well P…</td>
<td>87</td>
</tr>
<tr class="odd">
<td>"0446157747"</td>
<td>"USC CARE MEDICAL GROUP INC"</td>
<td>"CAHPS_GRP_3"</td>
<td>"CAHPS for MIPS SSM: Patient's …</td>
<td>86</td>
</tr>
<tr class="even">
<td>"0446157747"</td>
<td>"USC CARE MEDICAL GROUP INC"</td>
<td>"CAHPS_GRP_5"</td>
<td>"CAHPS for MIPS SSM: Health Pro…</td>
<td>57</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="even">
<td>"9931011434"</td>
<td>"PATIENT FIRST RICHMOND MEDICAL…</td>
<td>"CAHPS_GRP_2"</td>
<td>"CAHPS for MIPS SSM: How Well P…</td>
<td>null</td>
</tr>
<tr class="odd">
<td>"9931011434"</td>
<td>"PATIENT FIRST RICHMOND MEDICAL…</td>
<td>"CAHPS_GRP_3"</td>
<td>"CAHPS for MIPS SSM: Patient's …</td>
<td>null</td>
</tr>
<tr class="even">
<td>"9931011434"</td>
<td>"PATIENT FIRST RICHMOND MEDICAL…</td>
<td>"CAHPS_GRP_5"</td>
<td>"CAHPS for MIPS SSM: Health Pro…</td>
<td>45</td>
</tr>
<tr class="odd">
<td>"9931011434"</td>
<td>"PATIENT FIRST RICHMOND MEDICAL…</td>
<td>"CAHPS_GRP_12"</td>
<td>"CAHPS for MIPS SSM: Stewardshi…</td>
<td>19</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>The core unit being studied is an organization, but each organization
is spread across six rows, with one row for each measurement taken in
the survey organization. We can see the complete set of values for
<code>measure_cd</code> and <code>measure_title</code> by using
<code>DataFrame.unique().select()</code>:</p>
<div id="8da1ef07" class="cell" data-execution_count="85">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>cols <span class="op">=</span> [<span class="st">"measure_cd"</span>, <span class="st">"measure_title"</span>]</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>cms_patient_experience.unique(subset<span class="op">=</span>cols).select(cols).sort(cols)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="84">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (6, 2)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">measure_cd</th>
<th data-quarto-table-cell-role="th">measure_title</th>
</tr>
<tr class="even">
<th>str</th>
<th>str</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"CAHPS_GRP_1"</td>
<td>"CAHPS for MIPS SSM: Getting Ti…</td>
</tr>
<tr class="even">
<td>"CAHPS_GRP_12"</td>
<td>"CAHPS for MIPS SSM: Stewardshi…</td>
</tr>
<tr class="odd">
<td>"CAHPS_GRP_2"</td>
<td>"CAHPS for MIPS SSM: How Well P…</td>
</tr>
<tr class="even">
<td>"CAHPS_GRP_3"</td>
<td>"CAHPS for MIPS SSM: Patient's …</td>
</tr>
<tr class="odd">
<td>"CAHPS_GRP_5"</td>
<td>"CAHPS for MIPS SSM: Health Pro…</td>
</tr>
<tr class="even">
<td>"CAHPS_GRP_8"</td>
<td>"CAHPS for MIPS SSM: Courteous …</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Neither of these columns will make particularly great variable names:
<code>measure_cd</code> doesn’t hint at the meaning of the variable and
<code>measure_title</code> is a long sentence containing spaces. We’ll
use <code>measure_cd</code> as the source for our new column names for
now, but in a real analysis you might want to create your own variable
names that are both short and meaningful.</p>
<p><code>DataFrame.pivot()</code> has a similar, but different,
interface than <code>DataFrame.unpivot()</code>: you still select the
<code>index</code> columns (the columns that remain), but now you select
which column the <code>values</code> will come from, and which column
the names come from (<code>on</code>).</p>
<div id="777911bb" class="cell" data-execution_count="86">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>cms_patient_experience.pivot(</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>    index<span class="op">=</span>[<span class="st">"org_pac_id"</span>, <span class="st">"org_nm"</span>],</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>    on<span class="op">=</span>[<span class="st">"measure_cd"</span>], <span class="co"># Notice we don't use `measure_title`</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>    values<span class="op">=</span><span class="st">"prf_rate"</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="85">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (95, 8)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">org_pac_id</th>
<th data-quarto-table-cell-role="th">org_nm</th>
<th data-quarto-table-cell-role="th">CAHPS_GRP_1</th>
<th data-quarto-table-cell-role="th">CAHPS_GRP_2</th>
<th data-quarto-table-cell-role="th">CAHPS_GRP_3</th>
<th data-quarto-table-cell-role="th">CAHPS_GRP_5</th>
<th data-quarto-table-cell-role="th">CAHPS_GRP_8</th>
<th data-quarto-table-cell-role="th">CAHPS_GRP_12</th>
</tr>
<tr class="even">
<th>str</th>
<th>str</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"0446157747"</td>
<td>"USC CARE MEDICAL GROUP INC"</td>
<td>63</td>
<td>87</td>
<td>86</td>
<td>57</td>
<td>85</td>
<td>24</td>
</tr>
<tr class="even">
<td>"0446162697"</td>
<td>"ASSOCIATION OF UNIVERSITY PHYS…</td>
<td>59</td>
<td>85</td>
<td>83</td>
<td>63</td>
<td>88</td>
<td>22</td>
</tr>
<tr class="odd">
<td>"0547164295"</td>
<td>"BEAVER MEDICAL GROUP PC"</td>
<td>49</td>
<td>null</td>
<td>75</td>
<td>44</td>
<td>73</td>
<td>12</td>
</tr>
<tr class="even">
<td>"0749333730"</td>
<td>"CAPE PHYSICIANS ASSOCIATES PA"</td>
<td>67</td>
<td>84</td>
<td>85</td>
<td>65</td>
<td>82</td>
<td>24</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="even">
<td>"9830008770"</td>
<td>"WASHINGTON UNIVERSITY"</td>
<td>65</td>
<td>null</td>
<td>null</td>
<td>61</td>
<td>null</td>
<td>28</td>
</tr>
<tr class="odd">
<td>"9830093640"</td>
<td>"COOPERATIVE HEALTHCARE SERVICE…</td>
<td>65</td>
<td>87</td>
<td>78</td>
<td>52</td>
<td>null</td>
<td>25</td>
</tr>
<tr class="even">
<td>"9830094515"</td>
<td>"SUTTER VALLEY MEDICAL FOUNDATI…</td>
<td>60</td>
<td>null</td>
<td>88</td>
<td>55</td>
<td>null</td>
<td>24</td>
</tr>
<tr class="odd">
<td>"9931011434"</td>
<td>"PATIENT FIRST RICHMOND MEDICAL…</td>
<td>80</td>
<td>null</td>
<td>null</td>
<td>45</td>
<td>null</td>
<td>19</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<section id="how-does-dataframe.pivot-work" class="level4" data-number="4.3.1">
<h4 data-number="4.3.1" class="anchored" data-anchor-id="how-does-dataframe.pivot-work"><span class="header-section-number">4.3.1</span>
How does <code>DataFrame.pivot()</code> work?</h4>
<p>To understand how <code>DataFrame.pivot()</code> works, let’s again
start with a very simple dataset. This time we have two patients with
<code>id</code>s A and B, we have three blood pressure measurements on
patient A and two on patient B:</p>
<div id="af02ecd9" class="cell" data-execution_count="87">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pl.from_dict({</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"id"</span>: [<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"B"</span>, <span class="st">"A"</span>, <span class="st">"A"</span>],</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"measurement"</span>: [<span class="st">"bp1"</span>, <span class="st">"bp1"</span>, <span class="st">"bp2"</span>, <span class="st">"bp2"</span>, <span class="st">"bp3"</span>],</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"value"</span>: [<span class="dv">100</span>, <span class="dv">140</span>, <span class="dv">115</span>, <span class="dv">120</span>, <span class="dv">105</span>]</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We’ll take the values from the <code>value</code> column and the
names from the <code>measurement</code> column:</p>
<div id="12c101e2" class="cell" data-execution_count="88">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>df.pivot(on<span class="op">=</span><span class="st">"measurement"</span>, values<span class="op">=</span><span class="st">"value"</span>) <span class="co"># unused cols get put in `index`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="87">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (2, 4)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">bp1</th>
<th data-quarto-table-cell-role="th">bp2</th>
<th data-quarto-table-cell-role="th">bp3</th>
</tr>
<tr class="even">
<th>str</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"A"</td>
<td>100</td>
<td>120</td>
<td>105</td>
</tr>
<tr class="even">
<td>"B"</td>
<td>140</td>
<td>115</td>
<td>null</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>To begin the process, <code>DataFrame.pivot()</code> needs to first
figure out what will go in the rows and columns. The new column names
will be the unique values of <code>measurement</code>.</p>
<div id="440c5374" class="cell" data-execution_count="89">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>df.select(<span class="st">"measurement"</span>).unique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="88">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (3, 1)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">measurement</th>
</tr>
<tr class="even">
<th>str</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"bp1"</td>
</tr>
<tr class="even">
<td>"bp3"</td>
</tr>
<tr class="odd">
<td>"bp2"</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>By default, the rows in the output are determined by all the
variables that aren’t going into the new names or values. These are
called the <code>index</code> columns. Here there is only one column,
but in general there can be any number.</p>
<div id="947ecc4f" class="cell" data-execution_count="90">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>df.select(pl.exclude(<span class="st">"measurement"</span>, <span class="st">"value"</span>)).unique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="89">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (2, 1)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">id</th>
</tr>
<tr class="even">
<th>str</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"A"</td>
</tr>
<tr class="even">
<td>"B"</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p><code>DataFrame.pivot()</code> then combines these results to
generate an empty data frame:</p>
<div id="db281f7a" class="cell" data-execution_count="91">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>df.select(pl.exclude(<span class="st">"measurement"</span>, <span class="st">"value"</span>)).unique().with_columns(</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>pl.lit(<span class="va">None</span>), y<span class="op">=</span>pl.lit(<span class="va">None</span>), z<span class="op">=</span>pl.lit(<span class="va">None</span>)</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="90">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (2, 4)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">x</th>
<th data-quarto-table-cell-role="th">y</th>
<th data-quarto-table-cell-role="th">z</th>
</tr>
<tr class="even">
<th>str</th>
<th>null</th>
<th>null</th>
<th>null</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"A"</td>
<td>null</td>
<td>null</td>
<td>null</td>
</tr>
<tr class="even">
<td>"B"</td>
<td>null</td>
<td>null</td>
<td>null</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>It then fills in all the missing values using the data in the input.
In this case, not every cell in the output has a corresponding value in
the input as there’s no third blood pressure measurement for patient B,
so that cell remains missing.</p>
</section>
<section id="data-and-variable-names-in-the-column-headers" class="level4" data-number="4.3.2">
<h4 data-number="4.3.2" class="anchored" data-anchor-id="data-and-variable-names-in-the-column-headers"><span class="header-section-number">4.3.2</span>
Data and variable names in the column headers</h4>
<p>We will now see an example where we need to unpivot and pivot in the
same set of steps to tidy our data. This step up in complexity is when
the column names include a mix of variable values and variable names.
For example, take the <code>household</code> dataset:</p>
<div id="9df5f197" class="cell" data-execution_count="92">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>household <span class="op">=</span> pl.from_dict({</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"family"</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>],</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"dob_child1"</span>: [<span class="st">"1998-11-26"</span>, <span class="st">"1996-06-22"</span>, <span class="st">"2002-07-11"</span>, <span class="st">"2004-10-10"</span>, <span class="st">"2000-12-05"</span>],</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"dob_child2"</span>: [<span class="st">"2000-01-29"</span>, <span class="va">None</span>, <span class="st">"2004-04-05"</span>, <span class="st">"2009-08-27"</span>, <span class="st">"2005-02-28"</span>],</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"name_child1"</span>: [<span class="st">"Susan"</span>, <span class="st">"Mark"</span>, <span class="st">"Sam"</span>, <span class="st">"Craig"</span>, <span class="st">"Parker"</span>],</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"name_child2"</span>: [<span class="st">"Jose"</span>, <span class="va">None</span>, <span class="st">"Seth"</span>, <span class="st">"Khai"</span>, <span class="st">"Gracie"</span>]</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>}).with_columns(</span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>    cs.starts_with(<span class="st">"dob"</span>).<span class="bu">str</span>.to_date()</span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>household</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="91">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 5)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">family</th>
<th data-quarto-table-cell-role="th">dob_child1</th>
<th data-quarto-table-cell-role="th">dob_child2</th>
<th data-quarto-table-cell-role="th">name_child1</th>
<th data-quarto-table-cell-role="th">name_child2</th>
</tr>
<tr class="even">
<th>i64</th>
<th>date</th>
<th>date</th>
<th>str</th>
<th>str</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>1998-11-26</td>
<td>2000-01-29</td>
<td>"Susan"</td>
<td>"Jose"</td>
</tr>
<tr class="even">
<td>2</td>
<td>1996-06-22</td>
<td>null</td>
<td>"Mark"</td>
<td>null</td>
</tr>
<tr class="odd">
<td>3</td>
<td>2002-07-11</td>
<td>2004-04-05</td>
<td>"Sam"</td>
<td>"Seth"</td>
</tr>
<tr class="even">
<td>4</td>
<td>2004-10-10</td>
<td>2009-08-27</td>
<td>"Craig"</td>
<td>"Khai"</td>
</tr>
<tr class="odd">
<td>5</td>
<td>2000-12-05</td>
<td>2005-02-28</td>
<td>"Parker"</td>
<td>"Gracie"</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>This dataset contains data about five families, with the names and
dates of birth of up to two children. The new challenge in this dataset
is that the column names contain the names of two variables
(<code>dob</code>, <code>name</code>) and the values of another
(<code>child</code>, with values 1 or 2).</p>
<div id="478ad4c6" class="cell" data-execution_count="93">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># First, unpivot the data frame to create rows for each family-column combination</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>    household.unpivot(index<span class="op">=</span><span class="st">"family"</span>)</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the base column name (dob/name) and the child number</span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>    .with_columns(</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>        pl.col(<span class="st">"variable"</span>)</span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>        .<span class="bu">str</span>.split(<span class="st">"_"</span>)</span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>        .<span class="bu">list</span>.to_struct(fields<span class="op">=</span>[<span class="st">"base_col"</span>, <span class="st">"child"</span>])</span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>    .unnest(<span class="st">"variable"</span>)</span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Pivot the data to create separate columns for each base_col (dob, name)</span></span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a>    .pivot(index<span class="op">=</span>[<span class="st">"family"</span>, <span class="st">"child"</span>], on<span class="op">=</span><span class="st">"base_col"</span>, values<span class="op">=</span><span class="st">"value"</span>)</span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Filter out rows with null values</span></span>
<span id="cb95-17"><a href="#cb95-17" aria-hidden="true" tabindex="-1"></a>    .drop_nulls()</span>
<span id="cb95-18"><a href="#cb95-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-19"><a href="#cb95-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Clean up results</span></span>
<span id="cb95-20"><a href="#cb95-20" aria-hidden="true" tabindex="-1"></a>    .sort([<span class="st">"family"</span>, <span class="st">"child"</span>])</span>
<span id="cb95-21"><a href="#cb95-21" aria-hidden="true" tabindex="-1"></a>    .with_columns(pl.col(<span class="st">"dob"</span>).<span class="bu">str</span>.to_date())</span>
<span id="cb95-22"><a href="#cb95-22" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="92">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (9, 4)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">family</th>
<th data-quarto-table-cell-role="th">child</th>
<th data-quarto-table-cell-role="th">dob</th>
<th data-quarto-table-cell-role="th">name</th>
</tr>
<tr class="even">
<th>i64</th>
<th>str</th>
<th>date</th>
<th>str</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>"child1"</td>
<td>1998-11-26</td>
<td>"Susan"</td>
</tr>
<tr class="even">
<td>1</td>
<td>"child2"</td>
<td>2000-01-29</td>
<td>"Jose"</td>
</tr>
<tr class="odd">
<td>2</td>
<td>"child1"</td>
<td>1996-06-22</td>
<td>"Mark"</td>
</tr>
<tr class="even">
<td>3</td>
<td>"child1"</td>
<td>2002-07-11</td>
<td>"Sam"</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="even">
<td>4</td>
<td>"child1"</td>
<td>2004-10-10</td>
<td>"Craig"</td>
</tr>
<tr class="odd">
<td>4</td>
<td>"child2"</td>
<td>2009-08-27</td>
<td>"Khai"</td>
</tr>
<tr class="even">
<td>5</td>
<td>"child1"</td>
<td>2000-12-05</td>
<td>"Parker"</td>
</tr>
<tr class="odd">
<td>5</td>
<td>"child2"</td>
<td>2005-02-28</td>
<td>"Gracie"</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>We use <code>DataFrame.drop_nulls()</code> since the shape of the
input forces the creation of explicit missing variables (e.g., for
families that only have one child).</p>
</section>
</section>
<section id="summary-2" class="level3" data-number="4.4">
<h3 data-number="4.4" class="anchored" data-anchor-id="summary-2"><span class="header-section-number">4.4</span>
Summary</h3>
<p>In this section, you learned about tidy data: data that has variables
in columns and observations in rows. Tidy data makes working in the
Polars easier, because it’s a consistent structure understood by most
functions, the main challenge is transforming the data from whatever
structure you receive it in to a tidy format. To that end, you learned
about <code>DataFrame.unpivot()</code> and
<code>DataFrame.pivot()</code> which allow you to tidy up many untidy
datasets.</p>
<p>Another challenge is that, for a given dataset, it can be impossible
to label the longer or the wider version as the “tidy” one. This is
partly a reflection of our definition of tidy data, where we said tidy
data has one variable in each column, but we didn’t actually define what
a variable is (and it’s surprisingly hard to do so). It’s totally fine
to be pragmatic and to say a variable is whatever makes your analysis
easiest. So if you’re stuck figuring out how to do some computation,
consider switching up the organization of your data; don’t be afraid to
untidy, transform, and re-tidy as needed!</p>
</section>
</section>
<section id="data-import-export" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="data-import-export"><span class="header-section-number">5</span> Data
import &amp; export</h2>
<p>Working with data provided by Python packages is a great way to learn
data science tools, but at some point, you’ll want to apply what you’ve
learned to your own data. In this section, you’ll learn the basics of
reading data files into Python and how to export them for others (or
yourself in the future) to use.</p>
<p>Specifically, this chapter will focus on reading plain-text
rectangular files. We’ll start with practical advice for handling
features like column names, types, and missing data. You will then learn
about reading data from multiple files at once and writing data from
Python to a file. Finally, you’ll learn how to handcraft data frames in
Python, and export them with Polars functions.</p>
<div id="b61ba681" class="cell" data-execution_count="94">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> polars <span class="im">as</span> pl</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> io <span class="co"># we'll use this to "create" CSVs within Python examples</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="reading-data-from-a-file" class="level3" data-number="5.1">
<h3 data-number="5.1" class="anchored" data-anchor-id="reading-data-from-a-file"><span class="header-section-number">5.1</span>
Reading data from a file</h3>
<p>To begin, we’ll focus on the most common rectangular data file type:
CSV, which is short for comma-separated values. Here is what a simple
CSV file looks like. The first row, commonly called the header row,
gives the column names, and the following six rows provide the data. The
columns are separated, aka delimited, by commas.</p>
<pre><code>Student ID,Full Name,favourite.food,mealPlan,AGE
1,Sunil Huffmann,Strawberry yoghurt,Lunch only,4
2,Barclay Lynn,French fries,Lunch only,5
3,Jayendra Lyne,N/A,Breakfast and lunch,7
4,Leon Rossini,Anchovies,Lunch only,
5,Chidiegwu Dunkel,Pizza,Breakfast and lunch,five
6,Güvenç Attila,Ice cream,Lunch only,6</code></pre>
<p>The following table shows a representation of the same data as a
table:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 15%">
<col style="width: 24%">
<col style="width: 25%">
<col style="width: 26%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th>Student ID</th>
<th>Full Name</th>
<th>favourite.food</th>
<th>mealPlan</th>
<th>AGE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Sunil Huffmann</td>
<td>Strawberry yoghurt</td>
<td>Lunch only</td>
<td>4</td>
</tr>
<tr class="even">
<td>2</td>
<td>Barclay Lynn</td>
<td>French fries</td>
<td>Lunch only</td>
<td>5</td>
</tr>
<tr class="odd">
<td>3</td>
<td>Jayendra Lyne</td>
<td>N/A</td>
<td>Breakfast and lunch</td>
<td>7</td>
</tr>
<tr class="even">
<td>4</td>
<td>Leon Rossini</td>
<td>Anchovies</td>
<td>Lunch only</td>
<td>NULL</td>
</tr>
<tr class="odd">
<td>5</td>
<td>Chidiegwu Dunkel</td>
<td>Pizza</td>
<td>Breakfast and lunch</td>
<td>five</td>
</tr>
<tr class="even">
<td>6</td>
<td>Guvenc Attila</td>
<td>Ice cream</td>
<td>Lunch only</td>
<td>6</td>
</tr>
</tbody>
</table>
<p>We can read this file into Python using <code>pl.read_csv()</code>.
The first argument is the most important: the path to the file. You can
think about the path as the address of the file: the file is called
<code>students.csv</code> and it lives in the <code>data</code>
folder.</p>
<div id="bae8a868" class="cell" data-execution_count="95">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>students <span class="op">=</span> pl.read_csv(<span class="st">"data/students.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The code above will work if you have the students.csv file in a data
folder in your project. You can also read it directly from a URL:</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>students <span class="op">=</span> pl.read_csv(<span class="st">"https://raw.githubusercontent.com/hadley/r4ds/main/data/students.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>When you run <code>pl.read_csv()</code>, Polars will scan the file
and automatically infer column types based on the data it contains.
Polars doesn’t print a detailed message about column specifications by
default, but you can examine the schema to see the inferred types:</p>
<div id="a674e3ff" class="cell" data-execution_count="96">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>students.schema.to_frame()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="95">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (0, 5)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">Student ID</th>
<th data-quarto-table-cell-role="th">Full Name</th>
<th data-quarto-table-cell-role="th">favourite.food</th>
<th data-quarto-table-cell-role="th">mealPlan</th>
<th data-quarto-table-cell-role="th">AGE</th>
</tr>
<tr class="even">
<th>i64</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
</tr>
</thead>
<tbody>
</tbody>
</table>
</div>
</div>
</div>
<section id="practical-advice" class="level4" data-number="5.1.1">
<h4 data-number="5.1.1" class="anchored" data-anchor-id="practical-advice"><span class="header-section-number">5.1.1</span>
Practical advice</h4>
<p>Once you read data in, the first step usually involves transforming
it in some way to make it easier to work with in the rest of your
analysis. Let’s take another look at the students data with that in
mind.</p>
<div id="621acd3f" class="cell" data-execution_count="97">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>students</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="96">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (6, 5)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">Student ID</th>
<th data-quarto-table-cell-role="th">Full Name</th>
<th data-quarto-table-cell-role="th">favourite.food</th>
<th data-quarto-table-cell-role="th">mealPlan</th>
<th data-quarto-table-cell-role="th">AGE</th>
</tr>
<tr class="even">
<th>i64</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>"Sunil Huffmann"</td>
<td>"Strawberry yoghurt"</td>
<td>"Lunch only"</td>
<td>"4"</td>
</tr>
<tr class="even">
<td>2</td>
<td>"Barclay Lynn"</td>
<td>"French fries"</td>
<td>"Lunch only"</td>
<td>"5"</td>
</tr>
<tr class="odd">
<td>3</td>
<td>"Jayendra Lyne"</td>
<td>"N/A"</td>
<td>"Breakfast and lunch"</td>
<td>"7"</td>
</tr>
<tr class="even">
<td>4</td>
<td>"Leon Rossini"</td>
<td>"Anchovies"</td>
<td>"Lunch only"</td>
<td>null</td>
</tr>
<tr class="odd">
<td>5</td>
<td>"Chidiegwu Dunkel"</td>
<td>"Pizza"</td>
<td>"Breakfast and lunch"</td>
<td>"five"</td>
</tr>
<tr class="even">
<td>6</td>
<td>"Güvenç Attila"</td>
<td>"Ice cream"</td>
<td>"Lunch only"</td>
<td>"6"</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>In the <code>favourite.food</code> column, there’s an entry “N/A”
that should be interpreted as a real <code>None</code> that Python will
recognize as “not available”. This is something we can address using the
<code>null_values</code> argument. By default, Polars only recognizes
empty strings and the string “null” (case-insensitive) as missing
values.</p>
<div id="9ef786cb" class="cell" data-execution_count="98">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>students <span class="op">=</span> pl.read_csv(</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"data/students.csv"</span>, </span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>    null_values<span class="op">=</span>[<span class="st">"N/A"</span>, <span class="st">""</span>]</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>students</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="97">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (6, 5)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">Student ID</th>
<th data-quarto-table-cell-role="th">Full Name</th>
<th data-quarto-table-cell-role="th">favourite.food</th>
<th data-quarto-table-cell-role="th">mealPlan</th>
<th data-quarto-table-cell-role="th">AGE</th>
</tr>
<tr class="even">
<th>i64</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>"Sunil Huffmann"</td>
<td>"Strawberry yoghurt"</td>
<td>"Lunch only"</td>
<td>"4"</td>
</tr>
<tr class="even">
<td>2</td>
<td>"Barclay Lynn"</td>
<td>"French fries"</td>
<td>"Lunch only"</td>
<td>"5"</td>
</tr>
<tr class="odd">
<td>3</td>
<td>"Jayendra Lyne"</td>
<td>null</td>
<td>"Breakfast and lunch"</td>
<td>"7"</td>
</tr>
<tr class="even">
<td>4</td>
<td>"Leon Rossini"</td>
<td>"Anchovies"</td>
<td>"Lunch only"</td>
<td>null</td>
</tr>
<tr class="odd">
<td>5</td>
<td>"Chidiegwu Dunkel"</td>
<td>"Pizza"</td>
<td>"Breakfast and lunch"</td>
<td>"five"</td>
</tr>
<tr class="even">
<td>6</td>
<td>"Güvenç Attila"</td>
<td>"Ice cream"</td>
<td>"Lunch only"</td>
<td>"6"</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>You might also notice that <code>Student ID</code> and
<code>Full Name</code> columns contain spaces, which can make them
awkward to work with in code. In Polars, you can refer to these columns
using either bracket notation or with the <code>.</code> accessor, but
the latter won’t work with spaces or special characters:</p>
<div id="c0d6d5d2" class="cell" data-execution_count="99">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Works with spaces</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>first_student_name <span class="op">=</span> students[<span class="st">"Full Name"</span>][<span class="dv">0</span>]</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(first_student_name)</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Won't work with spaces</span></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>first_student_name <span class="op">=</span> students.Full Name[<span class="dv">0</span>]  <span class="co"># Syntax error!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-cyan-fg ansi-bold">  Cell </span><span class="ansi-green-fg ansi-bold">In[98], line 6</span>
<span class="ansi-yellow-fg ansi-bold">    first_student_name = students.Full Name[0]  # Syntax error!</span>
<span class="ansi-white-fg ansi-bold">                                       ^</span>
<span class="ansi-red-fg ansi-bold">SyntaxError</span><span class="ansi-red-fg ansi-bold">:</span> invalid syntax
</pre>
</div>
</div>
</div>
<p>It’s often a good idea to rename these columns to follow Python
naming conventions. Here’s how you can rename specific columns:</p>
<div id="ff1eedd6" class="cell" data-execution_count="100">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>students <span class="op">=</span> students.rename({</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Student ID"</span>: <span class="st">"student_id"</span>,</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Full Name"</span>: <span class="st">"full_name"</span></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>students</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="99">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (6, 5)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">student_id</th>
<th data-quarto-table-cell-role="th">full_name</th>
<th data-quarto-table-cell-role="th">favourite.food</th>
<th data-quarto-table-cell-role="th">mealPlan</th>
<th data-quarto-table-cell-role="th">AGE</th>
</tr>
<tr class="even">
<th>i64</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>"Sunil Huffmann"</td>
<td>"Strawberry yoghurt"</td>
<td>"Lunch only"</td>
<td>"4"</td>
</tr>
<tr class="even">
<td>2</td>
<td>"Barclay Lynn"</td>
<td>"French fries"</td>
<td>"Lunch only"</td>
<td>"5"</td>
</tr>
<tr class="odd">
<td>3</td>
<td>"Jayendra Lyne"</td>
<td>null</td>
<td>"Breakfast and lunch"</td>
<td>"7"</td>
</tr>
<tr class="even">
<td>4</td>
<td>"Leon Rossini"</td>
<td>"Anchovies"</td>
<td>"Lunch only"</td>
<td>null</td>
</tr>
<tr class="odd">
<td>5</td>
<td>"Chidiegwu Dunkel"</td>
<td>"Pizza"</td>
<td>"Breakfast and lunch"</td>
<td>"five"</td>
</tr>
<tr class="even">
<td>6</td>
<td>"Güvenç Attila"</td>
<td>"Ice cream"</td>
<td>"Lunch only"</td>
<td>"6"</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>An alternative approach is to use a function to clean all column
names at once. Polars doesn’t have a built-in function for this, but we
can use a special shortcut called a lambda function to do this in one
line. Think of a lambda function as a mini-function that you can write
directly where you need it, without having to define it separately. It’s
like giving Polars quick instructions on how to transform each column
name.</p>
<div id="d1585923" class="cell" data-execution_count="101">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>students <span class="op">=</span> (</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>    students.rename(</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>        <span class="kw">lambda</span> col_name: col_name.lower().replace(<span class="st">" "</span>, <span class="st">"_"</span>).replace(<span class="st">"."</span>, <span class="st">"_"</span>)</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>With this code, we are telling Polars to take each <strong>column
name</strong> (not the values of the columns), call it <code>col</code>,
and do these three things to it:</p>
<ol type="1">
<li>Convert it to lowercase</li>
<li>Replace any spaces with underscores</li>
<li>Replace any periods with underscores</li>
</ol>
<p>Note that these are the string methods we learned earlier in this
course, not functions that come from Polars. <code>col_name</code> has
the type <code>str</code>.</p>
<p>Like in <code>for</code> loops, it doesn’t matter what the looping
(or lambda) variable is called. I just called it <code>col_name</code>
because that <em>is</em> what we are effecting. I could’ve also called
it <code>x</code> and it would work the same:</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>students <span class="op">=</span> (</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>    students.rename(</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>        <span class="kw">lambda</span> x: x.lower().replace(<span class="st">" "</span>, <span class="st">"_"</span>).replace(<span class="st">"."</span>, <span class="st">"_"</span>)</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>If you wanted to use a regular function, you could do something like
this:</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> clean_col_name(col_name):</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> col_name.lower().replace(<span class="st">" "</span>, <span class="st">"_"</span>).replace(<span class="st">"."</span>, <span class="st">"_"</span>)</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>students <span class="op">=</span> students.rename(clean_column_name) </span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: no parentheses here, we're passing the function itself</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>When would you want to use a named/user-defined function over a
lambda function? It comes down to how many times you would repeat the
steps. If you are working with only one data frame, a lambda function
might be quicker to write, but if you are going to clean multiple data
frames in the same script, creating a named function to use over again
would be the better method.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>You can use this code snippet to help you with your labs and tests.
You don’t need to fully understand lambda functions for this course, but
you can think of this specific pattern as a helpful ‘recipe’ for
cleaning column names in one step while keeping your code clean and
readable. If you ever need to customize how column names are cleaned,
you can just adjust what happens inside the lambda function. The Polars
<a href="https://docs.pola.rs/api/python/stable/reference/dataframe/api/polars.DataFrame.rename.html">documentation</a>
for <code>DataFrame.rename()</code> has another example using lambda
functions to rename columns.</p>
</div>
</div>
<p>Another common task after reading in data is to consider variable
types. For example, <code>meal_plan</code> is a categorical variable
with a known set of possible values, which in Python should be
represented as a category:</p>
<div id="90bfdb6f" class="cell" data-execution_count="102">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>students <span class="op">=</span> students.with_columns(</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>    pl.col(<span class="st">"mealplan"</span>).cast(pl.Categorical)</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>students</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="101">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (6, 5)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">student_id</th>
<th data-quarto-table-cell-role="th">full_name</th>
<th data-quarto-table-cell-role="th">favourite_food</th>
<th data-quarto-table-cell-role="th">mealplan</th>
<th data-quarto-table-cell-role="th">age</th>
</tr>
<tr class="even">
<th>i64</th>
<th>str</th>
<th>str</th>
<th>cat</th>
<th>str</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>"Sunil Huffmann"</td>
<td>"Strawberry yoghurt"</td>
<td>"Lunch only"</td>
<td>"4"</td>
</tr>
<tr class="even">
<td>2</td>
<td>"Barclay Lynn"</td>
<td>"French fries"</td>
<td>"Lunch only"</td>
<td>"5"</td>
</tr>
<tr class="odd">
<td>3</td>
<td>"Jayendra Lyne"</td>
<td>null</td>
<td>"Breakfast and lunch"</td>
<td>"7"</td>
</tr>
<tr class="even">
<td>4</td>
<td>"Leon Rossini"</td>
<td>"Anchovies"</td>
<td>"Lunch only"</td>
<td>null</td>
</tr>
<tr class="odd">
<td>5</td>
<td>"Chidiegwu Dunkel"</td>
<td>"Pizza"</td>
<td>"Breakfast and lunch"</td>
<td>"five"</td>
</tr>
<tr class="even">
<td>6</td>
<td>"Güvenç Attila"</td>
<td>"Ice cream"</td>
<td>"Lunch only"</td>
<td>"6"</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Before you analyze this dataset, you’ll probably want to fix the age
column. Currently, <code>age</code> contains mixed types because one
observation is typed out as “five” instead of the number 5:</p>
<div id="d5ad2ba0" class="cell" data-execution_count="103">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>students <span class="op">=</span> students.with_columns(</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>    age<span class="op">=</span>pl.when(pl.col(<span class="st">"age"</span>) <span class="op">==</span> <span class="st">"five"</span>)</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>    .then(pl.lit(<span class="dv">5</span>))</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>    .otherwise(pl.col(<span class="st">"age"</span>).cast(pl.Int64, strict<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>) <span class="co"># This is conceptually very similar to Python's built in if-elif-else</span></span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>students</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="102">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (6, 5)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">student_id</th>
<th data-quarto-table-cell-role="th">full_name</th>
<th data-quarto-table-cell-role="th">favourite_food</th>
<th data-quarto-table-cell-role="th">mealplan</th>
<th data-quarto-table-cell-role="th">age</th>
</tr>
<tr class="even">
<th>i64</th>
<th>str</th>
<th>str</th>
<th>cat</th>
<th>i64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>"Sunil Huffmann"</td>
<td>"Strawberry yoghurt"</td>
<td>"Lunch only"</td>
<td>4</td>
</tr>
<tr class="even">
<td>2</td>
<td>"Barclay Lynn"</td>
<td>"French fries"</td>
<td>"Lunch only"</td>
<td>5</td>
</tr>
<tr class="odd">
<td>3</td>
<td>"Jayendra Lyne"</td>
<td>null</td>
<td>"Breakfast and lunch"</td>
<td>7</td>
</tr>
<tr class="even">
<td>4</td>
<td>"Leon Rossini"</td>
<td>"Anchovies"</td>
<td>"Lunch only"</td>
<td>null</td>
</tr>
<tr class="odd">
<td>5</td>
<td>"Chidiegwu Dunkel"</td>
<td>"Pizza"</td>
<td>"Breakfast and lunch"</td>
<td>5</td>
</tr>
<tr class="even">
<td>6</td>
<td>"Güvenç Attila"</td>
<td>"Ice cream"</td>
<td>"Lunch only"</td>
<td>6</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>The Polars code above uses a conditional expression with
<code>when()</code>, <code>then()</code>, and <code>otherwise()</code>
to handle the special case, then attempts to cast the column to a
floating-point number. The <code>strict=False</code> parameter tells
Polars to convert values that can be parsed as numbers and set the rest
to <code>None</code>.</p>
</section>
<section id="other-arguments" class="level4" data-number="5.1.2">
<h4 data-number="5.1.2" class="anchored" data-anchor-id="other-arguments"><span class="header-section-number">5.1.2</span>
Other arguments</h4>
<p>Usually, <code>pl.read_csv()</code> uses the first line of the data
for the column names, which is a very common convention. But it’s not
uncommon for a few lines of metadata to be included at the top of the
file. You can use <code>skip_rows</code> to skip the first n lines:</p>
<div id="1a621584" class="cell" data-execution_count="104">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>csv_data <span class="op">=</span> <span class="st">"""The first line of metadata</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="st">The second line of metadata</span></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="st">x,y,z </span></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a><span class="st">1,2,3"""</span></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>pl.read_csv(io.StringIO(csv_data), skip_rows<span class="op">=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="103">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (1, 3)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">x</th>
<th data-quarto-table-cell-role="th">y</th>
<th data-quarto-table-cell-role="th">z</th>
</tr>
<tr class="even">
<th>i64</th>
<th>i64</th>
<th>i64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>3</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>In other cases, the data might not have column names. You can use
<code>has_header=False</code> to tell Polars not to treat the first row
as headings:</p>
<div id="1d6e2969" class="cell" data-execution_count="105">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>csv_data <span class="op">=</span> <span class="st">"""1,2,3</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="st">4,5,6"""</span></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>pl.read_csv(io.StringIO(csv_data), has_header<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="104">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (2, 3)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">column_1</th>
<th data-quarto-table-cell-role="th">column_2</th>
<th data-quarto-table-cell-role="th">column_3</th>
</tr>
<tr class="even">
<th>i64</th>
<th>i64</th>
<th>i64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>3</td>
</tr>
<tr class="even">
<td>4</td>
<td>5</td>
<td>6</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>By default, Polars will name the columns “column_1”, “column_2”, etc.
You can provide your own column names with the <code>new_columns</code>
parameter:</p>
<div id="8cea7d74" class="cell" data-execution_count="106">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>csv_data <span class="op">=</span> <span class="st">"""1,2,3</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="st">4,5,6"""</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>pl.read_csv(</span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>    io.StringIO(csv_data), </span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>    has_header<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>    new_columns<span class="op">=</span>[<span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"z"</span>]</span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="105">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (2, 3)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">x</th>
<th data-quarto-table-cell-role="th">y</th>
<th data-quarto-table-cell-role="th">z</th>
</tr>
<tr class="even">
<th>i64</th>
<th>i64</th>
<th>i64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>3</td>
</tr>
<tr class="even">
<td>4</td>
<td>5</td>
<td>6</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>These arguments are all you need to know to read the majority of CSV
files that you’ll encounter in practice. (For the rest, you’ll need to
carefully inspect your .csv file and read the documentation for
<code>pl.read_csv()</code>’s many other arguments.)</p>
</section>
<section id="other-file-types" class="level4" data-number="5.1.3">
<h4 data-number="5.1.3" class="anchored" data-anchor-id="other-file-types"><span class="header-section-number">5.1.3</span>
Other file types</h4>
<p>Once you’ve mastered <code>read_csv()</code>, using Polars’ other
functions is straightforward; it’s just a matter of knowing which
function to reach for:</p>
<ul>
<li><code>read_csv()</code> reads comma-separated files.</li>
<li><code>read_csv()</code> can also read semicolon-separated files by
setting <code>separator=";"</code>.</li>
<li><code>read_csv()</code> can read tab-delimited files by setting
<code>separator="\t"</code>, or you can use the alias
<code>read_tsv()</code>.</li>
<li><code>read_csv()</code> can read files with any delimiter by setting
the <code>separator</code> parameter.</li>
<li><code>read_ndjson()</code> reads newline-delimited JSON files.</li>
<li><code>read_parquet()</code> reads Apache Parquet files, a columnar
storage format that is typically faster and more space-efficient than
CSV.</li>
<li><code>read_ipc()</code> or <code>read_arrow()</code> reads Arrow IPC
files, which provide high-performance interoperability between different
systems.</li>
<li><code>read_excel()</code> reads Excel files (learn more about the
different Excel features <a href="https://docs.pola.rs/user-guide/io/excel/">here</a>).</li>
<li><code>read_avro()</code> reads Avro files.</li>
</ul>
</section>
</section>
<section id="controlling-column-types" class="level3" data-number="5.2">
<h3 data-number="5.2" class="anchored" data-anchor-id="controlling-column-types"><span class="header-section-number">5.2</span>
Controlling column types</h3>
<p>A CSV file doesn’t contain any information about the type of each
variable (i.e., whether it’s a boolean, number, string, etc.), so Polars
will try to guess the type. This section describes how the guessing
process works, how to resolve some common problems that cause it to
fail, and how to supply the column types yourself.</p>
<section id="guessing-types" class="level4" data-number="5.2.1">
<h4 data-number="5.2.1" class="anchored" data-anchor-id="guessing-types"><span class="header-section-number">5.2.1</span>
Guessing types</h4>
<p>Polars uses a heuristic to figure out the column types. By default,
it samples a certain number of rows from the file and tries to infer the
type based on the values it sees. You can control this with the
<code>infer_schema_length</code> parameter.</p>
<p>The type inference generally follows these rules: - If values are
“true” or “false” (case-insensitive), it’s a boolean. - If values are
all integers, it’s an integer type. - If values have decimals but are
all numeric, it’s a floating-point type. - If values match a date or
datetime pattern, it’s a date or datetime type. - Otherwise, it’s a
string type.</p>
<p>You can see that behavior with a simple example:</p>
<div id="2d82e6db" class="cell" data-execution_count="107">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>csv_data <span class="op">=</span> <span class="st">"""logical,numeric,date,string</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="st">TRUE,1,2021-01-15,abc</span></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a><span class="st">false,4.5,2021-02-15,def</span></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a><span class="st">T,Inf,2021-02-16,ghi"""</span></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>pl.read_csv(io.StringIO(csv_data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="106">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (3, 4)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">logical</th>
<th data-quarto-table-cell-role="th">numeric</th>
<th data-quarto-table-cell-role="th">date</th>
<th data-quarto-table-cell-role="th">string</th>
</tr>
<tr class="even">
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"TRUE"</td>
<td>"1"</td>
<td>"2021-01-15"</td>
<td>"abc"</td>
</tr>
<tr class="even">
<td>"false"</td>
<td>"4.5"</td>
<td>"2021-02-15"</td>
<td>"def"</td>
</tr>
<tr class="odd">
<td>"T"</td>
<td>"Inf"</td>
<td>"2021-02-16"</td>
<td>"ghi"</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>This heuristic works well if you have a clean dataset, but in real
life, you’ll encounter a variety of challenges that require special
handling.</p>
</section>
<section id="missing-values-column-types-and-problems" class="level4" data-number="5.2.2">
<h4 data-number="5.2.2" class="anchored" data-anchor-id="missing-values-column-types-and-problems"><span class="header-section-number">5.2.2</span>
Missing values, column types, and problems</h4>
<p>The most common way column detection fails is that a column contains
unexpected values, and you get a string column instead of a more
specific type. One of the most common causes is a missing value recorded
using something other than the <code>None</code> that Polars
expects.</p>
<p>Take this simple 1-column CSV file as an example:</p>
<div id="34b0216f" class="cell" data-execution_count="108">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>simple_csv <span class="op">=</span> <span class="st">"""x</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="st">10</span></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="st">.</span></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a><span class="st">20</span></span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a><span class="st">30"""</span></span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Read without specifying null values</span></span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>pl.read_csv(io.StringIO(simple_csv))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="107">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (4, 1)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">x</th>
</tr>
<tr class="even">
<th>str</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"10"</td>
</tr>
<tr class="even">
<td>"."</td>
</tr>
<tr class="odd">
<td>"20"</td>
</tr>
<tr class="even">
<td>"30"</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>If we read it without any additional arguments, <code>x</code>
becomes a string column. In this very small example, you can easily see
the missing value <code>.</code>. But what if you have thousands of rows
with only a few missing values represented by <code>.</code>s scattered
throughout?</p>
<p>In Polars, you can specify the column type and tell it what values
should be treated as null:</p>
<div id="bdd1020a" class="cell" data-execution_count="109">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>pl.read_csv(</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>    io.StringIO(simple_csv),</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>    schema_overrides<span class="op">=</span>{<span class="st">"x"</span>: pl.Int64},</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>    null_values<span class="op">=</span>[<span class="st">"."</span>],</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="108">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (4, 1)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">x</th>
</tr>
<tr class="even">
<th>i64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>10</td>
</tr>
<tr class="even">
<td>null</td>
</tr>
<tr class="odd">
<td>20</td>
</tr>
<tr class="even">
<td>30</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="column-types" class="level4" data-number="5.2.3">
<h4 data-number="5.2.3" class="anchored" data-anchor-id="column-types"><span class="header-section-number">5.2.3</span>
Column types</h4>
<p>Polars provides many data types that you can specify:</p>
<ul>
<li><code>pl.Boolean</code>: For logical values (True/False)</li>
<li><code>pl.Int8</code>, <code>pl.Int16</code>, <code>pl.Int32</code>,
<code>pl.Int64</code>: For integers of different sizes</li>
<li><code>pl.UInt8</code>, <code>pl.UInt16</code>,
<code>pl.UInt32</code>, <code>pl.UInt64</code>: For unsigned integers
(positive only)</li>
<li><code>pl.Float32</code>, <code>pl.Float64</code>: For floating-point
numbers</li>
<li><code>pl.Decimal</code>: For precise decimal arithmetic</li>
<li><code>pl.Utf8</code>: For string data</li>
<li><code>pl.Categorical</code>: For categorical (factor) data</li>
<li><code>pl.Date</code>, <code>pl.Time</code>,
<code>pl.Datetime</code>: For date and time data</li>
<li><code>pl.Object</code>: For Python objects that don’t fit the other
types</li>
<li><code>pl.Binary</code>: For binary data</li>
<li><code>pl.Struct</code>: For nested data structures</li>
</ul>
<p>You can specify column types in two ways:</p>
<ol type="1">
<li>Using the <code>schema</code> or <code>schema_overrides</code>
parameter when reading data</li>
<li>Using <code>cast()</code> to convert columns after reading</li>
</ol>
<div id="78212620" class="cell" data-execution_count="110">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify types when reading</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>csv_data <span class="op">=</span> <span class="st">"""x,y,z</span></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="st">1,2,3"""</span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pl.read_csv(</span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>    io.StringIO(csv_data),</span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a>    schema_overrides<span class="op">=</span>{</span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">"x"</span>: pl.Int32,</span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">"y"</span>: pl.Float64,</span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">"z"</span>: pl.Utf8</span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb116-12"><a href="#cb116-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb116-13"><a href="#cb116-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.schema)</span>
<span id="cb116-14"><a href="#cb116-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-15"><a href="#cb116-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Or convert after reading</span></span>
<span id="cb116-16"><a href="#cb116-16" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pl.read_csv(io.StringIO(csv_data))</span>
<span id="cb116-17"><a href="#cb116-17" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.with_columns([</span>
<span id="cb116-18"><a href="#cb116-18" aria-hidden="true" tabindex="-1"></a>    pl.col(<span class="st">"x"</span>).cast(pl.Int32),</span>
<span id="cb116-19"><a href="#cb116-19" aria-hidden="true" tabindex="-1"></a>    pl.col(<span class="st">"y"</span>).cast(pl.Float64),</span>
<span id="cb116-20"><a href="#cb116-20" aria-hidden="true" tabindex="-1"></a>    pl.col(<span class="st">"z"</span>).cast(pl.Utf8)</span>
<span id="cb116-21"><a href="#cb116-21" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb116-22"><a href="#cb116-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.schema)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Schema({'x': Int32, 'y': Float64, 'z': String})
Schema({'x': Int32, 'y': Float64, 'z': String})</code></pre>
</div>
</div>
<p>You can also specify a schema for all columns at once:</p>
<div id="492de9eb" class="cell" data-execution_count="111">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>schema <span class="op">=</span> {<span class="st">"x"</span>: pl.Int32, <span class="st">"y"</span>: pl.Float64, <span class="st">"z"</span>: pl.Utf8}</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pl.read_csv(io.StringIO(csv_data), schema<span class="op">=</span>schema)</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.schema)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Schema({'x': Int32, 'y': Float64, 'z': String})</code></pre>
</div>
</div>
<p>If you want to select only specific columns when reading a file, you
can use the <code>columns</code> parameter:</p>
<div id="9053b65b" class="cell" data-execution_count="112">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pl.read_csv(io.StringIO(csv_data), columns<span class="op">=</span>[<span class="st">"x"</span>])</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (1, 1)
┌─────┐
│ x   │
│ --- │
│ i64 │
╞═════╡
│ 1   │
└─────┘</code></pre>
</div>
</div>
</section>
</section>
<section id="reading-data-from-multiple-files" class="level3" data-number="5.3">
<h3 data-number="5.3" class="anchored" data-anchor-id="reading-data-from-multiple-files"><span class="header-section-number">5.3</span>
Reading data from multiple files</h3>
<p>Sometimes your data is split across multiple files instead of being
contained in a single file. For example, you might have sales data for
multiple months, with each month’s data in a separate file:
<code>01-sales.csv</code> for January, <code>02-sales.csv</code> for
February, and <code>03-sales.csv</code> for March.</p>
<p>With Polars, you can read these files one by one and then concatenate
them:</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co"># List of sales files</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>sales_files <span class="op">=</span> [</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"data/01-sales.csv"</span>,</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"data/02-sales.csv"</span>,</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"data/03-sales.csv"</span></span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Read and concatenate via list comprehension</span></span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a>dfs <span class="op">=</span> [pl.read_csv(<span class="bu">file</span>).with_columns(pl.lit(os.path.basename(<span class="bu">file</span>)).alias(<span class="st">"file"</span>)) </span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a>       <span class="cf">for</span> <span class="bu">file</span> <span class="kw">in</span> sales_files]</span>
<span id="cb122-11"><a href="#cb122-11" aria-hidden="true" tabindex="-1"></a>sales <span class="op">=</span> pl.concat(dfs)</span>
<span id="cb122-12"><a href="#cb122-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sales)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>This method uses something called List Comprehension, which you can
learn more about <a href="https://www.w3schools.com/python/python_lists_comprehension.asp">here</a>.</p>
</div>
</div>
<p>You can download these files from the URLs mentioned in the original
chapter, or read them directly:</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>sales_files <span class="op">=</span> [</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"https://pos.it/r4ds-01-sales"</span>,</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"https://pos.it/r4ds-02-sales"</span>,</span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"https://pos.it/r4ds-03-sales"</span></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>dfs <span class="op">=</span> [pl.read_csv(<span class="bu">file</span>).with_columns(pl.lit(<span class="bu">file</span>).alias(<span class="st">"file"</span>)) </span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a>       <span class="cf">for</span> <span class="bu">file</span> <span class="kw">in</span> sales_files]</span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a>sales <span class="op">=</span> pl.concat(dfs)</span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sales)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>If you have many files you want to read in, you can use the
<code>glob</code> module to find the files by matching a pattern:</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> glob</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>sales_files <span class="op">=</span> glob.glob(<span class="st">"data/*-sales.csv"</span>)</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>sales_files</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="writing-to-a-file" class="level3" data-number="5.4">
<h3 data-number="5.4" class="anchored" data-anchor-id="writing-to-a-file"><span class="header-section-number">5.4</span>
Writing to a file</h3>
<p>Polars provides several functions for writing data to disk. The most
common are <code>write_csv()</code> and <code>write_parquet()</code>.
The most important arguments to these functions are the
<code>DataFrame</code> to save and the file path where you want to save
it.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>students.write_csv(<span class="st">"students.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Now let’s read that CSV file back in. Note that the variable type
information you set up is lost when you save to CSV because you’re
starting over with reading from a plain text file. This makes CSVs
somewhat unreliable for caching interim results—you need to recreate the
column specification every time you load in. There are two better
alternatives:</p>
<p>1.<a href="https://www.databricks.com/glossary/what-is-parquet">Parquet
files</a> maintain the column types and are generally faster and more
space-efficient:</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>students.write_parquet(<span class="st">"students.parquet"</span>)</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>parquet_students <span class="op">=</span> pl.read_parquet(<span class="st">"students.parquet"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="2" type="1">
<li>For Python-specific caching, you can use the <a href="https://www.geeksforgeeks.org/understanding-python-pickling-example/">pickle
format</a> through libraries like <code>joblib</code>:</li>
</ol>
<div class="sourceCode" id="cb127"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> joblib</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>joblib.dump(students, <span class="st">"students.joblib"</span>)</span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>joblib_students <span class="op">=</span> joblib.load(<span class="st">"students.joblib"</span>)</span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(joblib_students)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Parquet is usually preferable because it’s cross-language compatible,
more efficient, and maintains your data types.</p>
</section>
<section id="data-entry" class="level3" data-number="5.5">
<h3 data-number="5.5" class="anchored" data-anchor-id="data-entry"><span class="header-section-number">5.5</span>
Data entry</h3>
<p>Sometimes you’ll need to assemble a <code>DataFrame</code> “by hand”
with a little data entry in your Python script. Polars provides a simple
way to create data frames from dictionaries where each key is a column
name and each value is a list of values:</p>
<div id="35a7094d" class="cell" data-execution_count="113">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pl.DataFrame({</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"x"</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>],</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"y"</span>: [<span class="st">"h"</span>, <span class="st">"m"</span>, <span class="st">"g"</span>],</span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"z"</span>: [<span class="fl">0.08</span>, <span class="fl">0.83</span>, <span class="fl">0.60</span>]</span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="112">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (3, 3)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">x</th>
<th data-quarto-table-cell-role="th">y</th>
<th data-quarto-table-cell-role="th">z</th>
</tr>
<tr class="even">
<th>i64</th>
<th>str</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>"h"</td>
<td>0.08</td>
</tr>
<tr class="even">
<td>2</td>
<td>"m"</td>
<td>0.83</td>
</tr>
<tr class="odd">
<td>5</td>
<td>"g"</td>
<td>0.6</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>You can also create a data frame from a list of dictionaries, where
each dictionary represents a row:</p>
<div id="474537eb" class="cell" data-execution_count="114">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pl.DataFrame([</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>    {<span class="st">"x"</span>: <span class="dv">1</span>, <span class="st">"y"</span>: <span class="st">"h"</span>, <span class="st">"z"</span>: <span class="fl">0.08</span>},</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>    {<span class="st">"x"</span>: <span class="dv">2</span>, <span class="st">"y"</span>: <span class="st">"m"</span>, <span class="st">"z"</span>: <span class="fl">0.83</span>},</span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>    {<span class="st">"x"</span>: <span class="dv">5</span>, <span class="st">"y"</span>: <span class="st">"g"</span>, <span class="st">"z"</span>: <span class="fl">0.60</span>}</span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="113">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (3, 3)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">x</th>
<th data-quarto-table-cell-role="th">y</th>
<th data-quarto-table-cell-role="th">z</th>
</tr>
<tr class="even">
<th>i64</th>
<th>str</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>"h"</td>
<td>0.08</td>
</tr>
<tr class="even">
<td>2</td>
<td>"m"</td>
<td>0.83</td>
</tr>
<tr class="odd">
<td>5</td>
<td>"g"</td>
<td>0.6</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="summary-3" class="level3" data-number="5.6">
<h3 data-number="5.6" class="anchored" data-anchor-id="summary-3"><span class="header-section-number">5.6</span>
Summary</h3>
<p>In this section, you’ve learned how to load CSV files with Polars’
<code>pl.read_csv()</code> and how to do your own data entry by creating
DataFrames from dictionaries and lists. You’ve learned how CSV files
work, some of the problems you might encounter, and how to overcome
them.</p>
<p>We’ll revisit data import in various formats throughout your Python
data science journey, including Excel files, databases, Parquet files,
JSON, and data from websites.</p>
<p>Polars is an excellent choice for data handling, as it’s designed to
take advantage of modern hardware through parallel processing and memory
efficiency. As you become more familiar with Python data science tools,
you’ll appreciate Polars’ performance benefits and elegant API
design.</p>
</section>
</section>
<section id="exercises" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="exercises"><span class="header-section-number">6</span>
Exercises</h2>
<ol type="1">
<li><p>Does it matter what order you used
<code>DataFrame.filter()</code> and <code>DataFrame.sort()</code> if
you’re using both? Why/why not? Think about the results and how much
work the functions would have to do.</p></li>
<li><p>What happens if you specify the name of the same variable
multiple times in a <code>DataFrame.select()</code> call?</p></li>
<li><p>Using the <code>penguins</code> dataset, make a scatter plot of
<code>bill_depth_mm</code> vs.&nbsp;<code>bill_length_mm</code>. That is,
make a scatter plot with <code>bill_depth_mm</code> on the y-axis and
<code>bill_length_mm</code> on the x-axis. Describe the relationship
between these two variables.</p></li>
<li><p>From the <code>flights</code> dataset, compare
<code>dep_time</code>, <code>sched_dep_time</code>, and
<code>dep_delay</code>. How would you expect those three numbers to be
related?</p></li>
<li><p>In a single pipeline for each condition, find all
<code>flights</code> that meet the condition:</p>
<ul>
<li>Had an arrival delay of two or more hours</li>
<li>Flew to Houston (IAH or HOU)</li>
<li>Were operated by United, American, or Delta</li>
<li>Departed in summer (July, August, and September)</li>
<li>Arrived more than two hours late but didn’t leave late</li>
<li>Were delayed by at least an hour, but made up over 30 minutes in
flight</li>
</ul></li>
<li><p>Find the flights that are most delayed upon departure from each
destination.</p></li>
<li><p>How do delays vary over the course of the day? Illustrate your
answer with a plot.</p></li>
</ol>


</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/">CC BY-NC-ND 4.0</a></div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("wvu-ieng-331\.github\.io");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
          // default icon
          link.classList.add("external");
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../learning-modules/04-data-structures.html" class="pagination-link" aria-label="04 | Strings, Lists, Dictionaries, and Tuples">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">04 | Strings, Lists, Dictionaries,
and Tuples</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->




<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>